!function(){"use strict";function t(){var k=this;this.versionnumber="1.2.4",this.imageToSVG=function(t,e,n){n=k.checkoptions(n),k.loadImage(t,function(t){e(k.imagedataToSVG(k.getImgdata(t),n))},n)},this.imagedataToSVG=function(t,e){e=k.checkoptions(e);t=k.imagedataToTracedata(t,e);return k.getsvgstring(t,e)},this.imageToTracedata=function(t,e,n){n=k.checkoptions(n),k.loadImage(t,function(t){e(k.imagedataToTracedata(k.getImgdata(t),n))},n)},this.imagedataToTracedata=function(t,e){e=k.checkoptions(e);var n=k.colorquantization(t,e);if(0===e.layering)for(var s={layers:[],palette:n.palette,width:n.array[0].length-2,height:n.array.length-2},o=0;o<n.palette.length;o++){var r=k.batchtracepaths(k.internodes(k.pathscan(k.layeringstep(n,o),e.pathomit),e),e.ltres,e.qtres);s.layers.push(r)}else var a=k.layering(n),a=(e.layercontainerid&&k.drawLayers(a,k.specpalette,e.scale,e.layercontainerid),k.batchpathscan(a,e.pathomit)),a=k.batchinternodes(a,e),s={layers:k.batchtracelayers(a,e.ltres,e.qtres),palette:n.palette,width:t.width,height:t.height};return s},this.optionpresets={default:{corsenabled:!1,ltres:1,qtres:1,pathomit:8,rightangleenhance:!0,colorsampling:2,numberofcolors:16,mincolorratio:0,colorquantcycles:3,layering:0,strokewidth:1,linefilter:!1,scale:1,roundcoords:1,viewbox:!1,desc:!1,lcpr:0,qcpr:0,blurradius:0,blurdelta:20},posterized1:{colorsampling:0,numberofcolors:2},posterized2:{numberofcolors:4,blurradius:5},curvy:{ltres:.01,linefilter:!0,rightangleenhance:!1},sharp:{qtres:.01,linefilter:!1},detailed:{pathomit:0,roundcoords:2,ltres:.5,qtres:.5,numberofcolors:64},smoothed:{blurradius:5,blurdelta:64},grayscale:{colorsampling:0,colorquantcycles:1,numberofcolors:7},fixedpalette:{colorsampling:0,colorquantcycles:1,numberofcolors:27},randomsampling1:{colorsampling:1,numberofcolors:8},randomsampling2:{colorsampling:1,numberofcolors:64},artistic1:{colorsampling:0,colorquantcycles:1,pathomit:0,blurradius:5,blurdelta:64,ltres:.01,linefilter:!0,numberofcolors:16,strokewidth:2},artistic2:{qtres:.01,colorsampling:0,colorquantcycles:1,numberofcolors:4,strokewidth:0},artistic3:{qtres:10,ltres:10,numberofcolors:8},artistic4:{qtres:10,ltres:10,numberofcolors:64,blurradius:5,blurdelta:256,strokewidth:2},posterized3:{ltres:1,qtres:1,pathomit:20,rightangleenhance:!0,colorsampling:0,numberofcolors:3,mincolorratio:0,colorquantcycles:3,blurradius:3,blurdelta:20,strokewidth:0,linefilter:!1,roundcoords:1,pal:[{r:0,g:0,b:100,a:255},{r:255,g:255,b:255,a:255}]}},this.checkoptions=function(t){"string"==typeof(t=t||{})&&(t=t.toLowerCase(),t=k.optionpresets[t]||{});for(var e=Object.keys(k.optionpresets.default),n=0;n<e.length;n++)t.hasOwnProperty(e[n])||(t[e[n]]=k.optionpresets.default[e[n]]);return t},this.colorquantization=function(t,e){for(var n,s,o,r,a,i,l,c,h=[],g=[],d=t.width*t.height,p=0;p<t.height+2;p++)for(h[p]=[],a=0;a<t.width+2;a++)h[p][a]=-1;for(c=e.pal||(0===e.colorsampling?k.generatepalette(e.numberofcolors):1===e.colorsampling?k.samplepalette(e.numberofcolors,t):k.samplepalette2(e.numberofcolors,t)),0<e.blurradius&&(t=k.blur(t,e.blurradius,e.blurdelta)),l=0;l<e.colorquantcycles;l++){if(0<l)for(i=0;i<c.length;i++)0<g[i].n&&(c[i]={r:Math.floor(g[i].r/g[i].n),g:Math.floor(g[i].g/g[i].n),b:Math.floor(g[i].b/g[i].n),a:Math.floor(g[i].a/g[i].n)}),g[i].n/d<e.mincolorratio&&l<e.colorquantcycles-1&&(c[i]={r:Math.floor(255*Math.random()),g:Math.floor(255*Math.random()),b:Math.floor(255*Math.random()),a:Math.floor(255*Math.random())});for(a=0;a<c.length;a++)g[a]={r:0,g:0,b:0,a:0,n:0};for(p=0;p<t.height;p++)for(a=0;a<t.width;a++){for(n=4*(p*t.width+a),o=1024,i=r=0;i<c.length;i++)(s=Math.abs(c[i].r-t.data[n])+Math.abs(c[i].g-t.data[1+n])+Math.abs(c[i].b-t.data[2+n])+Math.abs(c[i].a-t.data[3+n]))<o&&(o=s,r=i);g[r].r+=t.data[n],g[r].g+=t.data[1+n],g[r].b+=t.data[2+n],g[r].a+=t.data[3+n],g[r].n++,h[p+1][a+1]=r}}return{array:h,palette:c}},this.samplepalette=function(t,e){for(var n,s=[],o=0;o<t;o++)n=4*Math.floor(Math.random()*e.data.length/4),s.push({r:e.data[n],g:e.data[1+n],b:e.data[2+n],a:e.data[3+n]});return s},this.samplepalette2=function(t,e){for(var n,s=[],o=Math.ceil(Math.sqrt(t)),r=Math.ceil(t/o),a=e.width/(o+1),i=e.height/(r+1),l=0;l<r;l++)for(var c=0;c<o&&s.length!==t;c++)n=4*Math.floor((l+1)*i*e.width+(c+1)*a),s.push({r:e.data[n],g:e.data[1+n],b:e.data[2+n],a:e.data[3+n]});return s},this.generatepalette=function(t){var e,n,s=[];if(t<8)for(var o=Math.floor(255/(t-1)),r=0;r<t;r++)s.push({r:r*o,g:r*o,b:r*o,a:255});else{for(var a=Math.floor(Math.pow(t,1/3)),i=Math.floor(255/(a-1)),l=t-a*a*a,c=0;c<a;c++)for(e=0;e<a;e++)for(n=0;n<a;n++)s.push({r:c*i,g:e*i,b:n*i,a:255});for(c=0;c<l;c++)s.push({r:Math.floor(255*Math.random()),g:Math.floor(255*Math.random()),b:Math.floor(255*Math.random()),a:Math.floor(255*Math.random())})}return s},this.layering=function(t){for(var e,n,s,o,r,a,i,l,c,h,g,d=[],p=t.array.length,u=t.array[0].length,m=0;m<t.palette.length;m++)for(d[m]=[],g=0;g<p;g++)for(d[m][g]=[],h=0;h<u;h++)d[m][g][h]=0;for(g=1;g<p-1;g++)for(h=1;h<u-1;h++)e=t.array[g][h],n=t.array[g-1][h-1]===e?1:0,s=t.array[g-1][h]===e?1:0,o=t.array[g-1][h+1]===e?1:0,r=t.array[g][h-1]===e?1:0,a=t.array[g][h+1]===e?1:0,i=t.array[g+1][h-1]===e?1:0,l=t.array[g+1][h]===e?1:0,c=t.array[g+1][h+1]===e?1:0,d[e][g+1][h+1]=1+2*a+4*c+8*l,r||(d[e][g+1][h]=2+4*l+8*i),s||(d[e][g][h+1]=0+2*o+4*a+8),n||(d[e][g][h]=0+2*s+4+8*r);return d},this.layeringstep=function(t,e){for(var n,s=[],o=t.array.length,r=t.array[0].length,a=0;a<o;a++)for(s[a]=[],n=0;n<r;n++)s[a][n]=0;for(a=1;a<o;a++)for(n=1;n<r;n++)s[a][n]=(t.array[a-1][n-1]===e?1:0)+(t.array[a-1][n]===e?2:0)+(t.array[a][n-1]===e?8:0)+(t.array[a][n]===e?4:0);return s},this.pathscan_combined_lookup=[[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[13,3,0,1],[13,2,-1,0],[7,1,0,-1],[7,0,1,0]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[0,3,0,1],[0,2,-1,0],[-1,-1,-1,-1],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[0,1,0,-1],[-1,-1,-1,-1],[0,3,0,1]],[[11,1,0,-1],[14,0,1,0],[14,3,0,1],[11,2,-1,0]],[[-1,-1,-1,-1],[0,0,1,0],[0,3,0,1],[-1,-1,-1,-1]],[[0,0,1,0],[-1,-1,-1,-1],[0,2,-1,0],[-1,-1,-1,-1]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[0,1,0,-1],[0,0,1,0]],[[0,1,0,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[0,2,-1,0]],[[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1],[-1,-1,-1,-1]]],this.pathscan=function(t,e){for(var n,s,o=[],r=0,a=0,i=0,l=0,c=t[0].length,h=t.length,g=0,d=!0,p=0;p<h;p++)for(var u=0;u<c;u++)if(4==t[p][u]||11==t[p][u])for(i=u,l=p,o[r]={},o[r].points=[],o[r].boundingbox=[i,l,i,l],d=!(o[r].holechildren=[]),a=0,n=11==t[p][u],g=1;!d;){if(o[r].points[a]={},o[r].points[a].x=i-1,o[r].points[a].y=l-1,o[r].points[a].t=t[l][i],i-1<o[r].boundingbox[0]&&(o[r].boundingbox[0]=i-1),i-1>o[r].boundingbox[2]&&(o[r].boundingbox[2]=i-1),l-1<o[r].boundingbox[1]&&(o[r].boundingbox[1]=l-1),l-1>o[r].boundingbox[3]&&(o[r].boundingbox[3]=l-1),s=k.pathscan_combined_lookup[t[l][i]][g],t[l][i]=s[0],g=s[1],i+=s[2],l+=s[3],i-1===o[r].points[0].x&&l-1===o[r].points[0].y)if(d=!0,o[r].points.length<e)o.pop();else{if(o[r].isholepath=n){for(var m=0,f=[-1,-1,c+1,h+1],y=0;y<r;y++)!o[y].isholepath&&k.boundingboxincludes(o[y].boundingbox,o[r].boundingbox)&&k.boundingboxincludes(f,o[y].boundingbox)&&(f=o[m=y].boundingbox);o[m].holechildren.push(r)}r++}a++}return o},this.boundingboxincludes=function(t,e){return t[0]<e[0]&&t[1]<e[1]&&t[2]>e[2]&&t[3]>e[3]},this.batchpathscan=function(t,e){var n,s=[];for(n in t)t.hasOwnProperty(n)&&(s[n]=k.pathscan(t[n],e));return s},this.internodes=function(t,e){for(var n,s,o,r,a=[],i=0;i<t.length;i++)for(a[i]={},a[i].points=[],a[i].boundingbox=t[i].boundingbox,a[i].holechildren=t[i].holechildren,a[i].isholepath=t[i].isholepath,n=t[i].points.length,r=0;r<n;r++)s=(r+1)%n,o=(r+2)%n,e.rightangleenhance&&k.testrightangle(t[i],(r-2+n)%n,(r-1+n)%n,r,s,o)&&(0<a[i].points.length&&(a[i].points[a[i].points.length-1].linesegment=k.getdirection(a[i].points[a[i].points.length-1].x,a[i].points[a[i].points.length-1].y,t[i].points[r].x,t[i].points[r].y)),a[i].points.push({x:t[i].points[r].x,y:t[i].points[r].y,linesegment:k.getdirection(t[i].points[r].x,t[i].points[r].y,(t[i].points[r].x+t[i].points[s].x)/2,(t[i].points[r].y+t[i].points[s].y)/2)})),a[i].points.push({x:(t[i].points[r].x+t[i].points[s].x)/2,y:(t[i].points[r].y+t[i].points[s].y)/2,linesegment:k.getdirection((t[i].points[r].x+t[i].points[s].x)/2,(t[i].points[r].y+t[i].points[s].y)/2,(t[i].points[s].x+t[i].points[o].x)/2,(t[i].points[s].y+t[i].points[o].y)/2)});return a},this.testrightangle=function(t,e,n,s,o,r){return t.points[s].x===t.points[e].x&&t.points[s].x===t.points[n].x&&t.points[s].y===t.points[o].y&&t.points[s].y===t.points[r].y||t.points[s].y===t.points[e].y&&t.points[s].y===t.points[n].y&&t.points[s].x===t.points[o].x&&t.points[s].x===t.points[r].x},this.getdirection=function(t,e,n,s){return t<n?e<s?1:s<e?7:0:n<t?e<s?3:s<e?5:4:e<s?2:s<e?6:8},this.batchinternodes=function(t,e){var n,s=[];for(n in t)t.hasOwnProperty(n)&&(s[n]=k.internodes(t[n],e));return s},this.tracepath=function(t,e,n){var s,o,r,a=0,i={segments:[]};for(i.boundingbox=t.boundingbox,i.holechildren=t.holechildren,i.isholepath=t.isholepath;a<t.points.length;){for(s=t.points[a].linesegment,o=-1,r=a+1;(t.points[r].linesegment===s||t.points[r].linesegment===o||-1===o)&&r<t.points.length-1;)t.points[r].linesegment!==s&&-1===o&&(o=t.points[r].linesegment),r++;r===t.points.length-1&&(r=0),i.segments=i.segments.concat(k.fitseq(t,e,n,a,r)),a=0<r?r:t.points.length}return i},this.fitseq=function(t,e,n,s,o){if(o>t.points.length||o<0)return[];for(var r,a,i,l,c=s,h=0,g=!0,d=o-s,p=(d<0&&(d+=t.points.length),(t.points[o].x-t.points[s].x)/d),u=(t.points[o].y-t.points[s].y)/d,m=(s+1)%t.points.length;m!=o;)(l=m-s)<0&&(l+=t.points.length),r=t.points[s].x+p*l,a=t.points[s].y+u*l,e<(i=(t.points[m].x-r)*(t.points[m].x-r)+(t.points[m].y-a)*(t.points[m].y-a))&&(g=!1),h<i&&(c=m,h=i),m=(m+1)%t.points.length;if(g)return[{type:"L",x1:t.points[s].x,y1:t.points[s].y,x2:t.points[o].x,y2:t.points[o].y}];for(var f=c,g=!0,h=0,y=(f-s)/d,b=(1-y)*(1-y),x=2*(1-y)*y,w=y*y,v=(b*t.points[s].x+w*t.points[o].x-t.points[f].x)/-x,M=(b*t.points[s].y+w*t.points[o].y-t.points[f].y)/-x,m=s+1;m!=o;)r=(b=(1-(y=(m-s)/d))*(1-y))*t.points[s].x+(x=2*(1-y)*y)*v+(w=y*y)*t.points[o].x,a=b*t.points[s].y+x*M+w*t.points[o].y,n<(i=(t.points[m].x-r)*(t.points[m].x-r)+(t.points[m].y-a)*(t.points[m].y-a))&&(g=!1),h<i&&(c=m,h=i),m=(m+1)%t.points.length;return g?[{type:"Q",x1:t.points[s].x,y1:t.points[s].y,x2:v,y2:M,x3:t.points[o].x,y3:t.points[o].y}]:k.fitseq(t,e,n,s,f=f).concat(k.fitseq(t,e,n,f,o))},this.batchtracepaths=function(t,e,n){var s,o=[];for(s in t)t.hasOwnProperty(s)&&o.push(k.tracepath(t[s],e,n));return o},this.batchtracelayers=function(t,e,n){var s,o=[];for(s in t)t.hasOwnProperty(s)&&(o[s]=k.batchtracepaths(t[s],e,n));return o},this.roundtodec=function(t,e){return+t.toFixed(e)},this.svgpathstring=function(t,e,n,s){var o=t.layers[e],r=o[n],a="";if(!(s.linefilter&&r.segments.length<3)){if(a="<path "+(s.desc?'desc="l '+e+" p "+n+'" ':"")+k.tosvgcolorstr(t.palette[e],s)+'d="',-1===s.roundcoords)for(a+="M "+r.segments[0].x1*s.scale+" "+r.segments[0].y1*s.scale+" ",c=0;c<r.segments.length;c++)a+=r.segments[c].type+" "+r.segments[c].x2*s.scale+" "+r.segments[c].y2*s.scale+" ",r.segments[c].hasOwnProperty("x3")&&(a+=r.segments[c].x3*s.scale+" "+r.segments[c].y3*s.scale+" ");else for(a+="M "+k.roundtodec(r.segments[0].x1*s.scale,s.roundcoords)+" "+k.roundtodec(r.segments[0].y1*s.scale,s.roundcoords)+" ",c=0;c<r.segments.length;c++)a+=r.segments[c].type+" "+k.roundtodec(r.segments[c].x2*s.scale,s.roundcoords)+" "+k.roundtodec(r.segments[c].y2*s.scale,s.roundcoords)+" ",r.segments[c].hasOwnProperty("x3")&&(a+=k.roundtodec(r.segments[c].x3*s.scale,s.roundcoords)+" "+k.roundtodec(r.segments[c].y3*s.scale,s.roundcoords)+" ");a+="Z ";for(var i=0;i<r.holechildren.length;i++){var l=o[r.holechildren[i]];if(-1===s.roundcoords)for(l.segments[l.segments.length-1].hasOwnProperty("x3")?a+="M "+l.segments[l.segments.length-1].x3*s.scale+" "+l.segments[l.segments.length-1].y3*s.scale+" ":a+="M "+l.segments[l.segments.length-1].x2*s.scale+" "+l.segments[l.segments.length-1].y2*s.scale+" ",c=l.segments.length-1;0<=c;c--)a+=l.segments[c].type+" ",l.segments[c].hasOwnProperty("x3")&&(a+=l.segments[c].x2*s.scale+" "+l.segments[c].y2*s.scale+" "),a+=l.segments[c].x1*s.scale+" "+l.segments[c].y1*s.scale+" ";else for(l.segments[l.segments.length-1].hasOwnProperty("x3")?a+="M "+k.roundtodec(l.segments[l.segments.length-1].x3*s.scale)+" "+k.roundtodec(l.segments[l.segments.length-1].y3*s.scale)+" ":a+="M "+k.roundtodec(l.segments[l.segments.length-1].x2*s.scale)+" "+k.roundtodec(l.segments[l.segments.length-1].y2*s.scale)+" ",c=l.segments.length-1;0<=c;c--)a+=l.segments[c].type+" ",l.segments[c].hasOwnProperty("x3")&&(a+=k.roundtodec(l.segments[c].x2*s.scale)+" "+k.roundtodec(l.segments[c].y2*s.scale)+" "),a+=k.roundtodec(l.segments[c].x1*s.scale)+" "+k.roundtodec(l.segments[c].y1*s.scale)+" ";a+="Z "}if(a+='" />',s.lcpr||s.qcpr){for(c=0;c<r.segments.length;c++)r.segments[c].hasOwnProperty("x3")&&s.qcpr&&(a=(a=(a=(a+='<circle cx="'+r.segments[c].x2*s.scale+'" cy="'+r.segments[c].y2*s.scale+'" r="'+s.qcpr+'" fill="cyan" stroke-width="'+.2*s.qcpr+'" stroke="black" />')+'<circle cx="'+r.segments[c].x3*s.scale+'" cy="'+r.segments[c].y3*s.scale+'" r="'+s.qcpr+'" fill="white" stroke-width="'+.2*s.qcpr+'" stroke="black" />')+'<line x1="'+r.segments[c].x1*s.scale+'" y1="'+r.segments[c].y1*s.scale+'" x2="'+r.segments[c].x2*s.scale+'" y2="'+r.segments[c].y2*s.scale+'" stroke-width="'+.2*s.qcpr+'" stroke="cyan" />')+'<line x1="'+r.segments[c].x2*s.scale+'" y1="'+r.segments[c].y2*s.scale+'" x2="'+r.segments[c].x3*s.scale+'" y2="'+r.segments[c].y3*s.scale+'" stroke-width="'+.2*s.qcpr+'" stroke="cyan" />'),!r.segments[c].hasOwnProperty("x3")&&s.lcpr&&(a+='<circle cx="'+r.segments[c].x2*s.scale+'" cy="'+r.segments[c].y2*s.scale+'" r="'+s.lcpr+'" fill="white" stroke-width="'+.2*s.lcpr+'" stroke="black" />');for(i=0;i<r.holechildren.length;i++)for(var l=o[r.holechildren[i]],c=0;c<l.segments.length;c++)l.segments[c].hasOwnProperty("x3")&&s.qcpr&&(a=(a=(a=(a+='<circle cx="'+l.segments[c].x2*s.scale+'" cy="'+l.segments[c].y2*s.scale+'" r="'+s.qcpr+'" fill="cyan" stroke-width="'+.2*s.qcpr+'" stroke="black" />')+'<circle cx="'+l.segments[c].x3*s.scale+'" cy="'+l.segments[c].y3*s.scale+'" r="'+s.qcpr+'" fill="white" stroke-width="'+.2*s.qcpr+'" stroke="black" />')+'<line x1="'+l.segments[c].x1*s.scale+'" y1="'+l.segments[c].y1*s.scale+'" x2="'+l.segments[c].x2*s.scale+'" y2="'+l.segments[c].y2*s.scale+'" stroke-width="'+.2*s.qcpr+'" stroke="cyan" />')+'<line x1="'+l.segments[c].x2*s.scale+'" y1="'+l.segments[c].y2*s.scale+'" x2="'+l.segments[c].x3*s.scale+'" y2="'+l.segments[c].y3*s.scale+'" stroke-width="'+.2*s.qcpr+'" stroke="cyan" />'),!l.segments[c].hasOwnProperty("x3")&&s.lcpr&&(a+='<circle cx="'+l.segments[c].x2*s.scale+'" cy="'+l.segments[c].y2*s.scale+'" r="'+s.lcpr+'" fill="white" stroke-width="'+.2*s.lcpr+'" stroke="black" />')}}return a},this.getsvgstring=function(t,e){e=k.checkoptions(e);for(var n=t.width*e.scale,s=t.height*e.scale,o="<svg "+(e.viewbox?'viewBox="0 0 '+n+" "+s+'" ':'width="'+n+'" height="'+s+'" ')+'version="1.1" baseProfile="full" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ev="http://www.w3.org/2001/xml-events" x="0" y="0" enable-background="new 0 0 '+n+" "+s+'" xml:space="preserve">',r=0;r<t.layers.length;r++)for(var a=0;a<t.layers[r].length;a++)t.layers[r][a].isholepath||(o+=k.svgpathstring(t,r,a,e));return o+="</svg>"},this.compareNumbers=function(t,e){return t-e},this.torgbastr=function(t){return"rgba("+t.r+","+t.g+","+t.b+","+t.a+")"},this.tosvgcolorstr=function(t,e){return'fill="rgb('+t.r+","+t.g+","+t.b+')" stroke="rgb('+t.r+","+t.g+","+t.b+')" stroke-width="'+e.strokewidth+'" opacity="'+t.a/255+'" '},this.appendSVGString=function(t,e){var n;e?(n=document.getElementById(e))||((n=document.createElement("div")).id=e,document.body.appendChild(n)):(n=document.createElement("div"),document.body.appendChild(n)),n.innerHTML+=t},this.gks=[[.27901,.44198,.27901],[.135336,.228569,.272192,.228569,.135336],[.086776,.136394,.178908,.195843,.178908,.136394,.086776],[.063327,.093095,.122589,.144599,.152781,.144599,.122589,.093095,.063327],[.049692,.069304,.089767,.107988,.120651,.125194,.120651,.107988,.089767,.069304,.049692]],this.blur=function(t,e,n){var s,o,r,a,i,l,c,h,g={width:t.width,height:t.height,data:[]};if((e=Math.floor(e))<1)return t;5<e&&(e=5),1024<(n=Math.abs(n))&&(n=1024);for(var d=k.gks[e-1],p=0;p<t.height;p++)for(s=0;s<t.width;s++){for(h=c=l=i=a=0,o=-e;o<e+1;o++)0<s+o&&s+o<t.width&&(r=4*(p*t.width+s+o),a+=t.data[r]*d[o+e],i+=t.data[r+1]*d[o+e],l+=t.data[r+2]*d[o+e],c+=t.data[r+3]*d[o+e],h+=d[o+e]);r=4*(p*t.width+s),g.data[r]=Math.floor(a/h),g.data[r+1]=Math.floor(i/h),g.data[r+2]=Math.floor(l/h),g.data[r+3]=Math.floor(c/h)}var u=new Uint8ClampedArray(g.data);for(p=0;p<t.height;p++)for(s=0;s<t.width;s++){for(h=c=l=i=a=0,o=-e;o<e+1;o++)0<p+o&&p+o<t.height&&(a+=u[r=4*((p+o)*t.width+s)]*d[o+e],i+=u[r+1]*d[o+e],l+=u[r+2]*d[o+e],c+=u[r+3]*d[o+e],h+=d[o+e]);r=4*(p*t.width+s),g.data[r]=Math.floor(a/h),g.data[r+1]=Math.floor(i/h),g.data[r+2]=Math.floor(l/h),g.data[r+3]=Math.floor(c/h)}for(p=0;p<t.height;p++)for(s=0;s<t.width;s++)r=4*(p*t.width+s),n<Math.abs(g.data[r]-t.data[r])+Math.abs(g.data[r+1]-t.data[r+1])+Math.abs(g.data[r+2]-t.data[r+2])+Math.abs(g.data[r+3]-t.data[r+3])&&(g.data[r]=t.data[r],g.data[r+1]=t.data[r+1],g.data[r+2]=t.data[r+2],g.data[r+3]=t.data[r+3]);return g},this.loadImage=function(t,e,n){var s=new Image;n&&n.corsenabled&&(s.crossOrigin="Anonymous"),s.src=t,s.onload=function(){var t=document.createElement("canvas");t.width=s.width,t.height=s.height,t.getContext("2d").drawImage(s,0,0),e(t)}},this.getImgdata=function(t){return t.getContext("2d").getImageData(0,0,t.width,t.height)},this.specpalette=[{r:0,g:0,b:0,a:255},{r:128,g:128,b:128,a:255},{r:0,g:0,b:128,a:255},{r:64,g:64,b:128,a:255},{r:192,g:192,b:192,a:255},{r:255,g:255,b:255,a:255},{r:128,g:128,b:192,a:255},{r:0,g:0,b:192,a:255},{r:128,g:0,b:0,a:255},{r:128,g:64,b:64,a:255},{r:128,g:0,b:128,a:255},{r:168,g:168,b:168,a:255},{r:192,g:128,b:128,a:255},{r:192,g:0,b:0,a:255},{r:255,g:255,b:255,a:255},{r:0,g:128,b:0,a:255}],this.drawLayers=function(t,e,n,s){var o,r,a;for(r in n=n||1,s?(a=document.getElementById(s))||((a=document.createElement("div")).id=s,document.body.appendChild(a)):(a=document.createElement("div"),document.body.appendChild(a)),t)if(t.hasOwnProperty(r)){for(var i=t[r][0].length,l=t[r].length,c=document.createElement("canvas"),h=(c.width=i*n,c.height=l*n,c.getContext("2d")),g=0;g<l;g++)for(o=0;o<i;o++)h.fillStyle=k.torgbastr(e[t[r][g][o]%e.length]),h.fillRect(o*n,g*n,n,n);a.appendChild(c)}}}"function"==typeof define&&define.amd?define(function(){return new t}):"undefined"!=typeof module?module.exports=new t:"undefined"!=typeof self?self.ImageTracer=new t:window.ImageTracer=new t}();