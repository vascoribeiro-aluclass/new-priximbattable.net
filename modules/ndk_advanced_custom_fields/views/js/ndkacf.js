var groupAdded=[],customizationId=0,mesures=[],defaultMesures=[],preloadImg=[],filtersTags=[],maxQttyAvailable=[],htmlOutput=[],customizationPrice=0,initialValues=[],scrollbarWidth=0,checked=!1,allFonts=[],doneTypingInterval=1e3,alreadyModify=!1,compoImages=[],selectedIdValue=[],ndkBrowserVersion=ndkDetectIE();function ndkDetectIE(){var t=window.navigator.userAgent,e=t.indexOf("MSIE ");return 0<e?parseInt(t.substring(e+5,t.indexOf(".",e)),10):0<t.indexOf("Trident/")?(e=t.indexOf("rv:"),parseInt(t.substring(e+3,t.indexOf(".",e)),10)):0<(e=t.indexOf("Edge/"))&&parseInt(t.substring(e+5,t.indexOf(".",e)),10)}function formatCurrencyNdk(t){return"function"==typeof formatCurrencyNdk_Override?formatCurrencyNdk_Override(t):1.6<ps_version?formatCurrency17(parseFloat(t),currencyFormat17,currencySign,1):formatCurrency(parseFloat(t),currencyFormat,currencySign,currencyBlank)}function formatCurrencyNdkCallback(t,e,i,a){if("function"==typeof formatCurrencyNdkCallback_Override)return formatCurrencyNdkCallback_Override(t,e,i,a);i=i||"",a=a||"",1.6<ps_version?$(e).html(i+formatCurrency17(parseFloat(t),currencyFormat17,currencySign,1)+a):$(e).html(i+formatCurrency(parseFloat(t),currencyFormat,currencySign,currencyBlank)+a)}function getIdCombinationNdk(){if("function"==typeof getIdCombinationNdk_Override)return getIdCombinationNdk_Override();$("#ndkcf_id_combination").val(0),$("#quantity_wanted").trigger("change")}function imageScrollBox(){2<$("#main .js-qv-product-images li").length?($("#main .js-qv-mask").addClass("scroll"),$(".scroll-box-arrows").addClass("scroll"),$("#main .js-qv-mask").scrollbox({direction:"h",distance:113,autoPlay:!1}),$(".scroll-box-arrows .left").click(function(){$("#main .js-qv-mask").trigger("backward")}),$(".scroll-box-arrows .right").click(function(){$("#main .js-qv-mask").trigger("forward")})):($("#main .js-qv-mask").removeClass("scroll"),$(".scroll-box-arrows").removeClass("scroll"))}function coverImage(){$.prototype.bxSlider&&($(".product-cover .layer").addClass("hideImportant"),$(".js-qv-product-images").unwrap().unwrap().parent().find(".bx-controls").remove(),$.prototype.bxSlider)&&$(".js-qv-product-images").bxSlider({responsive:!0,useCSS:!1,pager:!1,slideWidth:150,slideMargin:4})}$(document).ready(function(){$(window).keydown(function(t){if(13==t.keyCode)return t.preventDefault(),!1})}),conf_img_url=$("#bigpic").attr("data-original-image"),"undefined"==typeof contentOnly&&(contentOnly=!1),$.jMaskGlobals={maskElements:"input,td,span,div",dataMaskAttr:"*[data-mask]",dataMask:!0,watchInterval:300,watchInputs:!0,watchDataMask:!1,byPassKeys:[9,16,17,18,36,37,38,39,40,91],translation:{0:{pattern:/\d/},9:{pattern:/\d/,optional:!0},"#":{pattern:/\d/,recursive:!0},A:{pattern:/[a-zA-Z0-9]/},M:{pattern:/[A-Z0-9]/},S:{pattern:/[a-zA-Z]/},s:{pattern:/[a-z]/,optional:!0},a:{pattern:/[a-zà-ÿ'-]/,recursive:!0}}},$(document).on("click",".ndkcfLoaded .js-thumb",function(t){$(".js-thumb.selected").removeClass("selected"),view_img=0<$(".view_tab.activeView").length?(img=$(t.currentTarget).data("image-large-src"),$(".view_tab.activeView").attr("data-img")):img=$(t.currentTarget).data("image-large-src"),$(t.target).addClass("selected"),$(".js-qv-product-cover").attr("src",view_img),$(".js-modal-product-cover").attr("src",img),$("[data-target='#product-modal']").trigger("click")}),$(document).on("change, click",".ndkcfLoaded .product-variants input",function(){$.when(getIdCombinationNdk()).done(function(){setTimeout(function(){initPriceVars()},800)})}),$(document).on("change",".ndkcfLoaded .product-variants select",function(){$.when(getIdCombinationNdk()).done(function(){setTimeout(function(){initPriceVars()},800)})});var fonts,colors,typingTimer,default_colors=["AliceBlue","AntiqueWhite","Aqua","Aquamarine","Azure","Beige","Bisque","Black","BlanchedAlmond","Blue","BlueViolet","Brown","BurlyWood","CadetBlue","Chartreuse","Chocolate","Coral","CornflowerBlue","Cornsilk","Crimson","Cyan","DarkBlue","DarkCyan","DarkGoldenRod","DarkGray","DarkGrey","DarkGreen","DarkKhaki","DarkMagenta","DarkOliveGreen","Darkorange","DarkOrchid","DarkRed","DarkSalmon","DarkSeaGreen","DarkSlateBlue","DarkSlateGray","DarkSlateGrey","DarkTurquoise","DarkViolet","DeepPink","DeepSkyBlue","DimGray","DimGrey","DodgerBlue","FireBrick","FloralWhite","ForestGreen","Fuchsia","Gainsboro","GhostWhite","Gold","GoldenRod","Gray","Grey","Green","GreenYellow","HoneyDew","HotPink","IndianRed","Indigo","Ivory","Khaki","Lavender","LavenderBlush","LawnGreen","LemonChiffon","LightBlue","LightCoral","LightCyan","LightGoldenRodYellow","LightGray","LightGrey","LightGreen","LightPink","LightSalmon","LightSeaGreen","LightSkyBlue","LightSlateGray","LightSlateGrey","LightSteelBlue","LightYellow","Lime","LimeGreen","Linen","Magenta","Maroon","MediumAquaMarine","MediumBlue","MediumOrchid","MediumPurple","MediumSeaGreen","MediumSlateBlue","MediumSpringGreen","MediumTurquoise","MediumVioletRed","MidnightBlue","MintCream","MistyRose","Moccasin","NavajoWhite","Navy","OldLace","Olive","OliveDrab","Orange","OrangeRed","Orchid","PaleGoldenRod","PaleGreen","PaleTurquoise","PaleVioletRed","PapayaWhip","PeachPuff","Peru","Pink","Plum","PowderBlue","Purple","Red","RosyBrown","RoyalBlue","SaddleBrown","Salmon","SandyBrown","SeaGreen","SeaShell","Sienna","Silver","SkyBlue","SlateBlue","SlateGray","SlateGrey","Snow","SpringGreen","SteelBlue","Tan","Teal","Thistle","Tomato","Turquoise","Violet","Wheat","White","WhiteSmoke","Yellow","YellowGreen"],default_fonts=["Arial,Arial,Helvetica,sans-serif","Arial Black,Arial Black,Gadget,sans-serif","Comic Sans MS,Comic Sans MS,cursive","Courier New,Courier New,Courier,monospace","Georgia,Georgia,serif","Impact,Charcoal,sans-serif","Times New Roman,Times,serif","Indie Flower","Lobster","Chewy","Alpha Slab One","Rock Salt","Comfortaa","Audiowide","Yellowtail","Black Ops One","Frijole","Press Star 2p","Kranky","Meddon","Love Ya Like A Sister","Bree Serif, serif"];function updatePriceNdk(t,e){if("function"==typeof updatePriceNdk_Override)return updatePriceNdk_Override(t,e);if($("#price_"+e).val(t).trigger("keyup"),customizationPrice=0,isNaN(t)&&(t=0),!isNaN(t)&&void 0!==t&&void 0!==e&&"undefined"!=e){for(var i in groupAdded[e]=parseFloat(t),groupAdded)void 0!==groupAdded[i]&&"percent"!=(price_type=$("#price_type_"+i).attr("data-price-type"))&&0<parseFloat(groupAdded[i])&&(customizationPrice="one_time"==price_type?parseFloat(customizationPrice)+parseFloat(groupAdded[i])/$("#quantity_wanted").val():parseFloat(customizationPrice)+parseFloat(groupAdded[i]));var a=$.trim($("#oldPrice").text().replace(currencySign,"").replace(",",".").replace(/\ /g,"").replace("-",""))-$.trim($("#specificReduct").text().replace(currencySign,"").replace(",",".").replace(/\ /g,"").replace("-",""));for(i in groupAdded)void 0!==groupAdded[i]&&"undefined"!=typeof(price_type=$("#price_type_"+i).attr("data-price-type"))&&"percent"==price_type&&(multiplicator=groupAdded[i]/100,totalPrice=parseFloat(a),toAdd=totalPrice*multiplicator,0<parseFloat(toAdd))&&(customizationPrice=parseFloat(customizationPrice)+toAdd);new_price=parseFloat(+productPrice)+parseFloat(+customizationPrice),$(".additionnal_price").remove(),id_product3=$("#ndkcf_id_product").val(),4511==parseFloat(id_product3)&&(e=$(".current_price_aluclass").attr("content"),customizationPrice-=parseFloat(e));t=$("#portivaaumento").val();reductionpercentprice=$("#reductionpercentprice").val(),reductionpercent=$("#reductionpercent").val(),reductionpercentname=$("#reductionpercentname").val(),t=parseFloat(t)-parseFloat(t)*valorReducao,t=parseFloat(t)-parseFloat(reductionpercent)/100*parseFloat(t),customizationPriceReducao=parseFloat(customizationPrice)-parseFloat(customizationPrice)*valorReducao,0<customizationPrice&&0<parseInt(reductionpercentprice)?(reductioncustomizationPrice=parseFloat(customizationPrice)-parseFloat(customizationPrice)*valorReducao,reductioncustomizationPrice=parseFloat(reductioncustomizationPrice)-parseFloat(reductionpercent)/100*parseFloat(reductioncustomizationPrice),reductionpercentprice=parseFloat(reductionpercentprice)+parseFloat(t)+parseFloat(reductioncustomizationPrice),$(".productPriceUpHT, #our_price_display:visible").before('<span id="additionnal_price" data-price="'+customizationPrice+'" class=" product-price price additionnal_price">'+formatCurrencyNdk(customizationPrice)+"hehe</span>"),formatCurrencyNdkCallback(customizationPriceReducao,".additionnal_price","( "+additionnalText," ) <br><br> Mit Code "+reductionpercentname+" : "+formatNumber(reductionpercentprice,2,",",".")+" € Code auf 1 Tag begrenzt")):0==customizationPrice&&0<parseInt(reductionpercentprice)?(reductionpercentprice=parseFloat(reductionpercentprice)+parseFloat(t),$(".productPriceUpHT, #our_price_display:visible").before('<span id="additionnal_price" data-price="'+customizationPrice+'" class=" product-price price additionnal_price">'+formatCurrencyNdk(customizationPrice)+"hehe</span>"),formatCurrencyNdkCallback(reductionpercentprice,".additionnal_price"," Mit Code "+reductionpercentname+" : ","<br> Code auf 1 Tag begrenzt")):(0<customizationPrice&&0==parseInt(reductionpercentprice)&&$(".productPriceUpHT, #our_price_display:visible").before('<span id="additionnal_price" data-price="'+customizationPrice+'" class=" product-price price additionnal_price">'+formatCurrencyNdk(customizationPrice)+"hehe</span>"),formatCurrencyNdkCallback(customizationPriceReducao,".additionnal_price","( "+additionnalText," ) ")),1==templateType&&($("#timeline").trigger("mouseover"),setTimeout(function(){$("#timeline").trigger("mouseout")},5e3))}update_price_dynamic(0)}function updatePriceNdkGeneric(t,e){if("function"==typeof updatePriceNdkGeneric_Override)return updatePriceNdkGeneric_Override(t,e);customizationPrice=0;var i,a=$.trim($("#our_price_display").text().replace(currencySign,"").replace(",",".").replace(/\ /g,"").replace("-",""));for(i in groupAdded)void 0!==groupAdded[i]&&0<parseFloat(groupAdded[i])&&"percent"!=(price_type=$("#price_type_"+i).attr("data-price-type"))&&(customizationPrice=parseFloat(customizationPrice)+parseFloat(groupAdded[i]));for(i in groupAdded)void 0!==groupAdded[i]&&"undefined"!=typeof(price_type=$("#price_type_"+i).attr("data-price-type"))&&"percent"==price_type&&(multiplicator=groupAdded[i]/100,totalPrice=parseFloat(+a)-(parseFloat(+a)-$("#priceSimulation").val())+parseFloat(+customizationPrice),toAdd=totalPrice*multiplicator,0<parseFloat(toAdd))&&(customizationPrice=parseFloat(customizationPrice)+toAdd);new_price=parseFloat(+a)+parseFloat(+customizationPrice),$(".additionnal_price").remove(),0<customizationPrice&&$(".productPriceUpHT, #our_price_display:visible").before('<span id="additionnal_price" data-price="'+customizationPrice+'" class="product-price price additionnal_price">'+formatCurrencyNdk(customizationPrice)+"</span>"),formatCurrencyNdkCallback(customizationPrice,".additionnal_price","( "+additionnalText," )"),1==templateType&&($("#timeline").trigger("mouseover"),setTimeout(function(){$("#timeline").trigger("mouseout")},5e3))}function svg_textMultiline(t,e,i,a,r,o){var n=1,d=(t=document.getElementById(t),e.split(" ")),s="";t.innerHTML='<tspan style="font-size='+a+'px;" '+r+' id="PROCESSING">busy</tspan >';for(var l=0;l<d.length;l++){var c=s+d[l]+" ",p=document.getElementById("PROCESSING"),p=(p.innerHTML=c,p.getBoundingClientRect());testWidth=p.width,testWidth+=30,"±"==d[l]?(t.innerHTML+='<tspan style="font-size='+a+'px;" '+r+' x="'+o+'" y="'+a*n+'">'+s.escape()+"</tspan>",s=" ",n++):testWidth>i&&0<l?(t.innerHTML+='<tspan style="font-size='+a+'px;" '+r+' x="'+o+'" y="'+a*n+'">'+s.escape()+"</tspan>",s=d[l]+" ",n++):s=c}t.innerHTML+='<tspan style="font-size='+a+'px;" '+r+' x="'+o+'" y="'+a*n+'">'+s.escape()+"</tspan>",document.getElementById("PROCESSING").remove()}function updateQuantityForValue(t,e){if("function"==typeof updateQuantityForValue_Override)return updateQuantityForValue_Override(t,e);var i,a=999999999999999;for(i in void 0!==t&&void 0!==e&&"undefined"!=e&&("null"==t&&(t=999999999999999),maxQttyAvailable[e]=parseFloat(t)),groupAdded)void 0!==maxQttyAvailable[i]&&parseFloat(maxQttyAvailable[i])<=parseFloat(a)&&(a=parseFloat(maxQttyAvailable[i]))}function resizeZones(t){if("function"==typeof resizeZones_Override)return resizeZones_Override(t);lbkWidth=t.attr("original-width"),lbkHeight=t.attr("original-height"),newWidth=t.width(),newHeight=t.height(),t.width(newWidth/lbkWidth*100+"%"),t.height(newHeight/lbkHeight*100+"%"),newMarginL=t.css("left").replace("px",""),newMarginT=t.css("top").replace("px",""),t.css("left",newMarginL/lbkWidth*100+"%"),t.css("top",newMarginT/lbkHeight*100+"%")}function redesignPage(){if("function"==typeof redesignPage_Override)return redesignPage_Override();1.6<ps_version&&("undefined"==typeof contentOnly&&(contentOnly=!1),$("#content").parent().addClass("pb-left-column"),$(".product-price:eq(0)").parent().addClass("pb-center-column")),setTags(),$("#add_to_cart, .product-add-to-cart > *:not(.product-quantity), .add button, .add-to-cart, .product-customization").hide(),$("h1").prependTo(".pb-left-column"),$("#short_description_block").appendTo(".pb-left-column"),$(".pb-left-column").removeClass("col-md-5").addClass("col-md-7"),$(".pb-center-column").removeClass("col-sm-4").addClass("col-sm-5"),$(".pb-right-column").removeClass("col-sm-4").removeClass("col-md-3").removeClass("col-xs-12").appendTo(".pb-left-column").addClass("clearfix").wrap('<div id="timeline" class="floatingBarre"></div>'),"undefined"!=typeof isFieldsPack&&1==isFieldsPack?$(".replace-img-block").each(function(){(viewsTabs=$(this).clone()).find(".view_tab").length<2&&viewsTabs.hide(),$(this).parent().prepend(viewsTabs),$(this).remove()}):(viewsTabs=$(".replace-img-block").clone().addClass("clonedTabs"),$(".replace-img-block").remove(),viewsTabs.find(".view_tab").length<2&&viewsTabs.hide(),$("#image-block").before(viewsTabs)),$("#image-block").attr("data-view",0),setTimeout(function(){$(".view_tab:first").trigger("click")},500),767<$(window).width()&&($(".pb-right-column").addClass("clearfix"),$(".box-info-product > div").removeClass("clearfix").addClass("col-md-4 col-sm-3 col-xs-6")),0<$(".ndkmask").length&&$(".ndkmask").each(function(){zindex=0<$(this).attr("data-zindex")?$(this).attr("data-zindex"):"99",$("#image-block").append('<img style="z-index:'+zindex+';" src="'+$(this).attr("data-src")+'" id="view-'+$(this).attr("data-view")+'" class="absolute-visu absolute-mask view-'+$(this).attr("data-view")+'"/>'),$("#image-block").find(":not(img, #view_full_size, #product-zoom, .fontSelect, canvas, .ui-rotatable-handle, .zone_limit)").hide()}),0<$(".zone_limit").length&&$(".zone_limit").each(function(){resizeZones($(this)),cloned=$(this).clone(),$("#image-block").append(cloned),$(this).remove()}),$(".colorize_svg").each(function(){myGroup=$(this).attr("data-group"),myUl=$(this),myColors=0<window["fieldColors_"+myGroup].length?window["fieldColors_"+myGroup]:colors;for(var t=0;t<myColors.length;t++)$("<li "+(0==t?'class="initial_color"':"")+'><span data-color="'+myColors[t]+'" style="background:'+myColors[t]+';">'+myColors[t]+"</span></li>").appendTo(myUl)}),setTimeout(function(){$(".initial_color").trigger("click")},500),$(".ndk_selector").each(function(){$(this).setNdkSelector()}),$("#submitNdkcsfields, .submitNdkcsfields").attr("disabled",!1),$(".tagify").tagify({delimiters:[13,188,44],addTagPrompt:tagslabel}),$(document).on("mouseover","#views_block li a",function(t){t.preventDefault()});var t=new HoverWatcher("#timeline");$("#timeline").prepend("<h3>"+timelineText+"</h3>"),setTimeout(function(){$(".pb-right-column").hide("slow")},4e3),$("#timeline").hover(function(){$(".pb-right-column").stop(!0,!0).show(450),$(this).removeClass("active")},function(){setTimeout(function(){t.isHoveringOver()||$(".pb-right-column").stop(!0,!0).hide(450),$(this).addClass("active")},200)}),$("#image-block").after('<div id="layer-block" class="clearfix clear"></div>'),"undefined"!=typeof is_visual&&1==is_visual&&($("#views_block .shown").removeClass("shown"),$(document).on("mouseover","#views_block li a",function(t){t.preventDefault(),$(".view_tab.activeView").trigger("click"),$("#views_block .shown").removeClass("shown")}))}function HoverWatcher(t){if("function"==typeof HoverWatcher_Override)return HoverWatcher_Override(t);this.hovering=!1;var e=this;this.isHoveringOver=function(){return e.hovering},$(t).hover(function(){e.hovering=!0},function(){e.hovering=!1})}function restoreDesign(){if("function"==typeof restoreDesign_Override)return restoreDesign_Override();null!=(savedDesign=localStorage.getItem("customNdk_"+$("#ndkcsfields-block").attr("data-key")))&&"undefined"!=typeof savedDesign&&""!=savedDesign&&setTimeout(function(){$("#image-block").html(savedDesign),$(".ui-draggable").draggable().rotatable({wheelRotate:!1}),$(".ui-resizable > img").resizable()},3e3)}function restoreForm(){if("function"==typeof restoreForm_Override)return restoreForm_Override();null!=(savedForm=localStorage.getItem("customNdkForm_"+$("#ndkcsfields-block").attr("data-key")))&&"undefined"!=typeof savedForm&&""!=savedForm&&setTimeout(function(){$("#ndkcsfields-block").html(savedForm)},3e3)}function redesignPageLight(){if("function"==typeof redesignPageLight_Override)return redesignPageLight_Override();$("#add_to_cart, product-add-to-cart > *:not(.product-quantity), .add button, .add-to-cart, .product-customization").hide(),"undefined"!=typeof isFieldsPack&&1==isFieldsPack?$(".replace-img-block").each(function(){(viewsTabs=$(this).clone()).find(".view_tab").length<2&&viewsTabs.hide(),$(this).parent().prepend(viewsTabs),$(this).remove()}):((viewsTabs=$(".replace-img-block").clone().addClass("clonedTabs")).find(".view_tab").length<2&&viewsTabs.hide(),$(".replace-img-block").remove(),$("#image-block").before(viewsTabs)),$("#image-block").attr("data-view",0),0<$(".ndkmask").length&&$(".ndkmask").each(function(){zindex=0<$(this).attr("data-zindex")?$(this).attr("data-zindex"):"99",$("#image-block").append('<img style="z-index:'+zindex+';" src="'+$(this).attr("data-src")+'" id="view-'+$(this).attr("data-view")+'" class="absolute-visu absolute-mask view-'+$(this).attr("data-view")+'"/>'),$("#image-block").find(":not(img, #view_full_size, #product-zoom, .fontSelect, canvas, .ui-rotatable-handle, .zone_limit)").hide(),$("#image-block").find(":not(img, #view_full_size, #product-zoom, .fontSelect, canvas, .ui-rotatable-handle, .zone_limit)").hide()}),0<$(".zone_limit").length&&$(".zone_limit").each(function(){resizeZones($(this)),cloned=$(this).clone(),$("#image-block").append(cloned),$(this).remove()}),setTags(),$(".colorize_svg").each(function(){myGroup=$(this).attr("data-group"),myUl=$(this),myColors=0<window["fieldColors_"+myGroup].length?window["fieldColors_"+myGroup]:colors;for(var t=0;t<myColors.length;t++)$("<li "+(0==t?'class="initial_color"':"")+'><span data-color="'+myColors[t]+'" style="background:'+myColors[t]+';">'+myColors[t]+"</span></li>").appendTo(myUl)}),$(".ndk_selector").each(function(){$(this).setNdkSelector()}),$("#submitNdkcsfields, .submitNdkcsfields").attr("disabled",!1),$(".tagify").tagify({delimiters:[13,188,44],addTagPrompt:tagslabel}),"undefined"!=typeof is_visual&&1==is_visual&&($("#views_block .shown").removeClass("shown"),$(document).on("mouseover","#views_block li a",function(t){t.preventDefault(),$(".view_tab.activeView").trigger("click"),$("#views_block .shown").removeClass("shown")})),$("#image-block").after('<div id="layer-block" class="clearfix clear"></div>')}function redesignPageLight_bak(){$("#add_to_cart, .product-add-to-cart, .add, .add-to-cart").hide(),0<$(".ndkmask").length&&($("#image-block").append('<img src="'+$(".ndkmask").attr("data-src")+'" class="absolute-visu absolute-mask view-'+$(".ndkmask").attr("data-view")+'"/>'),$("#image-block").find(":not(img, #view_full_size,  #product-zoom, .fontSelect, canvas, .ui-rotatable-handle)").hide()),0<$(".zone_limit").length&&$(".zone_limit").each(function(){setTimeout(function(){resizeZones($(this)),cloned=$(this).clone(),$("#image-block").append(cloned),$(this).remove()},1e3)}),viewsTabs=$(".replace-img-block").clone(),$(".replace-img-block").remove(),$("#image-block").before(viewsTabs),$("#image-block").attr("data-view",0),setTimeout(function(){$(".clonedTabs .view_tab:first").trigger("click")},500)}function setImgValue(t,e){if("function"==typeof setImgValue_Override)return setImgValue_Override(t,e);$("#ndkcsfield_"+e).val(t.attr("data-value")).trigger("keyup"),$(t).parent().parent().find(".selected-value").removeClass("selected-value"),$(t).parent().parent().parent().find(".svg-container").removeClass("selected-svg"),$(".img-value-"+e).removeClass("selected-value"),$(t).addClass("selected-value"),t.parent().hasClass("svg-container")&&t.parent().addClass("selected-svg"),checkFieldRestrictions(t.attr("data-id-value"),t.attr("data-group"))}function setEditable(t,e,i,a,r,o,n){if("function"==typeof setEditable_Override)return setEditable_Override(t,e,i,a,r,o,n);i="",1==o?(group=$(t).attr("data-group").split("-"),$(t).resizable({aspectRatio:!0,containment:i,autoHide:!0,handles:"se",start:function(){!$(this).hasClass("activeZone")&&group&&$(".form-group[data-field='"+group[0]+"']").trigger("click"),$("#image-block").addClass("editing")},stop:function(){setTimeout(function(){$(".resetZones").trigger("click"),convertPercent()},2850),$(".editing").removeClass("editing")}}),$(t).removeClass("notResizeable")):($(t).resizable({aspectRatio:!0,containment:i,autoHide:!0,maxHeight:$(t).parent().height(),maxWidth:$(t).parent().width(),minHeight:$(t).parent().height(),minWidth:$(t).parent().width(),handles:"se",create:function(t,e){$(".ui-icon-gripsmall-diagonal-se").remove()},stop:function(){setTimeout(function(){$(".resetZones").trigger("click"),convertPercent()},2850)}}),$(t).addClass("notResizeable")),rotDragEl=$(t),$(t).attr("data-dragdrop",r).attr("data-rotateable",n).attr("data-resizeable",o),$(t).css("z-index",e).attr("data-zindex",e),group=rotDragEl.attr("data-group").split("-"),1==r&&rotDragEl.draggable({containment:i,start:function(){!$(this).hasClass("activeZone")&&group&&$(".form-group[data-field='"+group[0]+"']").trigger("click"),$("#image-block").addClass("editing")},stop:function(){setTimeout(function(){$(".resetZones").trigger("click"),convertPercent()},2850),$(".editing").removeClass("editing"),$(t).css("z-index",e)},zIndex:e}),1==n&&rotDragEl.rotatable({wheelRotate:!1,start:function(){!$(this).hasClass("activeZone")&&group&&$(".form-group[data-field='"+group[0]+"']").trigger("click"),$("#image-block").addClass("editing")},stop:function(){setTimeout(function(){$(".resetZones").trigger("click")},2850),$(".editing").removeClass("editing"),$(t).css("z-index",e)}}).css("z-index",e).addClass("rotatable"),$(t).parent().find(".layer_view").length<1&&$("#layer-block").append(a),checkLayerChanges(),$("#image-block").find(".fontSelect >*, canvas > *").show(),$("#image-block").find(".ui-wrapper").show().css("position","absolute")}function dragToPercent(t){if("function"==typeof dragToPercent_Override)return dragToPercent_Override(t);t.position();var e=t.parent().height(),i=t.parent().width(),a=parseFloat(t.css("top").replace("px","")),r=parseFloat(t.css("left").replace("px",""));t.css("top",a/e*100+"%").css("left",r/i*100+"%").css("width",t.width()/i*100+"%").css("height",t.height()/e*100+"%").addClass("percented")}function dragToPercentBak(t){if("function"==typeof dragToPercentBak_Override)return dragToPercentBak_Override(t);var e,i,a;t.hasClass("percented")||(e=100*parseFloat(t.css("left"))/parseFloat(t.parent().css("width"))+"%",i=100*parseFloat(t.css("top"))/parseFloat(t.parent().css("height"))+"%",a=100*parseFloat(t.css("width"))/parseFloat(t.parent().css("width"))+"%",t.css("left",e),t.css("top",i),t.css("width",a),t.css("height","auto"),t.addClass("percented"))}function designCompo(e,i,t,a,r,o,n,d,s,l,c,p){if("function"==typeof designCompo_Override)return designCompo_Override(e,i,t,a,r,o,n,d,s,l,c,p);if(c=c||"normal",p=p||"",specifiView=!0,isItem=!1,number=0,itemGroup=0,-1<i.indexOf("-")&&(isItem=!0,number=i.split("-")[1],itemGroup=i.split("-")[0]),originalWidth=d+"px",0<$(".zone_limit[data-group='"+(0<itemGroup?itemGroup:i)+"']").length&&0<$(".view_tab[data-view='"+t+"']").length?(container=".zone_limit[data-group='"+(0<itemGroup?itemGroup:i)+"']",containment="parent",maxwidth=$(".zone_limit[data-group='"+(0<itemGroup?itemGroup:i)+"']").width()+"px",maxheight=$(".zone_limit[data-group='"+(0<itemGroup?itemGroup:i)+"']").height()+"px",s="auto",maxwidth="100%",maxheight="100%",$(".zone_limit[data-group='"+(0<itemGroup?itemGroup:i)+"']").css("mix-blend-mode",c)):(container="#image-block",containment="",maxwidth="100%",maxheight="100%",s="auto"),0<o&&(maxwidth="5000px",maxheight="5000px"),$(container).css("z-index",a),editIndex="",editButton="<span "+editIndex+' class="editIt"></span>',0!=$("#image-block[data-view='"+t+"']").length&&0!=t||(specifiView=!1),$("#image-block").attr("data-view")==t||0==t||!specifiView){if(void 0!==e)if(0<$("#image-block .group-"+i).length)"canvas"==l||"text"==l||"svg"==l?$("#image-block .group-"+i+" .composition_element").replaceWith(e):"colorize"==l?($("#image-block .group-"+i+" svg").remove(),$("#image-block .group-"+i+" object").remove(),ndkImagetoDataURLForSvg(p,function(t){png2svg(t,e,p,i)})):$("#image-block .group-"+i+" .composition_element").replaceWith('<img class="composition_element img-reponsive" src="'+e+'"/>'),$("#image-block .group-"+i).fadeIn("slow"),1!=r&&1!=o&&1!=n||(layerOptions="","canvas"==l||"text"==l?layerOptions+='<span id="layer-edit-'+i+'" data-view="'+t+'" data-group="'+i+'" class="editThisLayer">'+e+"</span>":"svg"==l?(output="object"==typeof e?e.prop("outerHTML"):e,layerOptions+='<span id="layer-edit-'+i+'" data-view="'+t+'" data-group="'+i+'" class="editThisLayer">'+output+"</span>"):layerOptions+='<span id="layer-edit-'+i+'" data-view="'+t+'" data-group="'+i+'" class="editThisLayer"><img class="img-responsive very-small-img" src="'+e+'"/></span>',0<$("#layer-edit-"+i).length?($("#layer-edit-"+i).replaceWith(layerOptions),layerOptions=""):$("#layer-block").append(layerOptions).show()),$("#image-block .group-"+i).css("mix-blend-mode",c);else{if(viewClass=" ",-1<t.indexOf("|")){views=t.split("|");for(var u=0;u<views.length;u++)viewClass+=" view-"+views[u]}$("#image-block .group-"+i).remove(),"canvas"==l?($(container).append('<div data-group="'+i+'" data-zindex="'+a+'" id="visual_'+i+'" style="margin:none;width:auto; height:'+s+"; max-width:"+maxwidth+"; max-height:"+maxheight+"; z-index:"+a+"; mix-blend-mode:"+c+'" class="'+(1==r?"dragdrop":"")+" absolute-visu group-"+i+" view-"+t+viewClass+'"></div>'),$("#visual_"+i).html(e+editButton)):"svg"==l?($(container).append('<div data-group="'+i+'" data-zindex="'+a+'" id="visual_'+i+'" style="margin:none; height:'+s+"; max-width:"+maxwidth+"; max-height:"+maxheight+"; z-index:"+a+";mix-blend-mode:"+c+'" class="'+(1==r?"dragdrop":"")+" absolute-visu group-"+i+" view-"+t+viewClass+' absolute-svg-text"><div class="composition_element"></div>'+editButton+"</div>"),$("#image-block .group-"+i+" .composition_element").replaceWith(e)):"text"==l?$(container).append('<div data-group="'+i+'" data-zindex="'+a+'" id="visual_'+i+'" style="margin:none;width:'+originalWidth+"; height:"+s+"; max-width:"+maxwidth+"; max-height:"+maxheight+"; z-index:"+a+"; mix-blend-mode:"+c+'" class="'+(1==r?"dragdrop":"")+" absolute-visu group-"+i+" view-"+t+viewClass+'">'+e+editButton+"</div>"):"colorize_bak"==l?ndkBrowserVersion?$(container).append('<div data-group="'+i+'" data-zindex="'+a+'" id="visual_'+i+'" style="height:'+s+"; max-width:"+maxwidth+"; max-height:"+maxheight+"; z-index:"+a+" ;mix-blend-mode:"+c+';" class="'+(1==r?"dragdrop":"")+" absolute-visu group-"+i+" view-"+t+viewClass+" absolute-img "+("color"==l?"multiply-mode-color":"")+'"><div  style="" class=""><img class=" composition_element img-reponsive " src="'+e+'"/></div>'+editButton+"</div>"):$(container).append('<div data-group="'+i+'" data-zindex="'+a+'" id="visual_'+i+'" style="height:'+s+"; max-width:"+maxwidth+"; max-height:"+maxheight+"; z-index:"+a+" ;mix-blend-mode:"+c+';" class="'+(1==r?"dragdrop":"")+" absolute-visu group-"+i+" view-"+t+viewClass+" absolute-img "+("color"==l?"multiply-mode-color":"")+'"><div  style="background:'+p+"; mask-image: url('"+e+"');-webkit-mask-image: url('"+e+'\');" class="colorize-cover-item"><img class=" composition_element img-reponsive " src="'+e+'"/></div>'+editButton+"</div>"):"colorize"==l?($(container).append('<div data-group="'+i+'" data-zindex="'+a+'" id="visual_'+i+'" style="height:'+s+"; max-width:"+maxwidth+"; max-height:"+maxheight+"; z-index:"+a+" ;mix-blend-mode:"+c+';" class="'+(1==r?"dragdrop":"")+" absolute-visu group-"+i+" view-"+t+viewClass+" absolute-img "+("color"==l?"multiply-mode-color":"")+'">'+editButton+"</div>"),ndkImagetoDataURLForSvg(p,function(t){png2svg(t,e,p,i)})):$(container).append('<div data-group="'+i+'" data-zindex="'+a+'" id="visual_'+i+'" style="margin:none;width:auto; height:'+s+"; max-width:"+maxwidth+"; max-height:"+maxheight+"; z-index:"+a+" ;mix-blend-mode:"+c+';" class="'+(1==r?"dragdrop":"")+" absolute-visu group-"+i+" view-"+t+viewClass+" absolute-img "+("color"==l?"multiply-mode-color":"")+'"><img class=" composition_element img-reponsive" src="'+e+'"/>'+editButton+"</div>"),1!=r&&1!=o&&1!=n||(layerOptions="","canvas"==l||"text"==l?layerOptions+='<span id="layer-edit-'+i+'" data-view="'+t+'" data-group="'+i+'" class="editThisLayer">'+e+"</span>":"svg"==l?(output="object"==typeof e?e.prop("outerHTML"):e,layerOptions+='<span id="layer-edit-'+i+'" data-view="'+t+'" data-group="'+i+'" class="editThisLayer">'+output+"</span>"):layerOptions+='<span id="layer-edit-'+i+'" data-view="'+t+'" data-group="'+i+'" class="editThisLayer"><img class="img-responsive very-small-img" src="'+e+'"/></span>',setEditable("canvas"==l?"#visual_"+i+" > canvas":"#visual_"+i,a,containment,layerOptions,r,o,n))}scrollToNdk($(container),800)}setTimeout(function(){$(".orientation_selection[data-group-target='"+i+"']").find(".active_orientation").trigger("click")},800)}function createPreview(t){if("function"==typeof createPreview_Override)return createPreview_Override(t);var e;e=((0<customizationPrice||"undefined"!=typeof is_visual&&1==is_visual)&&(convertPercent(),$(".ndk-img-url").val("").trigger("keyup"),0<(viewTabs=$(".view_tab")).length)&&$("li.view_tab").first().trigger("click"),snapShot(!1,!1,!0)),$.when(e).done(function(){setTimeout(function(){t()},500)})}function simuViews(t,e){return"function"==typeof simuViews_Override?simuViews_Override(t):(snapShot(t=t||!1,e=e||!1),!0)}function snapShot(t,e,i){if("function"==typeof snapShot_Override)return snapShot_Override(t,e,i);var a,r;1==showImgPreview&&1==is_visual&&$("#image-block").addClass("hight_quality"),t=t||!1,e=e||!1,i=i||!1,(0<customizationPrice||"undefined"!=typeof is_visual&&1==is_visual)&&((dataView=0)==$("li.view_tab").length&&(htmlOutput[0]='<div class="print-page-breaker">'+$("#image-block").html()+"</div>"),compoImages=[],$.when((a=t,r=i,void(0<(t=e?$("li.view_tab:eq(0)"):$("li.view_tab")).length?t.each(function(){var t=(tab=$(this)).trigger("click");$.when(t).done(function(){processTabForSnapShot(parseFloat(tab.attr("data-view")),a,r)})}):processTabForSnapShot(0,a,r)))).done(function(){$(".image-url").each(function(){compoImages.push($(this).val())}),$("#image-block").removeClass("hight_quality")}))}function processTabForSnapShot(e,t,i){if("function"==typeof processTabForSnapShot_Override)return processTabForSnapShot_Override(e,t,i);0==showImgPreview&&(only_html=!0),clonedView=$("#image-block[data-view ='"+e+"']").clone(),$(clonedView).find("> :not(.view-"+e+" , .view-0, #view_full_size, #product-zoom, .ndk-svg-view, #bigpic, .tempSvg, .middle-content)").remove(),$(clonedView).find(".hiddenForSnapshot").show().removeClass(".hiddenForSnapshot"),$(clonedView).find("#image-block[data-view ='"+e+"'] svg").show(),htmlOutput[e]='<div class="print-page-breaker">'+clonedView.html()+"</div>",clonedView.remove(),t||$(this).addClass("snapshoot"),t=i?function(){return!0}:svgToCanvas($("#image-block")),$.when(t).done(function(){html2canvas($("#image-block"),{onrendered:function(t){t=t.toDataURL("image/png");$("#image-url-"+e).val(t).trigger("keyup"),$(".tempSvg").remove(),$(".hiddenForSnapshot").show().removeClass(".hiddenForSnapshot"),$("#image-block[data-view ='"+e+"']").find("svg").show(),$(".current_config_img").attr("src",t).show(),$("#image-url-0").val(t).trigger("keyup")}})})}function svgToCanvas(t){if("function"==typeof svgToCanvas_Override)return svgToCanvas_Override(t);t=t.find("svg");$(".tempSvg").remove(),t.each(function(t,e){(el=$(this)).show();var i=new Image,a=e.parentNode,e=e.outerHTML;width=el[0].getBoundingClientRect().width,height=el[0].getBoundingClientRect().height,i.src="data:image/svg+xml,"+escape(e),a.appendChild(i),$(i).addClass("tempSvg replaced-svg composition_element"),el.addClass("hiddenForSnapshot"),$(i).load(function(){var t=document.createElement("canvas"),e=(i.width=width,i.height=height,t.width=width,t.height=height,t.getContext("2d"));$.when(e.drawImage(i,0,0)).done(function(){i.src=t.toDataURL()})}),el.hide()})}function snapShotFirst(){if("function"==typeof snapShotFirst_Override)return snapShotFirst_Override();html2canvas($("#image-block"),{onrendered:function(t){t=t.toDataURL("image/png");$("#image-url-0").val(t).trigger("keyup"),$(".ndkzoom").attr("href",t)}})}void 0!==fonts&&0!=fonts.length||(fonts=default_fonts),void 0!==colors&&0!=colors.length||(colors=default_colors);doneTypingInterval=1e3;function snapShotLight(){if("function"==typeof snapShotLight_Override)return snapShotLight_Override();(0<customizationPrice||"undefined"!=typeof is_visual&&1==is_visual)&&($(".ndkzoom").attr("disabled","disabled").addClass("loadingButton"),dataView=0,dataView=$("#image-block").attr("data-view"),(dataView=0).length&&0!=dataView.length||(dataView=0),html2canvas($("#image-block"),{onrendered:function(t){t=t.toDataURL("image/png");$("#image-url-"+dataView).val(t).trigger("keyup"),$(".ndkzoom").attr("href",t),$(".ndkzoom").attr("disabled",!1).removeClass("loadingButton")}}))}function setToZone(t,e){if("function"==typeof setToZone_Override)return setToZone_Override(t,e);left=$(e).offset().left,top=$(e).offset().top+$(e).outerHeight(),$(t).css({position:"absolute",left:left+"px",top:top+"px"})}function initText(t){if("function"==typeof initText_Override)return initText_Override(t);var e=t.parent().find(".texteditor"),i=t.attr("data-group"),a=t.attr("data-number");if(void 0===a&&(a=!1),pattern=(pattern=""!=t.attr("data-pattern")&&void 0!==t.attr("data-pattern")?t.attr("data-pattern"):"|").split("|"),canvasDom='<canvas id="myCanvas'+t.attr("data-group")+'" width="0" height="0"></canvas>',!e.length||0==e.length){if(0<t.attr("data-lines"))if(t.hasClass("type_textarea"))zone_text=(zone_text='<span class="textarea">')+"<textarea "+(0<t.attr("data-max")?'maxlength="'+t.attr("data-max")+'"':"")+' class="noborder countmychars" data-pattern="'+pattern[0]+'"></textarea></span><style>.arcSelector{display:none!important;}</style>',t.after('<div class="fontSelect " id="textZone'+t.attr("data-group")+(0!=a?"-"+a:"")+'"><span class="texteditor">'+zone_text+'</span><span class="submitText'+(0!=a?"Item":"")+'">'+applyText+'</span></div><div class="conter-container"></div>');else{zone_text='<span class="textarea">';for(var r=0;r<t.attr("data-lines");r++)zone_text+='<input data-pattern="'+pattern[r]+'" type="text" '+(0<t.attr("data-max")?'maxlength="'+t.attr("data-max")+'"':"")+' size="15" value="" class="noborder" placeholder="Text line '+(r+1)+'"/>';zone_text+="</span><style>.arcSelector{display:none!important;}</style>",t.after('<div class="fontSelect " id="textZone'+t.attr("data-group")+(0!=a?"-"+a:"")+'"><span class="texteditor">'+zone_text+'</span><span class="submitText'+(0!=a?"Item":"")+'">'+applyText+"</span></div>")}else zone_text=t.hasClass("type_textarea")?(width="auto",height="auto",0<$(".zone_limit[data-group='"+i+"']").length&&(container=".zone_limit[data-group='"+i+"']",width=$(container).width(),height=$(container).height()),zone_text='<span class="textarea">',(zone_text+='<textarea style="width:'+width+"; height:"+height+' " '+(0<t.attr("data-max")?'maxlength="'+t.attr("data-max")+'"':"")+' type="text" class="noborder"></textarea>')+'<div id="poptext_'+i+'" class="poptext"></div></span><style>.arcSelector{display:none!important;}</style>'):(zone_text='<span class="textarea">')+"<input "+(0<t.attr("data-max")?'maxlength="'+t.attr("data-max")+'"':"")+' type="text" size="15" value="Votre texte " class="noborder"/></span><style>.arcSelector{display:none!important;}</style>',t.after('<div class="fontSelect " "textZone'+t.attr("data-group")+(0!=a?"-"+a:"")+'"><span class="texteditor">'+zone_text+'</span><span class="submitText'+(0!=a?"Item":"")+'">'+applyText+"</span></div>");t.after(canvasDom),$(".noborder, .simpleText, .noborderSimple").each(function(){maxChars=$(this).attr("maxlength"),0<parseInt(maxChars)&&$(this).maxlength({slider:!0,maxCharacters:maxChars}),""!=(textmask=$(this).attr("data-pattern"))&&"undefined"!=typeof textmask&&(""!=(mask=textmask.split("&&"))[0]&&void 0!==mask[0]?$(this).mask(mask[0],{placeholder:mask[1]}):""!=mask[1]&&void 0!==mask[1]&&$(this).attr("placeholder",mask[1]))});e=fonts;myColors=colors,mySizes=["20","30","40","50","60","70","80","90","100"],myEffects=["applatMe","concavMe","convexMe"],myAlignments=["left","center","right"],0<window["fieldFonts_"+i].length&&(e=window["fieldFonts_"+i]),0<window["fieldColors_"+i].length&&(myColors=window["fieldColors_"+i]),0<window["fieldSizes_"+i].length&&(mySizes=window["fieldSizes_"+i]),0<window["fieldEffects_"+i].length&&(myEffects=window["fieldEffects_"+i]),0<window["fieldAlignments_"+i].length&&(myAlignments=window["fieldAlignments_"+i]),allFonts.push(e),$("#textZone"+t.attr("data-group")+(0!=a?"-"+a:"")).fontSelector({hide_fallbacks:!0,initial:e[0],initialSize:$(window).width()<768?mySizes[0]/2:mySizes[0],initialColor:myColors[0],initialEffect:myEffects[0],initialAlignment:myAlignments[0],selected:function(t){},selectedSize:function(t){},selectedColor:function(t){$(".colorSelector").css("background",t)},fonts:e,sizes:mySizes,colors:myColors,effects:myEffects,alignments:myAlignments,showStroke:stroke_color[i]})}$("#textZone"+t.attr("data-group")).css("font-size",mySizes[0]+"px"),setTimeout(function(){$(".fontSelectUl").each(function(){$(this).find("li").first().addClass("active")}),$(".fontColorSelectUl").each(function(){$(this).find("li").first().addClass("active")})},1500)}function initTextLight(t){if("function"==typeof initTextLight_Override)return initTextLight_Override(t);var e=t.hasClass("initiated"),i=t.attr("data-group");t.attr("data-number");if(pattern=(pattern=""!=t.attr("data-pattern")&&void 0!==t.attr("data-pattern")?t.attr("data-pattern"):"").split("|"),!e){if(0<t.attr("data-lines")){zone_text='<div class="zone_text_inputs pt-1">';for(var a=0;a<t.attr("data-lines");a++)zone_text+='<input id = "text_'+i+'"  data-pattern="'+pattern[a]+'" type="text" '+(0<t.attr("data-max")?'maxlength="'+t.attr("data-max")+'"':"")+' size="15" value="" class="'+(t.hasClass("required_field")?"required_field_test":"")+' noborderSimple" placeholder="Text line '+(a+1)+'" data-message="'+t.attr("data-message")+'"/>';zone_text+="</div>",t.after(zone_text).addClass("initiated").hide()}$(".noborderSimple, .simpleText, .noborderSimple").each(function(){maxChars=$(this).attr("maxlength"),0<parseInt(maxChars)&&$(this).maxlength({slider:!0,maxCharacters:maxChars}),""!=(textmask=$(this).attr("data-pattern"))&&"undefined"!=typeof textmask&&(""!=(mask=textmask.split("&&"))[0]&&void 0!==mask[0]?$(this).mask(mask[0],{placeholder:mask[1]}):""!=mask[1]&&void 0!==mask[1]&&$(this).attr("placeholder",mask[1]))})}}function stopWheel(t){if("function"==typeof stopWheel_Override)return stopWheel_Override(t);(t=t||window.event).preventDefault&&t.preventDefault(),t.returnValue=!1}function calculateSurface(t,e,i){if("function"==typeof calculateSurface_Override)return calculateSurface_Override(t,e,i);result=1;for(var a=0;a<e.length;a++)void 0!==e[a]&&(result=parseFloat(parseFloat(result)*parseFloat(e[a])));updatePriceNdk(price=0<parseFloat(result)?($("#resultValue_"+t).html(parseFloat(result).toFixed(2)),$(".resultValue_"+t).show(),parseFloat(i*result)):($("#resultValue_"+t).html(),$(".resultValue_"+t).hide(),0),t)}function setNdkImgTooltip(){$(".img-item-row").each(function(){var t=$(this),e=t.find(".img-value:eq(0)").attr("data-src");""!=e&&(html_img='<img class="img-responsive" src="'+e+'"/>',t.tooltip({html:!0,content:html_img,placement:"top"}))})}function loadAccessoryAttrPrice(t,e,i,a){if("function"==typeof loadAccessoryAttrPrice_Override)return loadAccessoryAttrPrice_Override(t,e,i,a);group=a.attr("data-group"),$.ajax({type:"GET",url:baseUrl+"modules/ndk_advanced_custom_fields/front_ajax.php",data:{id_product:t,id_product_attribute:e,quantity:i,action:"getAttributePrice"},dataType:"json",async:!0,success:function(t){a.attr("data-price",t.price),qtty=(a.hasClass("ndk-accessory-comb-tab")?$("#ndkcf_totalprod_quantity_"+a.attr("data-id-value")):a).val(),qtty=a.val(),unitPrice=t.price,price=qtty*unitPrice,valueId=a.attr("data-value-id"),$(".ndk-accessory-quantity[data-group='"+group+"'][value!=0]").not(a).each(function(){0<$(this).val()&&$(this).attr("data-price")!=t.price&&$(this).trigger("keyup")}),updatePriceNdk(price,a.attr("data-value-id")),$(".final_price_"+a.attr("data-id-value")).html(formatCurrencyNdk(t.price)),1==displayPriceHT&&(key=a.hasClass("ndk-accessory-comb-tab")?a.attr("data-value-id"):a.attr("data-id-value"),$(".final_price_"+key+" .priceht").remove(),$(".final_price_"+key).append('<span class="priceht clear clearfix"></span>'),getPriceHt(t.price,".final_price_"+key+" .priceht")),0<(price_ratio=a.attr("data-price-ratio"))&&(unit_price=t.price/price_ratio,a.parent().parent().parent().find(".unit_price_display").html(formatCurrencyNdk(unit_price))),productWeight=parseFloat(a.attr("data-product-weight")),attrWeight=t.weight?productWeight+parseFloat(t.weight):productWeight,lastWeight=parseFloat(a.attr("data-weight")),a.attr("data-weight",attrWeight),lastWeight==attrWeight||isNaN(attrWeight)||isNaN(lastWeight)||a.trigger("keyup")}})}function loadAccessoryAttrImg(e,t,i,a){if("function"==typeof loadAccessoryAttrImg_Override)return loadAccessoryAttrImg_Override(e,t,i,a);$.ajax({type:"GET",url:baseUrl+"modules/ndk_advanced_custom_fields/front_ajax.php",data:{id_product:e,id_product_attribute:t,link_rewrite:i,action:"getAttributeImg"},dataType:"html",success:function(t){a.parent().parent().parent().find(".img-responsive").attr("src",t),$(".accessory-ndk[data-id-product-value='"+e+"']").trigger("click").addClass("test")}})}function saveCustomization(t){if("function"==typeof saveCustomization_Override)return saveCustomization_Override(t);t=t||!1,$("#ndkcf_config_tags").val($("#ndkcf_config_tags").tagify("serialize")),left_block=$("#image-block").html(),right_block=$("#ndkcsfields").html(),layer_block=$("#layer-block").html(),id_product=$("#ndkcf_id_product").val(),id_customer=$("#ndkcf_id_customer").val(),config_tags=t?(config_name=t,""):(config_name=$("#ndkcf_config_name").val(),$("#ndkcf_config_tags").val()),$("body").append('<div class="ndk-loader" id="ndkloader"><div class="sk-folding-cube"><div class="sk-cube1 sk-cube"></div><div class="sk-cube2 sk-cube"></div><div class="sk-cube4 sk-cube"></div><div class="sk-cube3 sk-cube"></div></div></div>'),$(right_block).find(".image-url").val(""),leftDatas=btoa(RawDeflate.deflate(left_block)),rightDatas=btoa(RawDeflate.deflate(right_block)),layerDatas=btoa(RawDeflate.deflate(layer_block)),json_values=getSelectedValuesFromConfig($.parseHTML(strReplaceAll(right_block,"¬","€"))),configPrice=getPriceHt(totalUnitPrice,"",!0),$.when(simuViews(!0,!0)).done(function(){$.ajax({type:"POST",url:baseUrl+"modules/ndk_advanced_custom_fields/saveConfig.php",data:{action:"saveConfig",leftBlock:leftDatas,rightBlock:rightDatas,layerBlock:layerDatas,idCustomer:id_customer,idProduct:id_product,idCustomization:0,configName:config_name,configTags:config_tags,configImg:compoImages,price:configPrice,json_values:json_values},dataType:"html",success:function(t){$("#name_already_exists").hide(),$("#ndkcsfields").append('<p id="saved"><span>'+savedtext+"</span></p>"),$(".current_config_img").attr("src",compoImages[0]).show(),makeSocialCompo(t,!0),setTimeout(function(){$("#saved, #ndkloader").remove()},800)},error:function(){}})})}function loadCustomization(e){if("function"==typeof loadCustomization_Override)return loadCustomization_Override(e);var i=$("#ndkcf_id_product").val(),a=($("#quantity_wanted").val(),$("#ndkcf_id_combination").val());$.ajax({type:"GET",url:baseUrl+"modules/ndk_advanced_custom_fields/saveConfig.php",data:{action:"getConfig",idConfig:e},dataType:"json",success:function(t){t=copyHtmlBlocks(t);$.when(t).then(function(){$(".fieldPane").show(),loadInitialValues(),reCalculatePrice(),applyConfigValuesNdk(),reSetEditableFields(),$(".pace").remove(),0==parseInt(letOpen)&&$(".fieldPane").hide(),1==makeSlide?makeGroupFieldsSlide():$(".ndkackFieldItem").removeClass("sliderBlock"),$("#ndkcf_id_product").val(i),$("#ndkcf_id_combination").val(a),$("#submitNdkcsfields, .submitNdkcsfields").attr("disabled",!1),$(".image-url").val(""),$(".current_config_img").attr("src",$("#configItem_"+e+" .ndkLoadConfigImg").attr("src")),setTimeout(function(){equalheight(".img-item-row"),makeSocialCompo(e,!1),$(".tooltipDescMark").each(function(){text=$(this).parent().find(".tooltipDescription").html(),$(this).tooltip({html:!0,title:text,placement:"auto"})}),$.prototype.uniform,$(".resetZones").trigger("click"),setOpenedStatus(),$(".ndk_tag_selector").val("all").trigger("change"),$("#submitNdkcsfields, .submitNdkcsfields").unbind("click").click(function(t){$("#ndkcsfields").ndkSubmit(t)})},1e3)})},error:function(){}})}function copyHtmlBlocks(t){if("function"==typeof copyHtmlBlocks_Override)return copyHtmlBlocks_Override(t);for(idField in $("#image-block").html($.parseHTML(strReplaceAll(t.leftBlock,"¬","€"))),$("#layer-block").html($.parseHTML(strReplaceAll(t.layerBlock,"¬","€"))),$("#ndkcsfields").html($.parseHTML(strReplaceAll(t.rightBlock,"¬","€"))),configToSet=getSelectedValuesFromConfig($.parseHTML(strReplaceAll(t.rightBlock,"¬","€"))))configToSet[idField]}function triggerConfig(t,e){if("function"==typeof triggerConfig_Override)return triggerConfig_Override(t,e);$("#main-"+t).find(".img-value[data-id-value='"+e+"']").trigger("click"),$("#main-"+t).find(".color-ndk[data-id-value='"+e+"']").trigger("click"),$("#main-"+t).find(".ndk-select").val(e).trigger("change"),$("#main-"+t).find(".ndk-radio[value='"+e+"']").prop("checked",!0).trigger("click").trigger("change"),$("#main-"+t).find(".ndk-checkbox[value='"+e+"']").prop("checked",!0).trigger("click").trigger("change"),$("#main-"+t).find(".simpleText, input.visual-text, .noborder").val(e).trigger("change").trigger("keyup")}function applyConfigValuesNdk(){if("function"==typeof applyConfigValuesNdk_Override)return applyConfigValuesNdk_Override();$(".color-ndk.selected-value").trigger("click"),$(".img-value.selected-value").each(function(){(0<$(this).parent().find(".svg-container").length?$(this).parent().find(".svg-container"):$(this)).trigger("click")}),$(".ndk-radio:checked, .checked .ndk-radio").prop("checked",!0).trigger("click").trigger("change"),$(".ndk-checkbox:checked, .checked .ndk-checkbox,.ndk-checkbox[checkme='1']").prop("checked",!0).trigger("change"),$(".ndk-select").each(function(){$(this).find("option:selected").prop("selected","selected"),$(this).trigger("change")}),$(".dimension_text").each(function(){$(this).trigger("keyup").trigger("change")}),$(".form-group").removeClass("activeFormGroup"),$.prototype.uniform&&$("select.form-control,input[type='radio'],input[type='checkbox']").not(".not_uniform").uniform()}function reCalculatePrice(){if("function"==typeof reCalculatePrice_Override)return reCalculatePrice_Override();$(".selected-value, .ndk-radio:checked, .ndk-select option:selected").each(function(){group=$(this).attr("data-group"),updatePriceNdk(price=$(this).attr("data-price"),group)}),$(".selected-svg").each(function(){group=$(this).parent().find(".img-value").attr("data-group"),updatePriceNdk(price=$(this).parent().find(".img-value").attr("data-price"),group)}),$(".noborderSimple").each(function(){rootInput=$(this).parent().parent().find(".simpleText"),group=rootInput.attr("data-group"),price=rootInput.attr("data-price"),ppcprice=rootInput.attr("data-ppcprice"),el=$(this),texte="",charsCount=0,inputNumber=el.parent().find(".noborderSimple").length,separator=1<inputNumber?" \n ":"",el.parent().find(".noborderSimple").each(function(){""!=$(this).val()&&(texte+=$(this).val()+separator,charsCount+=$(this).val().replace(/\ /g,"").length)}),""==texte||" "==texte?(price=0,texte=""):price=0<ppcprice?ppcprice*charsCount:rootInput.attr("data-price"),""!=texte&&" "!=texte||(price=0,texte=""),rootInput.val(texte),updatePriceNdk(price,group)}),$(".submitSimpleText").each(function(){group=$(this).parent().find(".visual-text").attr("data-group"),price=$(this).parent().find(".visual-text").attr("data-price"),ppcprice=$(this).parent().find(".visual-text").attr("data-ppcprice"),(charsCount=charsCount=0)<$(this).parent().find("input.visual-text").length?(texte="",$(this).parent().find("input.visual-text").each(function(){""!=$(this).val()&&(texte+=$(this).val()+" ",charsCount+=$(this).val().replace(/\ /g,"").length)})):texte=$(this).parent().find("textarea").text(),""==texte||" "==texte?(price=0,texte=""):price=0<ppcprice?ppcprice*charsCount:$(this).parent().parent().find("textarea").attr("data-price"),""!=texte&&" "!=texte||(price=0,texte=""),updatePriceNdk(price,group)}),$(".submitText").each(function(){group=$(this).parent().parent().find(".ndktextarea").attr("data-group"),price=$(this).parent().parent().find(".ndktextarea").attr("data-price"),ppcprice=$(this).parent().parent().find(".ndktextarea").attr("data-ppcprice"),charsCount=0,inputNumber=$(this).parent().find(".noborder").length,separator=1<inputNumber?" \n ":"",0<$(this).parent().find(".noborder").length?(texte="",$(this).parent().find(".noborder").each(function(){""!=$(this).val()&&(texte+=$(this).val()+separator,charsCount+=$(this).val().replace(/\ /g,"").length)})):texte=$(this).parent().find(".textarea").text(),""==texte||" "==texte?(price=0,texte=""):price=0<ppcprice?ppcprice*charsCount:$(this).parent().parent().find(".ndktextarea").attr("data-price"),""!=texte&&" "!=texte||(price=0,texte=""),updatePriceNdk(price,group)}),$("#ndkcsfields-block select").each(function(){$(this).val($(this).attr("data-selected")).trigger("change")}),$(".ndk-accessory-quantity[value!=0]").each(function(){$(this).trigger("keyup")}),$(".simpleText").each(function(){$(this).trigger("keyup")})}function getSelectedValuesFromConfig(t){return"function"==typeof getSelectedValuesFromConfig_Override?getSelectedValuesFromConfig_Override(t):(selectedConfig=[],(t=$(t)).find(".ndk-radio:checked").each(function(){group=$(this).attr("data-group"),price=$(this).attr("data-price"),selectedConfig[group]=$(this).val()}),t.find(".ndk-checkbox:checked").each(function(){group=$(this).attr("data-value-id"),price=$(this).attr("data-price"),selectedConfig[group]=$(this).val()}),t.find(".selected-value").each(function(){group=$(this).attr("data-group"),price=$(this).attr("data-price"),selectedConfig[group]=$(this).attr("data-id-value")}),t.find(".selected-svg").each(function(){group=$(this).parent().find(".img-value").attr("data-group"),price=$(this).parent().find(".img-value").attr("data-price"),selectedConfig[group]=$(this).parent().find(".img-value").attr("data-value")}),t.find(".submitSimpleText").each(function(){group=$(this).parent().find(".visual-text").attr("data-group"),price=$(this).parent().find(".visual-text").attr("data-price"),ppcprice=$(this).parent().find(".visual-text").attr("data-ppcprice"),(charsCount=charsCount=0)<$(this).parent().find("input.visual-text").length?(texte="",$(this).parent().find("input.visual-text").each(function(){""!=$(this).val()&&(texte+=$(this).val()+" ",charsCount+=$(this).val().replace(/\ /g,"").length)})):texte=$(this).parent().find("textarea").text(),""==texte||" "==texte?(price=0,texte=""):price=0<ppcprice?ppcprice*charsCount:$(this).parent().parent().find("textarea").attr("data-price"),""!=texte&&" "!=texte||(price=0,texte=""),selectedConfig[group]=texte}),t.find(".submitText").each(function(){group=$(this).parent().parent().find(".ndktextarea").attr("data-group"),price=$(this).parent().parent().find(".ndktextarea").attr("data-price"),ppcprice=$(this).parent().parent().find(".ndktextarea").attr("data-ppcprice"),(charsCount=0)<$(this).parent().find(".noborder").length?(texte="",$(this).parent().find(".noborder").each(function(){""!=$(this).val()&&(texte+=$(this).val()+" \n ",charsCount+=$(this).val().replace(/\ /g,"").length)})):texte=$(this).parent().find(".textarea").text(),""==texte||" "==texte?(price=0,texte=""):price=0<ppcprice?ppcprice*charsCount:$(this).parent().parent().find(".ndktextarea").attr("data-price"),""!=texte&&" "!=texte||(price=0,texte=""),selectedConfig[group]=texte}),t.find(".ndk-accessory-quantity[value!=0]").each(function(){group=$(this).attr("data-group"),selectedConfig[group]=$(this).attr("data-id-value")}),t.find(".simpleText").each(function(){group=$(this).attr("data-group"),selectedConfig[group]=$(this).val()}),t.find(".ndk-select").each(function(){group=$(this).attr("data-group"),price=$(this).attr("data-price"),selectedConfig[group]=$(this).val()}),selectedConfig)}function reSetEditableFields(){if("function"==typeof reSetEditableFields_Override)return reSetEditableFields_Override();window.event,window.event;$(".textzone").each(function(){el=$(this),myGroup=$(this).attr("data-group"),number=$(this).attr("data-number"),myFonts=fonts,myColors=colors,mySizes=["20","30","40","50","60","70","80","90","100"],myEffects=["applatMe","concavMe","convexMe"],myAlignments=["left","center","right"],0<window["fieldFonts_"+myGroup].length&&(myFonts=window["fieldFonts_"+myGroup]),0<window["fieldColors_"+myGroup].length&&(myColors=window["fieldColors_"+myGroup]),0<window["fieldSizes_"+myGroup].length&&(mySizes=window["fieldSizes_"+myGroup]),0<window["fieldEffects_"+myGroup].length&&(myEffects=window["fieldEffects_"+myGroup]),0<window["fieldAlignments_"+myGroup].length&&(myAlignments=window["fieldAlignments_"+myGroup]),$("#textZone"+el.attr("data-group")).fontSelector({hide_fallbacks:!0,initial:myFonts[0],initialSize:$(window).width()<768?mySizes[0]/2:mySizes[0],initialColor:myColors[0],initialEffect:myEffects[0],initialAlignment:myAlignments[0],selected:function(t){},selectedSize:function(t){},selectedColor:function(t){$(".colorSelector").css("background",t)},fonts:myFonts,sizes:mySizes,colors:myColors,effects:myEffects,alignments:myAlignments,showStroke:stroke_color[myGroup]}),$("#textZone"+el.attr("data-group")+"-"+el.attr("data-number")).fontSelector({hide_fallbacks:!0,initial:myFonts[0],initialSize:$(window).width()<768?mySizes[0]/2:mySizes[0],initialColor:myColors[0],initialEffect:myEffects[0],initialAlignment:myAlignments[0],selected:function(t){},selectedSize:function(t){},selectedColor:function(t){$(".colorSelector").css("background",t)},fonts:myFonts,sizes:mySizes,colors:myColors,effects:myEffects,alignments:myAlignments,showStroke:stroke_color[myGroup]})}),$(".ndk_selector").each(function(){$(this).setNdkSelector()}),equalheight(".svg-container"),$(".absolute-visu").each(function(){is_resizeable=$(this).attr("data-resizeable"),is_dragdrop=$(this).attr("data-dragdrop"),is_rotateable=$(this).attr("data-rotateable"),zindex=$(this).attr("data-zindex"),containment=$(this).parent().hasClass("zone_limit")?"parent":"",layerOptions="",$(this).resizable().resizable("destroy").rotatable({wheelRotate:!1}).rotatable("destroy").draggable().draggable("destroy"),1!=is_resizeable&&1!=is_dragdrop&&1!=is_rotateable||setEditable("#"+$(this).attr("id"),zindex,containment,layerOptions,is_dragdrop,is_resizeable,is_rotateable)}),0<$(".view_tab").length&&$("li.view_tab").first().trigger("click")}function uploadForSafari(t,e){if("function"==typeof uploadForSafari_Override)return uploadForSafari_Override(t,e);url=e.attr("data-action"),(el=e).parent().parent().append('<div class="ndk-loader" id="ndkloader"><div class="sk-folding-cube"><div class="sk-cube1 sk-cube"></div><div class="sk-cube2 sk-cube"></div><div class="sk-cube4 sk-cube"></div><div class="sk-cube3 sk-cube"></div></div></div>'),files=t.target.files,upFileType="other";for(var i=new FormData,a=0;a<files.length;a++){var r=files[a],o=(r.type.match("image.*")&&(upFileType="image"),i.append("file",r,r.name),i.append("safari",!0),new XMLHttpRequest);o.open("POST",url,!0),o.send(i),o.onload=function(){var t=o.responseText;200===o.status&&(el.parent().hide(),("image"==upFileType?el.parent().parent().find(".img-value:eq(0)").removeClass("hidden").attr("src",baseUrl+t).attr("data-src",baseUrl+t).attr("data-value",baseUrl+t):el.parent().parent().find(".img-value:eq(0)").removeClass("hidden").attr("src",baseUrl+"modules/ndk_advanced_custom_fields/views/img/file_picto.png").attr("data-value",baseUrl+t).addClass("pictoFileUpload")).trigger("click"),el.parent().parent().find(".remove-upload").show(),$("#ndkloader").fadeOut().remove())}}upFileType="other";t=e.val().split(".").pop().toLowerCase();(-1<t.indexOf("jpg")||-1<t.indexOf("png")||-1<t.indexOf("png")||-1<t.indexOf("gif")||-1<t.indexOf("jpeg")||-1<t.indexOf("pjpeg")||-1<t.indexOf("x-png"))&&(upFileType="image")}function hexToRgb(t){t=t.replace(/[^0-9A-F]/gi,"");t=parseInt(t,16);return[t>>16&255,t>>8&255,255&t].join()}function writeMyCanvas(t,e,i,a){return"function"==typeof writeMyCanvas_Override?writeMyCanvas_Override(t,e,i,a):(document.getElementById("myCanvas"+t),t=new C2S(e,i),newWidth=e+10,newHeight=i+20,t.canvas.width=newWidth,t.canvas.height=newHeight,t.clearRect(0,0,newWidth,newHeight),e=newWidth/1.9,i=newHeight/1.5,t.clearRect(0,0,newWidth,newHeight),t.font="bold 20px Helvetica",t.lineWidth=3,t.textAlign="center",t.fillStyle="black",t.fillText(a,e,i),a=t.getSvg(),t.getSerializedSvg(),a)}function goToStepQuantity(t,e,i){if("function"==typeof goToStepQuantity_Override)return goToStepQuantity_Override(t,e,i);if("-"==i)for(var a=last_encountred=0;a<e.length;a++)e[a]<t&&e[a]>=last_encountred&&(last_encountred=e[a],nextVal=e[a]);else{last_encountred=1e17;for(a=0;a<e.length;a++)e[a]>t&&e[a]<=last_encountred&&(last_encountred=e[a],nextVal=e[a])}return nextVal}function setAccessoryCustomization(t){customizationBlock=$("#accessory_customization_"+t.attr("data-id-value")),qtty_total=parseInt(t.val()),id_product=t.attr("data-id-product-accessory"),id_combination=t.attr("data-id_combination"),attrName=t.attr("data-attr-lang"),valueId=t.attr("data-id-value"),cusCount=customizationBlock.find(".ndkackFieldItem").length,customizationBlock.find(".required_field_back").addClass("required_field").removeClass("required_field_back"),customizationBlock.find("textarea, input, select").addClass("dontSend");for(var e=0;e<qtty_total;e++)0<cusCount&&(newCustomizationBlock=customizationBlock.clone(),group=newCustomizationBlock.find(".ndkackFieldItem:eq(0)").attr("data-field"),newGroup=group+"_"+t.attr("data-id-value")+"_"+id_combination+"-"+e,customAllDescendants(newCustomizationBlock,group,newGroup),window["fieldFonts_"+group]&&(window["fieldFonts_"+newGroup]=window["fieldFonts_"+group],window["fieldColors_"+newGroup]=window["fieldColors_"+group],window["fieldSizes_"+newGroup]=window["fieldSizes_"+group],window["fieldEffects_"+newGroup]=window["fieldEffects_"+group],window["fieldAlignments_"+newGroup]=window["fieldAlignments_"+group]),newCustomizationBlock.attr("id","accessory_customization_"+t.attr("data-id-value")+"_"+id_combination+"-"+e).attr("class","col-xs-12 cloned_accessory_customization_"+t.attr("data-id-value")+"_"+id_combination+" cloned_accessory_customization_"+t.attr("data-id-value")+" accessory_customization cloned_accessory_customization clearfix").removeClass("hidden"),newCustomizationBlock.find(".form-group .toggler").removeClass("toggler").addClass("smallToggler"),newCustomizationBlock.find(".toggleText:eq(0)").remove(),oldTitle=newCustomizationBlock.find(".toggler_title").text(),newCustomizationBlock.find(".toggler_title").text(oldTitle+" "+attrName),newCustomizationBlock.find("textarea, input, select").each(function(){void 0!==$(this).attr("name")&&-1<$(this).attr("name").indexOf("ndkcsfield")&&$(this).attr("name",$(this).attr("name")+"[accessory_customization]["+valueId+"|"+id_product+"|"+id_combination+"|"+e+"|"+attrName+"]")}),newCustomizationBlock.find("textarea, input, select").removeClass("dontSend"),customizationBlock.parent().prepend(newCustomizationBlock),customizationBlock.find(".required_field").addClass("required_field_back").removeClass("required_field"),newCustomizationBlock.find(".fieldPane").slideUp());if(attrBlockCount=$(".cloned_accessory_customization_"+t.attr("data-id-value")+"_"+id_combination).length,0<(blockDiff=attrBlockCount-qtty_total))for(e=0;e<blockDiff;e++)$("#accessory_customization_"+t.attr("data-id-value")+"_"+id_combination+"-"+e).remove();0<(prodBlockCount=$(".cloned_accessory_customization_"+t.attr("data-id-value")).length)?($("#t_a_c_"+t.attr("data-id-value")).show(),1<prodBlockCount?customizationBlock.parent().find(".cloned_accessory_customization").addClass("col-md-4"):customizationBlock.parent().find(".cloned_accessory_customization").removeClass("col-md-4")):$("#t_a_c_"+t.attr("data-id-value")).hide()}function customAllDescendants(t,e,i){t.find("*").each(function(){customAllDescendants($(this)),void 0!==$(this).attr("data-group")&&$(this).attr("data-group",i),void 0!==$(this).attr("data-field")&&$(this).attr("data-field",i),void 0!==$(this).attr("id")&&$(this).attr("id",$(this).attr("id").replace(e,i))})}function strpos(t,e,i){t=(t+"").indexOf(e,i||0);return-1!==t&&t}function checkEmptyForm(t){return"function"==typeof checkEmptyForm_Override?checkEmptyForm_Override(t):(t=t||!1,emptyForm=!0,$i=0,$("*[name^='ndkcsfield[']").each(function(){if(rootBlock="",val=$(this).hasClass("quantity_error_down")||$(this).hasClass("quantity_error_up")?(group=$(this).parent().parent().parent().attr("data-field"),$(this).attr("val")):(group=(group=(group=(void 0!==$(this).attr("data-name")?$(this).attr("data-name"):$(this).attr("name")).split("ndkcsfield["))[1].split("]"))[0],$(this).val()),rootBlock=$(".form-group[data-field='"+group+"']:not(.submitContainer)"),$(this).is(":radio")){if($k=1,others=rootBlock.find('input[type="radio"]'),$(this).is(":checked"))for(var t=0;t<others.length;t++)$i++,$k++}else if($(this).is(":checkbox")){if($k=0,group=$(this).attr("data-group"),others=rootBlock.find('input[type="checkbox"]'),$(this).is(":checked"))for(t=0;t<others.length;t++)$i++,$k++}else""!=val&&": "!=val.slice(-2)&&$i++}),0!=$i||(t&&t.preventDefault(),$("#add-to-cart-or-refresh .add-to-cart, #add_to_cart .exclusive").prop("disabled",!1).trigger("click"),!1))}function setRecommends(){if("function"==typeof setRecommends_Override)return setRecommends_Override();for(var t=0;t<recommended.length;t++)$(".form-group[data-field='"+recommended[t]+"']").addClass("recommended_field"),$(".form-group[data-field='"+recommended[t]+"']").find("input:not([name*='ndkcsfieldPdf']):not('.noborder'),textarea:not([name*='ndkcsfieldPdf']), select:not(.ndk_tag_selector)").attr("data-group-recommend",recommended[t])}function checkRecommends(t,e){if("function"==typeof checkRecommends_Override)return checkRecommends_Override(t,e);recommend_list=[];var i,t=$(".form-group.recommended_field:not([class*='disabled_value_by'])").find("input:not(.ndk_tag_selector, .dontCare),textarea:not(.ndk_tag_selector), select:not(.ndk_tag_selector)");if($i=0,t.each(function(){if(group=$(this).attr("data-group-recommend"),val=$(this).val(),rootBlock=$(".form-group[data-field='"+group+"']"),(groupTitleEl=rootBlock.find("label:eq(0)").clone()).find(".toggleText").remove(),groupTitle=groupTitleEl.text(),"undefined"==typeof group)$i++;else if($(this).is(":radio"))if($k=1,others=rootBlock.find('input[type="radio"]'),$(this).is(":checked"))for(var t=0;t<others.length;t++)$i++,$k++;else $k<others.length&&(recommend_list[group]=groupTitle);else if($(this).is(":checkbox"))if($k=0,others=rootBlock.find('input[type="checkbox"]'),$(this).is(":checked"))for(t=0;t<others.length;t++)$i++,$k++;else $k<others.length&&(recommend_list[group]=groupTitle);else if($(this).is(".ndk-accessory-quantity"))if($k=1,others=rootBlock.find(".ndk-accessory-quantity[value!=0]"),0<parseFloat(val))for(t=0;t<others.length;t++)$i++,$k++;else $k<others.length&&(recommend_list[group]=groupTitle);else""==val?recommend_list[group]=groupTitle:$i++}),$i>=t.length)return checked=!0,checkEmptyForm(e);for(i in e.preventDefault(),ret=!1,$("#recommends_list").html(""),recommend_list)""!=recommend_list[i]&&$("#recommends_list").append('<li id="showRecommendItem_'+i+'"><span class="showRecommendItem">'+recommend_list[i]+"</span></li>");$.fancybox("#confirm_recommends",{modal:!0,afterShow:function(){$(".confirm_recommends").on("click",function(t){$(t.target).is(".yes")?(checked=!0,checkEmptyForm(t)&&$("#ndkcsfields").trigger("submit")):checked=!1,$.fancybox.close()})},afterClose:function(){}})}function checkCustomizations(){return"function"!=typeof checkCustomizations_Override||checkCustomizations_Override()}function resizeInput(){if("function"==typeof resizeInput_Override)return resizeInput_Override();"search_query_top"!=$(this).attr("id")&&($(this).attr("size",$(this).val().length+5),$(this).parent().css("width",$(this).innerWidth))}$(function(){$("#ndkcsfields-block").length<1||!isFields?$(".ndkcsfields-block.config_boxes").remove():$("body").append('<div class="ndk-loader" id="ndkloader"><div class="sk-folding-cube"><div class="sk-cube1 sk-cube"></div><div class="sk-cube2 sk-cube"></div><div class="sk-cube4 sk-cube"></div><div class="sk-cube3 sk-cube"></div></div></div>')}),initApplication=function(){1!=isFields||$("#ndkcsfields-block").length<1||(identifyResctictives(),$("#submitNdkcsfields, .submitNdkcsfields").unbind("click").click(function(t){$("#ndkcsfields").ndkSubmit(t)}),$("body").addClass("ndkcfLoaded"),$("body").addClass("is_customizable_product_ndk"),$(".product-cover:eq(0)").attr("id","image-block"),$(".product-cover:eq(0) img[itemprop='image']").attr("id","bigpic"),$(".images-container").removeClass("images-container"),redesignPageLight())},$(document).ready(function(){0<$("#ndkcsfields").length&&($(".images-container").removeClass("images-container"),setTimeout(function(){$.when(initApplication()).then(function(){setTimeout(function(){$("#ndkloader").remove(),$(".resetZones").trigger("click"),0<makeItFloat&&(1.6<ps_version?("undefined"==typeof contentOnly&&(contentOnly=!1),$("#content").parent().addClass("pb-left-column"),makeFloat(".pb-left-column:eq(0)")):makeFloat(".pb-left-column"),makeFloat(".pb-right-column","#ndkcsfields")),setOpenedStatus()},50)})},150))}),$(document).on("keyup",".noborderSimple",function(){rootInput=$(this).parent().parent().find(".simpleText"),group=rootInput.attr("data-group"),price=rootInput.attr("data-price"),ppcprice=rootInput.attr("data-ppcprice"),el=$(this),texte="",charsCount=0,clearTimeout(typingTimer),inputNumber=el.parent().find(".noborderSimple").length,separator=1<inputNumber?"\n":"",typingTimer=setTimeout(function(){el.parent().find(".noborderSimple").each(function(){""!=$(this).val()&&(texte+=$(this).val()+separator,charsCount+=$(this).val().replace(/\ /g,"").length)}),""==texte||" "==texte?(price=0,texte=""):price=0<ppcprice?ppcprice*charsCount:rootInput.attr("data-price"),""!=texte&&" "!=texte||(price=0,texte=""),rootInput.val(texte).trigger("keyup"),updatePriceNdk(price,group)},1e3)}),$(document).on("keyup, change",".surface",function(){group=$(this).attr("data-group"),valuePrice=$(this).attr("data-price"),0<parseFloat($(this).attr("min"))&&parseFloat($(this).val())<parseFloat($(this).attr("min"))&&$(this).val($(this).attr("min")),0<parseFloat($(this).attr("max"))&&parseFloat($(this).val())>parseFloat($(this).attr("max"))&&$(this).val($(this).attr("max")),$(".surface_"+group).each(function(){$i=$(this).attr("data-val"),mesures[$i]=parseFloat($(this).val()),defaultMesures[$i]=parseFloat($(this).attr("min"))}),1==$(this).attr("data-preserve-ratio")&&(defaultMesures.sort(),ratio=defaultMesures[1]/defaultMesures[0],el=$(this),$(".surface_"+group).not(this).each(function(){newVal=$(this).attr("min")==defaultMesures[1]?el.val()*ratio:el.val()/ratio,$(this).val()!=newVal.toFixed(2)&&$(this).val(newVal.toFixed(2)).trigger("change")})),calculateSurface(group,mesures,valuePrice)}),$(document).on("click",".toggleGroupField",function(){$(this).hasClass("opened")?($(".groupFieldBlock:visible").hide(),$(this).removeClass("opened").addClass("closed"),$("#bigpic").attr("src",$("#bigpic").attr("data-original-image")),$(".zone_limit, .absolute-visu, .editThisLayer").hide()):(target=$(this).attr("target"),$(".toggleGroupField").removeClass("opened").addClass("closed"),$(target).is(":visible")&&!$(target).hasClass("groupFieldBlock")?($(this).removeClass("opened").addClass("closed"),$(target).hide()):($(this).removeClass("closed").addClass("opened"),$(target).show(),$(target+" .view_tab:first").trigger("click")),$(".groupFieldBlock:visible:not("+target+")").hide(),$(target).find(".ndkcfPagerItem:eq(0)").trigger("click"),$(".img-item-row, .svg-container").css("height",""),setTimeout(function(){equalheight(".img-item-row"),equalheight(".svg-container")},500))}),$(document).on("submit",".ajax_form",function(t){t.preventDefault(),$("#submitNdkcsfields, .submitNdkcsfields").prop("disabled",!0),convertPercent(),loading_steps="undefined"!=typeof is_visual&&1==is_visual&&1==showHdPreview?3:2,$("body").append('<div class="ndk-loader" id="ndkloader"><h4 class="reveal-text"><span id="loader_step">(1/'+loading_steps+") </span>"+loadingText+'</h4><div class="sk-folding-cube"><div class="sk-cube1 sk-cube"></div><div class="sk-cube2 sk-cube"></div><div class="sk-cube4 sk-cube"></div><div class="sk-cube3 sk-cube"></div></div></div>'),$("#ndkcf_id_combination").val($("#idCombination").val()).trigger("keyup"),getIdCombinationNdk();var i=$(this),e=i.attr("action");id_product=$("#ndkcf_id_product").val(),qtty=$("#quantity_wanted").val(),parseFloat(qtty)<1&&(qtty=1,$("#quantity_wanted").val("1")),1==addProductPrice?id_combination=$("#ndkcf_id_combination").val():(id_combination=0,$("#ndkcf_id_combination").val(0).trigger("keyup")),myDatas=i.find("input, select, textarea").not(".ndk-accessory-quantity[value=0]").not(".ndk_attribute_select, .dontSend").serialize(),old_conf="undefined"==typeof oldRef||alreadyModify?(old_id=0,old_id_customization=0):(old_ref=oldRef.split("-"),old_id=refProd,old_id_customization=old_ref[4],editConfig),$(".form-group").removeClass("focusRequired"),$(".form-group").find(".error").remove(),createPreview(function(){$.ajax({type:"POST",url:e+(0<customizationPrice||$(".ndk-accessory-quantity[value!=0]").length,"createNdkcsfields.php"),data:myDatas+"&qty="+qtty+"&old_id="+old_id+"&old_id_customization="+old_id_customization+"&old_conf="+old_conf+"&is_visual="+(is_visual?1:0)+"&cover="+compoImages,dataType:"json",success:function(e){$("#product_customization_id").val(e.id_customization),convertPercent(),alreadyModify=!0,$("#image-block").removeClass("hight_quality"),$(".tempSvg").remove(),$(".hiddenForSnapshot").show().removeClass(".hiddenForSnapshot"),$("#image-block svg").show(),left_block=$("#image-block").html(),right_block=$("#ndkcsfields").html(),layer_block=0<$("#layer-block").length?$("#layer-block").html():"",id_product=$("#ndkcf_id_product").val(),id_customer=$("#ndkcf_id_customer").val(),config_name="custom-"+id_product+"-"+(0<parseFloat(id_combination)?parseFloat(id_combination):0)+"-"+e.id_cart+"-"+e.id_customization,config_tags="",$(right_block).find(".image-url").val(""),leftDatas=btoa(RawDeflate.deflate(left_block)),rightDatas=btoa(RawDeflate.deflate(right_block)),layerDatas=btoa(RawDeflate.deflate(layer_block)),$("#loader_step").html("(2/"+loading_steps+") "),$.when(simuViews(!0,!0)).done(function(){0==showImgPreview&&(compoImages=[]),compoImages=[$("#image-url-0").val()],configPrice=getPriceHt(totalUnitPrice,"",!0),configdatas=0<allowEdit?{action:"saveConfig",leftBlock:leftDatas,rightBlock:rightDatas,layerBlock:layerDatas,idCustomer:id_customer,idProduct:id_product,idCustomization:e.id_customization,configName:config_name,configTags:config_tags,configImg:compoImages,preview_field:e.preview_field_img,base_url:baseUrl,skip:0,price:configPrice}:{skip:1},$.ajax({type:"POST",url:baseUrl+"modules/ndk_advanced_custom_fields/saveConfig.php",data:configdatas,dataType:"html",success:function(t){i.append('<p id="saved"><svg id="savedSvg" width="220" height="150"><path id="check" d="M30,50 l60,60 l95,-80"></path></svg></p>'),$("#ndkloader").fadeOut().remove(),1.6<ps_version?0<e.id_product&&e.id_product!=id_product?($(".product-variants input, .product-variants select").val("").remove(),$("#product_customization_id").val(e.id_customization),$.when($("#product_page_product_id").val(e.id_product)).then(function(){$("#add-to-cart-or-refresh .add-to-cart").prop("disabled",!1).trigger("click")})):$("#add-to-cart-or-refresh .add-to-cart").prop("disabled",!1).trigger("click"):0<e.id_product&&e.id_product!=id_product?ajaxCart.add(e.id_product,null,!1,null,qtty):ajaxCart.add(id_product,0<id_combination?id_combination:null,!1,null,qtty),setTimeout(function(){$("#saved").remove(),$(".snapshoot").removeClass("snapshoot"),$("#submitNdkcsfields, .submitNdkcsfields").prop("disabled",!1).removeClass("loadingButton"),0<allowEdit&&makeSocialCompo(t,!0)},200),contentOnly},error:function(){}})}),customizationId=e.id_customization,"undefined"!=typeof is_visual&&1==is_visual&&1==showHdPreview&&($("#loader_step").html("(3/"+loading_steps+") "),$.ajax({type:"POST",url:baseUrl+"modules/ndk_advanced_custom_fields/createPdf.php",data:{htmlNodes:htmlOutput,idCustomer:e.id_customer,idProduct:e.id_product,idCustomization:e.id_customization,preview_field:e.preview_field,base_url:baseUrl,images:"",fonts:allFonts},dataType:"html",success:function(t){},error:function(){}}))},error:function(){}})})}),$(document).on("change",".ndk_attribute_select",function(){id_product=$(this).attr("ref");var t=$(this).parent().parent().find("input[data-id-product-accessory='"+id_product+"']");0<t.length&&0<t.val()&&(currName=t.attr("name"),newName=currName.split("|")[0]+"|"+currName.split("|")[1]+"|"+$(this).val()+"]",t.attr("name",newName).attr("data-id_combination",$(this).val()),t.hasClass("price_overrided")?1==displayPriceHT&&0<t.val()&&($(".final_price_"+t.attr("data-id-value")+" .priceht").remove(),$(".final_price_"+t.attr("data-id-value")).append('<span class="priceht clear clearfix"></span>'),getPriceHt(t.attr("data-price"),".final_price_"+t.attr("data-id-value")+" .priceht")):loadAccessoryAttrPrice(id_product,$(this).val(),t.val(),t),loadAccessoryAttrImg(id_product,$(this).val(),$(this).attr("data-link-rewrite"),t))}),$(document).on("change, keyup","#ndkcsfields-block input",function(){$(this).attr("value",$(this).val())}),$(document).on("change","#ndkcsfields-block select",function(){$(this).attr("data-selected",$(this).val())}),$(document).on("change, keyup","#ndkcsfields-block textarea",function(){$(this).html($(this).val()),ProgressBar()}),$(document).on("click","#ndkSaveCustomization",function(t){t.preventDefault(),""!=$("#ndkcf_config_name").val()?(convertPercent(),saveCustomization()):($("#ndkcf_config_name").css("background","#F2DEDE").focus(),$("#ndkcf_config_name").parent().find(".error").remove(),$("#ndkcf_config_name").after('<span class="error alert-danger clear clearfix">'+$("#ndkcf_config_name").attr("data-message")+"</span>"))}),$(document).on("click",".ndkLoadConfigImg",function(){$(this).parent().parent().find(".ndkLoadConfig").trigger("click")}),$(document).on("click",".ndkLoadConfig",function(){$(".tagify").tagify("destroy");var t=$(this).text(),e=$(this).attr("data-tags");"0"!=$(this).attr("data-id")?($("#ndkcf_config_name").val(t),$("#ndkcf_config_tags").val(e),loadCustomization($(this).attr("data-id")),setTimeout(function(){$(".tagify").tagify({delimiters:[13,188,44],addTagPrompt:tagslabel})},500),$(".configItem").removeClass("active"),$(this).parent().addClass("active")):window.location.reload()}),$(document).on("change",".upload_ndk_visu",function(t){var e;t.preventDefault(),url=$(this).attr("data-action"),el=$(this),bidon=!1,window.File&&window.FileReader&&window.FileList&&window.Blob&&!bidon?(e=new FileReader,el.parent().parent().append('<div class="ndk-loader" id="ndkloader"><div class="sk-folding-cube"><div class="sk-cube1 sk-cube"></div><div class="sk-cube2 sk-cube"></div><div class="sk-cube4 sk-cube"></div><div class="sk-cube3 sk-cube"></div></div></div>'),upFileType="other",e.onloadend=function(){(-1<(extension=e.result.split("base64,")[0]).indexOf("jpg")||-1<extension.indexOf("png")||-1<extension.indexOf("png")||-1<extension.indexOf("gif")||-1<extension.indexOf("jpeg")||-1<extension.indexOf("pjpeg")||-1<extension.indexOf("x-png"))&&(upFileType="image"),dataToBeSent=e.result.split("base64,")[1],$.post(url,{data:dataToBeSent}).done(function(t){el.parent().hide(),("image"==upFileType?el.parent().parent().find(".img-value:eq(0)").removeClass("hidden").attr("src",baseUrl+t).attr("data-src",baseUrl+t).attr("data-value",baseUrl+t):el.parent().parent().find(".img-value:eq(0)").removeClass("hidden").attr("src",baseUrl+"modules/ndk_advanced_custom_fields/views/img/file_picto.png").attr("data-value",baseUrl+t).addClass("pictoFileUpload")).trigger("click"),el.parent().parent().find(".remove-upload").show(),$("#ndkloader").fadeOut().remove()})},e.readAsDataURL(this.files[0])):uploadForSafari(t,$(this)),killer=$(this).parent().parent().parent().attr("data-killer"),0<parseFloat(killer)&&($(".form-group[data-field='"+killer+"'] .doneOption").remove(),$(".form-group[data-field='"+killer+"']").append('<span class="doneOption"></span>'),$(".form-group[data-field='"+killer+"']").find(".ndk-select").val("Oui").trigger("change"))}),$(document).on("click",".remove-upload",function(t){t.preventDefault(),group=$(this).parent().find(".img-value").attr("data-group"),$(this).parent().find(".img-value").addClass("hidden"),$(this).parent().parent().find(".uploader").show(),$("input#ndkcsfield_"+group).val("").trigger("keyup"),$("#visual_"+group).remove(),$(this).hide(),updatePriceNdk(0,group),$("#layer-edit-"+group).remove(),killer=$(".form-group[data-field='"+group+"']").attr("data-killer"),$(".form-group[data-field='"+killer+"']").find(".ndk-select").val("Non").trigger("change"),$(".form-group[data-field='"+killer+"'] .doneOption").remove()}),$("tr.customization > .cart_quantity").html(""),$(document).on("click",".ndkzoom",function(t){t.preventDefault(),$(".resetZones").trigger("click"),convertPercent(),$.prototype.fancybox&&$.fancybox.open([{type:"inline",autoScale:!1,minHeight:30,width:"80%",height:"80%",showCloseButton:!1,autoDimensions:!1,content:'<div class="popupPreviewContainer clear clearfix">'+$("#image-block").html()+"</div>",beforeShow:function(){$(".popupPreviewContainer .svggradient, .popupPreviewContainer .svgfilter").remove()}}],{padding:0})}),"undefined"!=typeof is_visual&&1==is_visual&&$(document).on("click","#image-block",function(t){return t.preventDefault(),!1}),$(document).on("click",".visual-effect",function(){visu=$(this).attr("data-src"),group=$(this).attr("data-group"),zindex=$(this).attr("data-zindex"),dragdrop=$(this).attr("data-dragdrop"),resizeable=$(this).attr("data-resizeable"),rotateable=$(this).attr("data-rotateable"),view=$(this).attr("data-view"),coloreffect="normal",background="",type=!1,$(this).hasClass("img-value")&&(coloreffect=$(this).attr("data-blend"),void 0!==$(this).attr("data-mask-image"))&&""!=$(this).attr("data-mask-image")&&(type="colorize",background=$(this).attr("data-src"),visu=$(this).attr("data-mask-image")),$(this).hasClass("color-ndk")&&(type="color",coloreffect=$(this).attr("data-blend"),$(this).hasClass("colorize-ndk")&&(type="colorize",background=$(this).attr("data-color")),void 0!==$(this).attr("data-mask-image"))&&""!=$(this).attr("data-mask-image")&&(type="colorize",background=$(this).attr("data-color"),visu=$(this).attr("data-mask-image")),!$(this).hasClass("accessory-ndk")||(group=group+"-"+$(this).attr("data-id-product-value"),0==visu&&(visu=$(this).find(".accessory-img-block img").attr("src")),0<$(this).find(".ndk-accessory-quantity:eq(0)").val())?designCompo(visu,group,view,zindex,dragdrop,resizeable,rotateable,0,0,type,coloreffect,background):($("#visual_"+group).remove(),$("#layer-edit-"+group).remove(),$(this).find(".selected-value").removeClass("selected-value"))}),$(document).on("change",".visual-effect-select",function(){visu=$(this).find("option:selected").attr("data-src"),group=$(this).find("option:selected").attr("data-group"),zindex=$(this).find("option:selected").attr("data-zindex"),dragdrop=$(this).find("option:selected").attr("data-dragdrop"),resizeable=$(this).find("option:selected").attr("data-resizeable"),rotateable=$(this).find("option:selected").attr("data-rotateable"),view=$(this).find("option:selected").attr("data-view"),designCompo(visu,group,view,zindex,dragdrop,resizeable,rotateable,0,0,!1),"undefined"==typeof visu&&$("#visual_"+group+", #layer-edit-"+group).remove()}),0==letOpen?$(document).on("click",".toggler",function(){toggler=$(this),thisFieldPane=$(this).parent().find(".fieldPane"),$(".fieldPane:visible").not(thisFieldPane).hide(),$.when($(this).parent().find(".fieldPane").toggle()).then(function(){$(this).parent().find(".fieldPane").is(":visible")?(toggler.addClass("active"),toggler.find(".toggleText").html(toggleCloseText)):(toggler.removeClass("active"),toggler.find(".toggleText").html(toggleOpenText)),scrollToNdk($(this).parent(),800)}),$(".ndkQuickAccessBox-item").removeClass("active"),$(".ndkQuickAccessBox-item[data-target='"+$(this).parent().attr("data-field")+"']").addClass("active")}):$(".toggler").addClass("letOpen"),$(document).on("click",".color-ndk",function(){$('.img-value[data-default-value="1"]').trigger("click"),ActiveFieldNDK(this),group=$(this).attr("data-group"),$("#temporary-ndk-color-image-"+group).remove(),view=$(this).attr("data-view"),price=$(this).attr("data-price"),$(this).hasClass("color_square")||(updatePriceNdk(price,group),setImgValue($(this),group)),$(this).parent().find(".color-ndk").removeClass("selected-color"),$(this).addClass("selected-color"),myel=$(this),"null"==$(this).attr("data-quantity-available")||$(this).hasClass("color_square")||updateQuantityForValue(myel.attr("data-quantity-available"),group),container=0<$(".zone_limit[data-group='"+group+"']").length&&0<$(".view_tab[data-view='"+view+"']").length?".zone_limit[data-group='"+group+"']":"#image-block",$(this).hasClass("visual-effect")&&"0"==$(this).attr("data-src")&&(-1<$(this).attr("data-color").indexOf("url")?(uri=$(this).attr("data-color").replace("url('","").replace("')",""),$(this).attr("data-color",uri)):(svg='<svg xmlns="http://www.w3.org/2000/svg" width="'+$(container).width()+'" height="'+$(container).height()+'"><rect width="'+$(container).width()+'" height="'+$(container).height()+'" style="fill:rgb('+hexToRgb($(this).attr("data-color"))+');"></rect></svg>',uri="data:image/svg+xml;base64,"+window.btoa(svg)),myel.attr("data-src",uri).trigger("click")),ProgressBar()}),$(document).on("click, change",".ndk-radio",function(){group=$(this).attr("data-group"),checkedRadio=$(".ndk-radio[data-group='"+group+"']:checked"),$(".form-group[data-field='"+group+"']").find(".selected_radio").removeClass("selected_radio"),checkedRadio.parent().addClass("selected_radio"),updatePriceNdk(price=checkedRadio.attr("data-price"),group),"null"!=checkedRadio.attr("data-quantity-available")&&updateQuantityForValue(checkedRadio.attr("data-quantity-available"),group),checkFieldRestrictions(checkedRadio.attr("data-id-value"),group),ProgressBar()}),$(document).on("change",".ndk-select",function(){group=$(this).find("option:selected").attr("data-group"),updatePriceNdk(price=$(this).find("option:selected").attr("data-price"),group),"null"!=$(this).find("option:selected").attr("data-quantity-available")&&updateQuantityForValue($(this).find("option:selected").attr("data-quantity-available"),group),checkFieldRestrictions($(this).find("option:selected").attr("data-id-value"),group)}),$(document).on("change",".arcText",function(){$texteditor=$(".textarea"),(val=680<(val=$(this).val())?1e4:val)<-680&&(val=-1e4),$texteditor.circleType({radius:val}),ghoape(".textarea")}),$(document).on("click",".visible_layer",function(){hideLayer($(this))}),$(document).on("click",".hidden_layer",function(){showLayer($(this))}),$(document).on("click",".submitSimpleText",function(){group=$(this).parent().find(".visual-text").attr("data-group"),zindex=$(this).parent().find(".visual-text").attr("data-zindex"),price=$(this).parent().find(".visual-text").attr("data-price"),ppcprice=$(this).parent().find(".visual-text").attr("data-ppcprice"),view=$(this).parent().find(".visual-text").attr("data-view"),dragdrop=$(this).parent().find(".visual-text").attr("data-dragdrop"),resizeable=$(this).parent().find(".visual-text").attr("data-resizeable"),rotateable=$(this).parent().find(".visual-text").attr("data-rotateable"),(charsCount=0)<$(this).parent().find("input.visual-text").length?(texte="",$(this).parent().find("input.visual-text").each(function(){""!=$(this).val()&&(texte+=$(this).val()+" ",charsCount+=$(this).val().replace(/\ /g,"").length)})):texte=$(this).parent().find("textarea").text(),""==texte||" "==texte?(price=0,texte=""):price=0<ppcprice?ppcprice*charsCount:$(this).parent().parent().find("textarea").attr("data-price"),""!=texte&&" "!=texte||(price=0,texte=""),height=$(this).parent().find(".visual-text").height(),width=$(this).parent().find(".visual-text").width(),updatePriceNdk(price,group),html2canvas($(this).parent().find(".visual-text"),{onrendered:function(t){designCompo(t.toDataURL("image/png"),group,view,zindex,dragdrop,resizeable,rotateable,width,height,!1)}})}),$(document).on("click",".submitText",function(){if(group=$(this).parent().parent().find(".ndktextarea").attr("data-group"),zindex=$(this).parent().parent().find(".textzone").attr("data-zindex"),price=$(this).parent().parent().find(".ndktextarea").attr("data-price"),ppcprice=$(this).parent().parent().find(".ndktextarea").attr("data-ppcprice"),blend=$(this).parent().parent().find(".ndktextarea").attr("data-blend"),view=$(this).parent().parent().find(".ndktextarea").attr("data-view"),dragdrop=$(this).parent().parent().find(".ndktextarea").attr("data-dragdrop"),resizeable=$(this).parent().parent().find(".ndktextarea").attr("data-resizeable"),rotateable=$(this).parent().parent().find(".ndktextarea").attr("data-rotateable"),coloreffect=$(this).parent().parent().find(".ndktextarea").attr("data-blend"),svgPath="",svgPath=$(this).parent().parent().find(".ndktextarea").attr("data-path"),charsCount=0,inputNumber=$(this).parent().find(".noborder").length,separator=1<inputNumber?" \n ":"",0<$(this).parent().find(".noborder").length?(texte="",$(this).parent().find(".noborder").each(function(){""!=$(this).val()&&(texte+=$(this).val()+separator,charsCount+=$(this).val().replace(/\ /g,"").length)})):texte=$(this).parent().find(".textarea").text(),""==texte||" "==texte?(price=0,texte=""):price=0<ppcprice?ppcprice*charsCount:$(this).parent().parent().find(".ndktextarea").attr("data-price"),$(this).parent().parent().find(".ndktextarea").val(texte).trigger("keyup"),""!=texte&&$(this).parent().find(".fontSelectUl li.active").trigger("click"),""!=texte&&" "!=texte||(price=0,texte=""),verticalPadding=10,horizontalPadding=0,$(this).parent().find(".status_counter").hide(),$(this).parent().find(".noborder").css("position","relative"),height=$(this).parent().find(".textarea").innerHeight()-parseFloat(verticalPadding),width=$(this).parent().find(".textarea").innerWidth()-parseFloat(horizontalPadding)-scrollbarWidth,$(this).parent().find(".noborder").css("position",""),updatePriceNdk(price,group),$(".status_counter").hide(),0<$(".zone_limit[data-group='"+group+"']").length&&0<$(".view_tab[data-view='"+view+"']").length&&0<$(this).parent().find("textarea.noborder").length&&(container=".zone_limit[data-group='"+group+"']",zwidth=$(container).width(),zheight=$(container).height(),0<zwidth&&0<zheight&&$(this).parent().find(".textarea").css({width:zwidth}),height=zheight,width=zwidth),svglines="",fontSize=parseFloat($(this).parent().css("font-size")),alignment=$(this).parent().find(".texteditor").css("text-align"),x=10,txtanchord='text-anchor="start"',startOffset=' startOffset="50%"',"left"==alignment?(x=10,txtanchord='text-anchor="start"',startOffset=' startOffset="0%"'):"center"==alignment?(x=width/2,txtanchord='text-anchor="middle"',startOffset=' startOffset="50%"'):"right"==alignment&&(x=width,txtanchord='text-anchor="end"',startOffset=' startOffset="100%"'),0==svgPath&&(svgPath=""),0<$(this).parent().find("textarea.noborder").length){var t=$(this).parent().find("textarea.noborder").val().split("\n");y=1,onlyText="";for(var e=0;e<t.length;e++)""!=svgPath?svglines+='<textPath style="z-index:'+zindex+';" '+txtanchord+startOffset+' xlink:href="#'+svgPath+'">'+t[e]+"</textPath>":svglines+="<tspan "+txtanchord+' x="'+x+'" y="'+fontSize*y+'">'+t[e].escape()+"</tspan>",y++;textToWrite=$(this).parent().find("textarea.noborder").val()}else textToWrite="",y=1,$(this).parent().find(".noborder").each(function(){""!=svgPath?(textToWrite+='<textPath style="z-index:'+zindex+';" '+txtanchord+startOffset+'  xlink:href="#'+svgPath+'">'+$(this).val()+"</textPath>",onlyText=$(this).val()):textToWrite+=$(this).val()+" \n ",y++});style=$(this).parent().attr("style").replace('"',"'").replace('"',"'"),fontSize=parseInt($(this).parent().find(".texteditor").css("font-size")),fontFamily=(fontFamily=$(this).parent().find(".texteditor").css("font-family")).replace('"',"'").replace('"',"'");var i=!1,a=[];a.effect="",a.fill="",a.fillLight="",a.fillShadow="",a="rgb(255, 215, 0)"==$(this).parent().find(".texteditor").css("color")?(i=!0,metaleffect("#efd8a2","#a28156","#efd8a2","#2f1f05","#fff3c6",group,textToWrite,width,height,fontFamily,fontSize,i,!1)):"rgb(192, 192, 192)"==$(this).parent().find(".texteditor").css("color")?(i=!0,metaleffect("#888888","#dedede","#F5F5F5","#444444","#dedede",group,textToWrite,width,height,fontFamily,fontSize,i,!1)):"concavMe"==$(this).parent().find(".texteditor").attr("data-effect")?(color1=$(this).parent().find(".texteditor").css("color"),color2=darkerColor($(this).parent().find(".texteditor").css("color"),.2),shadowcolor=darkerColor($(this).parent().find(".texteditor").css("color"),.4),lightcolor=lighterColor($(this).parent().find(".texteditor").css("color"),.2),strokecolor=lighterColor($(this).parent().find(".texteditor").css("color"),.2),i=!0,metaleffect(color2,color1,strokecolor,lightcolor,shadowcolor,group,textToWrite,width,height,fontFamily,fontSize,i,!1)):"convexMe"==$(this).parent().find(".texteditor").attr("data-effect")?(color1=$(this).parent().find(".texteditor").css("color"),color2=lighterColor($(this).parent().find(".texteditor").css("color"),.2),shadowcolor=darkerColor($(this).parent().find(".texteditor").css("color"),.2),lightcolor=lighterColor($(this).parent().find(".texteditor").css("color"),.3),strokecolor=darkerColor($(this).parent().find(".texteditor").css("color"),.2),i=!0,metaleffect(color1,color2,strokecolor,shadowcolor,lightcolor,group,textToWrite,width,height,fontFamily,fontSize,i,!1)):""!=$(this).parent().find(".texteditor").attr("data-texture")?(color1=$(this).parent().find(".texteditor").css("color"),color2=darkerColor($(this).parent().find(".texteditor").css("color"),.2),shadowcolor=darkerColor($(this).parent().find(".texteditor").css("color"),.4),lightcolor=lighterColor($(this).parent().find(".texteditor").css("color"),.2),strokecolor=lighterColor($(this).parent().find(".texteditor").css("color"),.2),i=!1,texture=$(this).parent().find(".texteditor").attr("data-texture").replace('url("',"").replace('")',""),metaleffect(color2,color1,strokecolor,lightcolor,shadowcolor,group,textToWrite,width,height,fontFamily,fontSize,i,texture)):(color1=$(this).parent().find(".texteditor").css("color"),"undefined"==typeof(strokecolor=$(this).parent().find(".texteditor").attr("stroke-color"))&&(strokecolor="transparent"),i=!1,metaleffect(color1,color1,strokecolor,"transparent","transparent",group,textToWrite,width,height,fontFamily,fontSize,i,!1,!0)),""!=svgPath&&"undefined"!=typeof svgPath&&0!=svgPath&&$(this).parent().parent().find(".ndktextarea").hasClass("visual-effect")?($("#svgText_"+group).remove(),$("#svgUse_"+group).remove(),$(".ndk-svg-view:visible > svg > [data-group-text='"+group+"']").remove(),writeCurve=$(".ndk-svg-view:visible > svg ").append(a.textPathEffect+'<text data-font-family="'+fontFamily+'" data-group-text="'+group+'" id="svgText_'+group+'" style="font-family:'+fontFamily+" ;font-size:"+fontSize+"px;fill:"+a.fill+";z-index:"+zindex+';" >'+textToWrite+"</text>"),$.when(writeCurve).then(function(){setTimeout(function(){$("#ndk-svg-view-"+view+" > svg").html($("#ndk-svg-view-"+view+" > svg").html()),$("#ndk-svg-view-"+view).css("z-index",zindex).css("mix-blend-mode",coloreffect)},500)})):$(this).parent().parent().find(".ndktextarea").hasClass("visual-effect")&&designCompo(a.svg,group,view,zindex,dragdrop,resizeable,rotateable,width,height,"svg",blend),0<$(this).parent().find("textarea.noborder").length&&"undefined"!=typeof textToWrite&&""!=textToWrite&&(svg_textMultiline("svgText_"+group,textToWrite.replace(/\n/g," ± "),width,fontSize,txtanchord,x),svg_textMultiline("svgText_"+group+"-shadow",textToWrite.replace(/\n/g," ± "),width,fontSize,txtanchord,x),svg_textMultiline("svgText_"+group+"-light",textToWrite.replace(/\n/g," ± "),width,fontSize,txtanchord,x)),$(this).parent().parent().parent().find(".fontColorSelectUl li.active").trigger("click")}),$(document).on("keyup",".textarea",function(){clearTimeout(typingTimer),button=$(this).parent().parent().find(".submitText"),typingTimer=setTimeout(function(){},doneTypingInterval)}),$(document).on("keyup",".visual-text",function(){clearTimeout(typingTimer),button=$(this).parent().find(".submitSimpleText"),typingTimer=setTimeout(function(){button.trigger("click")},doneTypingInterval)}),$(document).on("click",".svg-container",function(){group=$(this).parent().find("img").attr("data-group"),zindex=$(this).parent().find("img").attr("data-zindex"),price=$(this).parent().find("img").attr("data-price"),view=$(this).parent().find("img").attr("data-view"),blend=$(this).parent().find("img").attr("data-blend"),dragdrop=$(this).parent().find("img").attr("data-dragdrop"),resizeable=$(this).parent().find("img").attr("data-resizeable"),rotateable=$(this).parent().find("img").attr("data-rotateable"),height=(0<$(".zone_limit[data-group='"+group+"']").length?(width=$(".zone_limit[data-group='"+group+"']").innerWidth(),$(".zone_limit[data-group='"+group+"']")):(width=$("#image-block").innerWidth(),$("#image-block"))).innerHeight(),updatePriceNdk(price,group),$(this).parent().parent().parent().find(".remove-img-item").show(),"null"!=$(this).parent().find("img").attr("data-quantity-available")&&updateQuantityForValue($(this).parent().find("img").attr("data-quantity-available"),group),clonedSvg=$(this).find("svg").clone(),0<$(this).parent().find("img.visual-effect").length&&designCompo(clonedSvg,group,view,zindex,dragdrop,resizeable,rotateable,width,height,"svg",blend),setImgValue($(this).parent().find("img"),group),$(this).parent().parent().parent().find(".img-value").removeClass("selected-value"),$(this).parent().parent().parent().find(".svg-container").removeClass("selected-svg"),$(this).addClass("selected-svg"),equalheight(".svg-container"),$(".view_tab.activeView").trigger("click")}),$(document).on("click",".editIt",function(){isItem=!1,el=$(this).parent(),-1<(group=el.attr("id").replace("visual_","")).indexOf("-")&&(isItem=!0,number=group.split("-")[1],group=itemGroup=group.split("-")[0]),$("#ndkcsfields .toggler").removeClass("active"),0==parseInt(letOpen)&&$("#ndkcsfields .fieldPane").hide(),scrollToNdk(formGroup=$(".form-group[data-field='"+group+"']"),800),1==makeSlide&&($(".sliderBlock .ndkackFieldItem").removeClass("activeItem"),formGroup.addClass("activeItem")),formGroup.find(".toggler:not(.active)").trigger("click"),isItem&&(scrollToNdk(formGroup.find(".designer-item[data-number='"+number+"']"),800),$(".designer-item[data-number='"+number+"']").show())}),$(document).on("click",".view_tab",function(){$(".resetZones").trigger("click"),scrollToNdk($(".primary_block"),800),$("#image-block").find(".ndk-svg-view").hide(),$("#image-block").attr("data-view",$(this).attr("data-view")).attr("data-id",$(this).attr("data-id")),$(".groupFieldBlock").css("padding-bottom",$(".sliderBlock .ndkackFieldItem:visible:eq(0)").height()),0<$("#ndkcsfieldSVGView_"+$(this).attr("data-view")).length&&(svgImage=$("#ndkcsfieldSVGView_"+$(this).attr("data-view")).find("image").attr("xlink:href"),$("#bigpic").attr("src",svgImage),0==$("#ndk-svg-view-"+$(this).attr("data-view")).length)&&$.when($("#image-block").append('<div class="ndk-svg-view" id="ndk-svg-view-'+$(this).attr("data-view")+'">'+$("#ndkcsfieldSVGView_"+$(this).attr("data-view")).html()+"</div>")).done(function(){$("#ndk-svg-view-"+$(this).attr("data-view")).find("image").remove()}),0<$("#ndk-svg-view-"+$(this).attr("data-view")).length?$("#ndk-svg-view-"+$(this).attr("data-view")).show():$("#bigpic").attr("src",$(this).attr("data-img")),$("#ndkcsfields-block .form-group").hide(),$(".form-group[data-view='"+$(this).attr("data-view")+"'], .form-group[data-view='0']").show(),$(".form-group[data-view*='"+$(this).attr("data-view")+"|']").show(),$(".form-group[data-view*='|"+$(this).attr("data-view")+"']").show(),$(".editThisLayer").hide(),$(".editThisLayer[data-view='"+$(this).attr("data-view")+"'], .editThisLayer[data-view='0']").show(),$(".editThisLayer[data-view*='"+$(this).attr("data-view")+"|']").show(),$(".editThisLayer[data-view*='|"+$(this).attr("data-view")+"']").show(),1!=makeSlide||$(this).hasClass("activeView")||($(".ndkcfPagerItem").hide(),$(".ndkcfPagerItem[data-view='"+$(this).attr("data-view")+"'], .ndkcfPagerItem[data-view='0']").show(),$(".ndkcfPagerItem[data-view*='"+$(this).attr("data-view")+"|']").show(),$(".ndkcfPagerItem[data-view*='|"+$(this).attr("data-view")+"']").show(),ndkCfShowSlide($(".sliderBlock .ndkackFieldItem:visible:eq(0)"))),$(".view_tab").removeClass("activeView"),$(this).addClass("activeView"),$(".absolute-visu").hide(),$(".zone_limit").hide(),$(".absolute-visu.view-"+$(this).attr("data-view")).show(),$(".zone_limit.view-"+$(this).attr("data-view")).show(),$("[class*='"+$(this).attr("data-view")+"|']").show(),$("[class*='|"+$(this).attr("data-view")+"']").show(),$(".absolute-visu.view-0").show(),$(".zone_limit.view-0").show(),$(".layer_view").addClass("visible_layer").removeClass("hidden_layer")}),$(document).on("keyup",'#ndkcsfields-block input[type="text"]',function(){"search_query_top"!=$(this).attr("id")&&(""!=$(this).val()?$(this).attr("size",$(this).val().length+5):$(this).attr("size",15),$(this).parent().css("width",$(this).innerWidth))}),$(document).on("click",".fontSelectUl li, .fontColorSelectUl li, .fontSizeSelectUl li",function(){input=$(this).parent().parent().parent().find(".ndktextarea"),color=$(this).parent().parent().find(".fontColorSelectUl li.active").text(),font=$(this).parent().parent().find(".fontSelectUl li.active").text(),0<$(this).parent().parent().find(".noborder").length?(texte="",inputNumber=input.parent().find(".noborder").length,separator=1<inputNumber?" \n ":"",$(this).parent().parent().find(".noborder").each(function(){texte+=$(this).val()+separator})):texte=$(this).parent().parent().find(".ndktextarea").text(),0<(charsCount=texte.replace(/\ /g,"").length)?input.val(texte+" ["+color+" - "+font+"]").trigger("keyup"):input.val("")}),$(document).on("click",".quantity-ndk-plus",function(t){t.preventDefault(),targetClass=void 0!==$(this).attr("data-target-class")?"."+$(this).attr("data-target-class"):".ndk-accessory-quantity",input=$(this).parent().find(targetClass),step=void 0!==input.attr("step")?parseFloat(input.attr("step")):1,currentVal=parseInt($(this).parent().find(targetClass).val()),quantityAvailableNdk=0<$(this).parent().find(targetClass).attr("data-qtty-available")?$(this).parent().find(targetClass).attr("data-qtty-available"):1e8,quantityMaxNdk=0<$(this).parent().find(targetClass).attr("data-qtty-max")?$(this).parent().find(targetClass).attr("data-qtty-max"):quantityAvailableNdk,(!isNaN(currentVal)&&currentVal+step<quantityAvailableNdk&&currentVal<quantityMaxNdk?$(this).parent().find(targetClass).val(currentVal+step):$(this).parent().find(targetClass).val(quantityMaxNdk)).trigger("keyup").trigger("change"),""!=input.attr("data-step_quantity")&&(stepQtty=input.attr("data-step_quantity").split(";").map(Number),val=parseInt(input.val()),-1==$.inArray(val,stepQtty))&&input.val(goToStepQuantity(val,stepQtty,"+")).trigger("keyup").trigger("change")}),$(document).on("click",".quantity-ndk-minus",function(t){t.preventDefault(),targetClass=void 0!==$(this).attr("data-target-class")?"."+$(this).attr("data-target-class"):".ndk-accessory-quantity",input=$(this).parent().find(targetClass),step=void 0!==input.attr("step")?parseFloat(input.attr("step")):1,currentVal=parseInt($(this).parent().find(targetClass).val()),quantityMinNdk=0<$(this).parent().find(targetClass).attr("data-qtty-min")?$(this).parent().find(".ndk-accessory-quantity").attr("data-qtty-min"):0,(""!=input.attr("data-step_quantity")?(stepQtty=input.attr("data-step_quantity").split(";").map(Number),val=parseInt(input.val()),input.val(goToStepQuantity(val,stepQtty,"-"))):!isNaN(currentVal)&&currentVal-step>quantityMinNdk?$(this).parent().find(targetClass).val(currentVal-parseFloat(step)):$(this).parent().find(targetClass).val(quantityMinNdk)).trigger("keyup").trigger("change")}),$(document).on("click",".ndkcfTitle",function(t){}),$(document).on("click",".userPanelTitle",function(t){$(".userPanel").toggle()}),$(document).on("change",".ndk-accessory-quantity[data-step_quantity!='']",function(t){""!=$(this).attr("data-step_quantity")&&(stepQtty=$(this).attr("data-step_quantity").split(";").map(Number),val=parseInt($(this).val()),-1==$.inArray(val,stepQtty))&&$(this).val(goToStepQuantity(val,stepQtty,"+")).trigger("keyup")}),$(document).on("change",".ndk-accessory-quantity",function(t){setAccessoryCustomization($(this)),$(this).trigger("keyup")}),$(document).on("click",".trigger-close-fancybox",function(t){t.preventDefault(),$(".fancybox-close").trigger("click")}),$(document).on("keyup",".ndk-accessory-quantity[value!='0'], .ndk-accessory-quantity-block .ndk-accessory-quantity",function(t){rootBlock=$(".form-group[data-field='"+$(this).attr("data-group")+"']"),qttyCheckNode=rootBlock,current_row=$(this).attr("data-id-product-accessory"),rowNode=$(".form-group[data-field='"+$(this).attr("data-group")+"']").find(".accessory-ndk[data-id-product-value='"+current_row+"']"),0==(max=parseInt(rootBlock.attr("data-qtty-max")))&&(max=parseInt(rowNode.attr("data-qtty-max")),qttyCheckNode=rowNode),max_weight=parseFloat(rootBlock.attr("data-weight-max")),(max_weight=0)==max&&(max=9999999999),0==max_weight&&(max_weight=9999999999),0==(min=parseInt(rootBlock.attr("data-qtty-min")))&&(min=parseInt(rowNode.attr("data-qtty-min")),qttyCheckNode=rowNode),0==(min_weight=parseFloat(rootBlock.attr("data-weight-min")))&&(min_weight=parseInt(rowNode.attr("data-weight-min")),qttyCheckNode=rowNode),qtty_total=0,weight_total=0,rootBlock.find(".quantity_error_up").fadeOut().delay(1e4),qttyCheckNode.find(".ndk-accessory-quantity[value!=0]").each(function(){qtty_total+=parseInt($(this).val()),weight_total+=parseInt($(this).val())*parseFloat($(this).attr("data-weight"))}),weight_total=weight_total.toPrecision(3),(parentBlock=rootBlock.find(".accessory-ndk[data-id-product-value='"+$(this).attr("data-id-product-accessory")+"']")).addClass("selected-product-accessory"),id_product=$(this).attr("data-id-product-accessory"),$("#attribute_combination_"+id_product).trigger("change"),rootBlock.find(".total_weight").html(parseFloat(weight_total).toFixed(3)),rootBlock.find(".total_qtty").html(parseInt(qtty_total)),parseFloat(weight_total)>=parseFloat(min_weight)?rootBlock.find(".weight_error_down").removeClass("required_field").fadeOut():rootBlock.find(".weight_error_down").addClass("required_field"),parseInt(qtty_total)>parseInt(max)?(rootBlock.find(".quantity_error_up").show(),$(this).parent().find(".quantity-ndk-minus").trigger("click")):parseFloat(weight_total)>parseFloat(max_weight)?(rootBlock.find(".weight_error_up").show(),$(this).parent().find(".quantity-ndk-minus").trigger("click")):(qtty=parseInt(this.value),unitPrice=$(this).attr("data-price"),group=$(this).attr("data-group"),price=qtty*unitPrice,valueId=$(this).attr("data-value-id"),name=$(this).attr("data-value"),0==$(this).val()?($(".disabled_value_by_"+group).removeClass("disabled_value_by_"+group),parentBlock.removeClass("selected-product-accessory")):checkFieldRestrictions($(this).attr("data-id-value")+"["+qtty+"]",group),id_product=$(this).attr("data-id-product-accessory"),id_combination=$(this).attr("data-id_combination"),e=$(this),qtty=e.hasClass("ndk-accessory-comb-tab")?(qtty_total=0,parentBlock=$(".form-group[data-field='"+group+"']"),targets=e.hasClass("ndk-accessory-comb-tab")?".ndk-accessory-quantity[value!=0][data-id-value="+e.attr("data-id-value")+"]":".ndk-accessory-quantity[value!=0]",parentBlock.find(targets).each(function(){qtty_total+=parseInt($(this).val())}),$("#ndkcf_totalprod_quantity_"+e.attr("data-id-value")).val(qtty_total).trigger("change"),attrBlock=e.parent().parent().parent(),qtty_total_attr=0,attrBlock.find(".ndk-accessory-quantity[value!=0]").each(function(){qtty_total_attr+=parseInt($(this).val())}),attrBlock.parent().find(".color_counter").html(qtty_total_attr),qtty_total):$(this).val(),e.hasClass("price_overrided")?updatePriceNdk(price,valueId):(0<qtty&&id_combination,loadAccessoryAttrPrice(id_product,id_combination,qtty,e)));var e=$(this);1==displayPriceHT&&0<qtty&&($(".final_price_"+e.attr("data-id-value")+" .priceht").remove(),$(".final_price_"+e.attr("data-id-value")).append('<span class="priceht clear clearfix"></span>'),getPriceHt(e.attr("data-price"),".final_price_"+e.attr("data-id-value")+" .priceht"))}),$(document).on("change",".ndk-checkbox",function(t){qtty=1,unitPrice=$(this).attr("data-price"),group=$(this).attr("data-group"),price=qtty*unitPrice,valueId=$(this).attr("data-value-id"),name=$(this).attr("data-value"),$(this).is(":checked")?(checkFieldRestrictions($(this).attr("data-value-id"),group),updatePriceNdk(price,valueId)):($(".disabled_value_by_"+group).removeClass("disabled_value_by_"+group),updatePriceNdk(0,valueId))}),$(document).on("click",".img-value",function(){group=$(this).attr("data-group"),updatePriceNdk(price=$(this).attr("data-price"),group),"null"!=$(this).attr("data-quantity-available")&&updateQuantityForValue($(this).attr("data-quantity-available"),group),setImgValue($(this),group),$(this).parent().parent().parent().find(".remove-img-item").show(),ProgressBar()}),$.fn.ndkSubmit=function(t){if("function"==typeof $.fn.ndkSubmit_Override)return $.fn.ndkSubmit_Override(t);var e,i;if(e)return!0;($('input.ndk-accessory-quantity[data-group="2982"]').length||$('input.ndk-accessory-quantity[data-group="2983"]').length)&&(i=0,$.each($('input.ndk-accessory-quantity[data-group="2982"], input.ndk-accessory-quantity[data-group="2983"]'),function(){i+=parseInt($(this).attr("value"))}),0==i?($("p[data-name='ndkcsfield[2983]']").remove(),$(".form-group[data-field='2983']").find(".fieldPane").append('<p data-name="ndkcsfield[2983]" class="alert-danger clear clearfix quantity_error_down  required_field" val="" style="display: block;">Vous devez ajouter un minimum de 1 quantités</p>'),$(".form-group[data-field='2983']").css("background","#F2DEDE").focus(),$("p[data-name='ndkcsfield[2982]']").remove(),$(".form-group[data-field='2982']").find(".fieldPane").append('<p data-name="ndkcsfield[2982]" class="alert-danger clear clearfix quantity_error_down  required_field" val="" style="display: block;">Vous devez ajouter un minimum de 1 quantités</p>'),$(".form-group[data-field='2982']").css("background","#F2DEDE").focus(),t.preventDefault()):($("p[data-name='ndkcsfield[2983]']").remove(),$("p[data-name='ndkcsfield[2982]']").remove(),$(".form-group[data-field='2982']").css("background","#FFFFFF").focus(),$(".form-group[data-field='2983']").css("background","#FFFFFF").focus()));var a=$(this),r=$(".form-group:not([class*='disabled_value_by'])").find(".required_field");return $i=0,r.each(function(){rootBlock="";if(verificaCampo=$(this).parent().parent().parent().attr("data-typefield"),-1===$.inArray(verificaCampo,["11","23","17","24"])&&(val=$(this).hasClass("quantity_error_down")||$(this).hasClass("quantity_error_up")?(group=$(this).parent().parent().parent().attr("data-field"),$(this).attr("val")):(group=(group=(group=(void 0!==$(this).attr("data-name")?$(this).attr("data-name"):$(this).attr("name")).split("ndkcsfield["))[1].split("]"))[0],$(this).val())),rootBlock=$(".form-group[data-field='"+group+"']:not(.submitContainer)"),$(this).is(":radio"))if($k=1,rootBlock.find(".error").remove(),others=rootBlock.find('input[type="radio"]'),$(this).is(":checked")){for(var t=0;t<others.length;t++)$i+=1,$k+=1;rootBlock.removeClass("focusRequired"),rootBlock.find(".error").remove()}else(c=rootBlock.find('input[type="radio"]:checked').length)<1?(rootBlock.addClass("focusRequired").focus(),rootBlock.find(".error").remove(),$(".view_tab[data-view='"+rootBlock.attr("data-view")+"']").trigger("click"),1==makeSlide&&ndkCfShowSlide(rootBlock),scrollToNdk($(this),800),rootBlock.parent().hasClass("groupFieldBlock")&&(targetButtonPack=$(".toggleGroupField[target='#"+rootBlock.parent().attr("id")+"']")).trigger("click"),void 0!==$(this).attr("data-message")&&"undefined"!=$(this).attr("data-message")&&rootBlock.find(".fieldPane").append('<span class="error alert-danger clear clearfix">'+$(this).attr("data-message")+"</span>")):(rootBlock.removeClass("focusRequired"),rootBlock.find(".error").remove());else if($(this).is(":checkbox"))if($k=0,group=$(this).attr("data-group"),rootBlock.find(".error").remove(),others=rootBlock.find('input[type="checkbox"]'),$(this).is(":checked")){for(t=0;t<others.length;t++)$i++,$k++;rootBlock.removeClass("focusRequired"),rootBlock.find(".error").remove()}else $k<others.length&&(rootBlock.addClass("focusRequired").focus(),$(".view_tab[data-view='"+rootBlock.attr("data-view")+"']").trigger("click"),1==makeSlide&&ndkCfShowSlide(rootBlock),scrollToNdk($(this),800),rootBlock.parent().hasClass("groupFieldBlock")&&(targetButtonPack=$(".toggleGroupField[target='#"+rootBlock.parent().attr("id")+"']")).trigger("click"),void 0!==$(this).attr("data-message"))&&"undefined"!=$(this).attr("data-message")&&rootBlock.find(".fieldPane").append('<span class="error alert-danger clear clearfix">'+$(this).attr("data-message")+"</span>");else $(this).is("select")?val?($i++,rootBlock.removeClass("focusRequired"),rootBlock.find(".error").remove()):(rootBlock.addClass("focusRequired").focus(),rootBlock.find(".fieldPane").show().find(".error").remove(),$(".view_tab[data-view='"+rootBlock.attr("data-view")+"']").trigger("click"),1==makeSlide&&ndkCfShowSlide(rootBlock),scrollToNdk($(this),800),rootBlock.parent().hasClass("groupFieldBlock")&&(targetButtonPack=$(".toggleGroupField[target='#"+rootBlock.parent().attr("id")+"']")).trigger("click"),void 0!==$(this).attr("data-message")&&"undefined"!=$(this).attr("data-message")&&rootBlock.find(".fieldPane").append('<span class="error alert-danger clear clearfix">'+$(this).attr("data-message")+"</span>"),$(this).is("p")&&$(this).show(),rootBlock.parent().parent().hasClass("ac_container")&&($("#"+rootBlock.parent().parent().attr("data-button-id")).trigger("click"),rootBlock.parent().parent().find(".fieldPane").show())):""==val||": "==val.slice(-2)?(rootBlock.addClass("focusRequired").focus(),rootBlock.find(".fieldPane").show().find(".error").remove(),$(".view_tab[data-view='"+rootBlock.attr("data-view")+"']").trigger("click"),1==makeSlide&&ndkCfShowSlide(rootBlock),scrollToNdk($(this),800),rootBlock.parent().hasClass("groupFieldBlock")&&(targetButtonPack=$(".toggleGroupField[target='#"+rootBlock.parent().attr("id")+"']")).trigger("click"),void 0!==$(this).attr("data-message")&&"undefined"!=$(this).attr("data-message")&&rootBlock.find(".fieldPane").append('<span class="error alert-danger clear clearfix">'+$(this).attr("data-message")+"</span>"),$(this).is("p")&&$(this).show(),rootBlock.parent().parent().hasClass("ac_container")&&($("#"+rootBlock.parent().parent().attr("data-button-id")).trigger("click"),rootBlock.parent().parent().find(".fieldPane").show())):($i++,rootBlock.removeClass("focusRequired"),rootBlock.find(".error").remove())}),$i>=r.length?e?checkEmptyForm(t):void checkRecommends(a,t):(r=$("div.focusRequired:not([class*='disabled_value_by'])").first().offset(),$("html, body").animate({scrollTop:r.top-125},"fast"),t.preventDefault(),!1)},$(document).on("click",".showRecommendItem",function(){isItem=!1,el=$(this).parent(),-1<(group=el.attr("id").replace("showRecommendItem_","")).indexOf("-")&&(isItem=!0,number=group.split("-")[1],group=itemGroup=group.split("-")[0]),$("#ndkcsfields .toggler").removeClass("active"),0==parseInt(letOpen)&&$("#ndkcsfields .fieldPane").hide(),formGroup=$(".form-group[data-field='"+group+"']"),id_product_pack=formGroup.parent().attr("id"),formGroup.parent().hasClass("groupFieldBlock")&&(targetButtonPack=$(".toggleGroupField.closed[target='#"+formGroup.parent().attr("id")+"']")).trigger("click"),$(".view_tab[data-view='"+formGroup.attr("data-view")+"']:not(.activeView)").trigger("click"),scrollToNdk(formGroup,800),1==makeSlide&&($(".sliderBlock .ndkackFieldItem").removeClass("activeItem"),formGroup.addClass("activeItem")),$.fancybox.close(),checked=!1,formGroup.find(".toggler:not(.active)").trigger("click"),isItem&&(scrollToNdk(formGroup.find(".designer-item[data-number='"+number+"']"),800),$(".designer-item[data-number='"+number+"']").show())});var ghoape=function(t){var i,a,e;return"function"==typeof getHeightOfAbsolutelyPositionedElement_Override?getHeightOfAbsolutelyPositionedElement_Override(t):(a=i=0,e=[],$.each($(t).find("*"),function(t,e){i=Math.max(i,$(e).offset().top+$(e).height()),a=Math.max(a,$(e).offset().left+$(e).width())}),e.y=i-$(t).offset().top,e.x=a-$(t).offset().left,$(t).css("width",e.x).css("height",e.y).css("position","unset"),e)};function preload(t){if("function"==typeof preload_Override)return preload_Override(t);$(t).each(function(){$("<img/>")[0].src=this})}function setTags(){if("function"==typeof setTags_Override)return setTags_Override();$(".tagged").each(function(){fullClass=$(this).attr("class"),$(this).attr("class","filterTag "+fullClass.replace(/[!\"#$%&'\(\)\*\+,\.\/:;<=>\?\@\[\\\]\^`\{\|\}~]/g,"").toLowerCase()),tags=(tags=$(this).attr("data-tags")).split("|"),rootBlock=$(this).attr("data-group");for(var t=0;t<tags.length;t++)""!=tags[t]&&-1==$.inArray(tags[t]+"|"+rootBlock,filtersTags)&&filtersTags.push(tags[t]+"|"+rootBlock)}),encountred=[];for(var t=0;t<filtersTags.length;t++)value=filtersTags[t].split("|"),-1==$.inArray(value[1],encountred)&&(mySelector=$("#main-"+value[1]).find(".visu-tools").prepend('<div class="tag-selector-container"><p class="clear clearfix"><label>'+filterText+'</label></p><select id="tag-select-'+value[1]+'" class=" ndk_tag_selector"><option value="all">'+allText+"</option></select></div>"),encountred.push(value[1]));for(t=0;t<filtersTags.length;t++)value=filtersTags[t].split("|"),properValue=value[0].replace(/[!\"#$%&'\(\)\*\+,\.\/:;<=>\?\@\[\\\]\^`\{\|\}~]/g,""),$("#tag-select-"+value[1]).append('<option value="'+properValue.replace(/ /g,"-").toLowerCase()+'">'+value[0]+"</option>");$(document).on("change",".ndk_tag_selector",function(){("all"==$(this).val()?$(this).parent().parent().parent().parent().find(".filterTag"):($(this).parent().parent().parent().parent().find(".filterTag").hide(),$(this).parent().parent().parent().parent().find("."+$(this).val()))).show()})}function updatePriceAttrNdk(){if("function"==typeof updatePriceAttrNdk_Override)return updatePriceAttrNdk_Override();var t=$("#idCombination").val();if("undefined"!=typeof combinationsFromController){t=combinationsFromController[t];if(void 0!==t){var e=+productPriceTaxExcluded,i=+productPriceTaxIncluded;groupReduction;e+=+t.price,i+=+t.price*(taxRate/100+1),t.specific_price&&0<t.specific_price.price&&(e=+t.specific_price.price,i=+t.specific_price.price*(taxRate/100+1));for(var a,r=e,o=i,e=(default_eco_tax&&(r+=default_eco_tax*(1+ecotaxTax_rate/100),o+=default_eco_tax*(1+ecotaxTax_rate/100),i+=default_eco_tax*(1+ecotaxTax_rate/100),e+=default_eco_tax*(1+ecotaxTax_rate/100)),t.specific_price&&0<t.specific_price.reduction&&("amount"==t.specific_price.reduction_type?void 0!==t.specific_price.reduction_tax&&"0"===t.specific_price.reduction_tax&&(a=t.specific_price.reduction,r-=a=0==t.specific_price.id_currency?a*currencyRate*(1-groupReduction):a,o-=a*(taxRate/100+1)):"percentage"==t.specific_price.reduction_type&&(r*=1-+t.specific_price.reduction,o*=1-+t.specific_price.reduction)),priceWithDiscountsDisplay=noTaxForThisProduct||customerGroupWithoutTax?(basePriceDisplay=e,r):(basePriceDisplay=i,o),t.specific_price&&0<t.specific_price.reduction&&"amount"==t.specific_price.reduction_type&&(void 0===t.specific_price.reduction_tax||void 0!==t.specific_price.reduction_tax&&"1"===t.specific_price.reduction_tax)&&(a=t.specific_price.reduction,"undefined"!=typeof specific_currency&&specific_currency&&parseInt(t.specific_price.id_currency)&&t.specific_price.id_currency!=currency.id?a/=currencyRate:specific_currency||(a*=currencyRate),"undefined"!=typeof groupReduction&&0<groupReduction&&(a*=1-parseFloat(groupReduction)),r=(priceWithDiscountsDisplay-=a)-a*(1/(1+taxRate/100))),basePriceDisplay!=priceWithDiscountsDisplay&&(basePriceDisplay,priceWithDiscountsDisplay,priceWithDiscountsDisplay,basePriceDisplay),+t.unit_impact),n=((0<productUnitPriceRatio||e)&&(e?(baseUnitPrice=productBasePriceTaxExcl/productUnitPriceRatio,unit_price=baseUnitPrice+e,noTaxForThisProduct&&customerGroupWithoutTax||(unit_price*=taxRate/100+1)):unit_price=priceWithDiscountsDisplay/productUnitPriceRatio),0),d=0;d<groupAdded.length;d++)void 0!==groupAdded[d]&&(n+=parseFloat(+groupAdded[d]));0<parseFloat(void 0)&&(i=priceWithDiscountsDisplay,new_price=parseFloat(+i)+parseFloat(+n),n=0,setTimeout(function(){$("#our_price_display").text(formatCurrencyNdk(new_price*currencyRate))},50)),$("#add_to_cart, .product-add-to-cart > *:not(.product-quantity), .add, .add-to-cart").hide()}}}function showLayer(t){if("function"==typeof showLayer_Override)return showLayer_Override(t);view=t.attr("data-view"),group=t.attr("data-group"),(target=0<view&&0<$(".zone_limit[data-group='"+group+"']").length?$(".zone_limit[data-group='"+group+"']"):$("#visual_"+group)).show(),t.addClass("visible_layer").removeClass("hidden_layer"),$(".hidden_layer[data-group='"+group+"']").trigger("click")}function hideLayer(t){if("function"==typeof hideLayer_Override)return hideLayer_Override(t);view=t.attr("data-view"),group=t.attr("data-group"),(target=0<view&&0<$(".zone_limit[data-group='"+group+"']").length?$(".zone_limit[data-group='"+group+"']"):$("#visual_"+group)).hide(),t.addClass("hidden_layer").removeClass("visible_layer"),$(".visible_layer[data-group='"+group+"']").trigger("click")}function makeFloat(t,e){if("function"==typeof makeFloat_Override)return makeFloat_Override(t,e);if(!$("body").hasClass("ndkcfLoaded"))return!1;e=e||"";var a,r,o,i=$(t);$parent=""!=e?$(e):$(i).parent(),elOffset=$(t).offset(),768<$(window).width()&&1!=contentOnly&&(a=jQuery,o=a(t),r="undefined"!=typeof elOffset?elOffset.top:0,o.css("position","relative"),a(window).on("scroll",function(t){var e=$parent.innerHeight()-a(o).innerHeight(),i=a(window).scrollTop();i-$parent.offset().top+20<e&&o.stop(!1,!1).animate({top:i<r?0:i-r+20},250)}))}function checkRangeDimensions(e,i,a){return i=""!=i?i:0,a=""!=a?a:1,$.ajax({type:"GET",async:!0,url:baseUrl+"modules/ndk_advanced_custom_fields/front_ajax.php?action=checkRangeDimensions",data:{width:i,height:a,group:e},success:function(t){return 0!=t||(message='<span class="error alert-danger clear clearfix">Die Maße '+i+"mm x "+a+"mm sind nicht herstellbar.</span>",ShowNDKFieldError(e,message),!1)}}),!1}function getMinHeight(t,e){$.ajax({type:"GET",async:!0,url:baseUrl+"modules/ndk_advanced_custom_fields/front_ajax.php?action=getMinHeight",data:{width:e,group:groupf},success:function(t){isNaN(t)}})}function checkFieldRestrictions(t,e){if("function"==typeof checkFieldRestrictions_Override)return checkFieldRestrictions_Override(t,e);if(data={restrictions:!1,obligations:!1},$(".form-group[data-field='"+e+"']").removeClass("focusRequired").find(".error").remove(),my_id_value=t&&-1<t.indexOf("[")?(idValArr=t.split("["))[0]:t,"undefined"!=typeof(data=void 0!==jsonDatas[e]&&void 0!==jsonDatas[e][my_id_value]?jsonDatas[e][my_id_value]:data)&&null!==data&&""!=data&&(void 0!==data.restrictions&&null!==data.restrictions&&""!=data.restrictions||void 0!==data.obligations&&null!==data.obligations&&""!=data.obligations)){if(goTonextStep(e),selectedIdValue[e]!=my_id_value){if(selectedIdValue[e]=my_id_value,!$(".form-group[data-field='"+e+"']").hasClass("hasRestrictions"))return!0;if(killer=(t=t||!1)&&-1<t.indexOf("[")?(idValArr=t.split("["))[0]:0,$(".form-group[data-field='"+e+"']").removeClass("focusRequired").find(".error").remove(),$(".disabled_value_by_"+e).removeClass("disabled_value_by_"+e),$(".disabled_value_by_"+e+(0<killer?"_"+killer:"")).removeClass("disabled_value_by_"+e+(0<killer?"_"+killer:"")),"undefined"!=typeof data&&null!==data&&null!=data.restrictions&&""!=data.restrictions){$(".disabled_value_by_"+e).removeClass("disabled_value_by_"+e);for(var i=0;i<=data.restrictions.length;i++)data.restrictions[i],null!==data.restrictions[i]&&data.restrictions[i]&&(splitted=data.restrictions[i].split("|"),targetVal=splitted[1],targetValValue=splitted[2],targetGroup=(targetGroup=splitted[0]).replace("]","").replace("[",""),$("#ndkcsfield_"+targetGroup).val()!=targetValValue&&"all"!=targetVal||(rootBlock=$(".form-group[data-field='"+targetGroup+"']"),$("#visual_"+targetGroup).remove(),$("#ndkcsfield_"+targetGroup).val(""),rootBlock.find(".noborder, .noborderSimple, .falsenoborder, .recipient-text").val(""),rootBlock.find("input[type='checkbox']").prop("checked",!1).trigger("change"),rootBlock.find(".selected-value").removeClass("selected-value"),0<rootBlock.find('.noborder[value!=""], .noborderSimple[value!=""], .falsenoborder[value!=""]').length&&(rootBlock.find(".noborder, .noborderSimple, .falsenoborder").val(""),rootBlock.find(".submitText, .submitSimpleText").trigger("click")),$("#layer-edit-"+targetGroup).remove(),$.prototype.uniform&&$.uniform.update("#ndkcsfields input, #ndkcsfields select"),$("#dimension_text_width_"+targetGroup).val(""),$("#dimension_text_height_"+targetGroup).val(""),$(".recap_group_"+targetGroup).remove(),updatePriceNdk(0,targetGroup),groupAdded[targetGroup]=0,checkLayerChanges()),disableFieldRestriction(targetVal,e,targetGroup,killer))}else $(".disabled_value_by_"+e).removeClass("disabled_value_by_"+e),$(".disabled_value_by_"+e+(0<killer?"_"+killer:"")).removeClass("disabled_value_by_"+e+(0<killer?"_"+killer:""));if("object"==typeof data&&"object"==typeof data.obligations)for(i=0;i<=data.obligations.length;i++)data.obligations[i],null!==data.obligations[i]&&data.obligations[i]&&(splitted=data.obligations[i].split("|"),targetVal=splitted[1],targetValValue=splitted[2],targetGroup=(targetGroup=splitted[0]).replace("]","").replace("[",""),applyDefaultValuesNdk(rootBlock=$(".form-group[data-field='"+targetGroup+"']"),'[data-id-value="'+targetVal+'"]',!1),checkLayerChanges())}}else $(".disabled_value_by_"+e).removeClass("disabled_value_by_"+e),selectedIdValue[e]=t;goTonextStep(e)}function goTonextStep(t){$(".form-group.steppedField[data-field='"+t+"']").addClass("stepDone").removeClass("stepTodo"),$(".notReadyStep:eq(0)").removeClass("notReadyStep").find(".toggler").trigger("click")}function setScenario(){$(".overDisabler").remove();for(var t=0;t<scenario.length;t++)$(".form-group[data-field='"+scenario[t]+"']").addClass("steppedField notReadyStep stepTodo").append('<div class="overDisabler"></div>');$(".notReadyStep:eq(0)").removeClass("notReadyStep")}function setOpenedStatus(){for(var t=0;t<opened_fields.length;t++)$(".form-group[data-field='"+opened_fields[t]+"']").find(".toggler:not(.active)").trigger("click");for(t=0;t<closed_fields.length;t++)$(".form-group[data-field='"+opened_fields[t]+"']").find(".toggler.active").trigger("click")}function identifyResctictives(){for(var t=0;t<hasRestrictions.length;t++)$(".form-group[data-field='"+hasRestrictions[t]+"']").addClass("hasRestrictions")}function disableFieldRestriction(t,e,i,a){return"function"==typeof disableFieldRestriction_Override?disableFieldRestriction_Override(t,e,i,a):void 0===t||""==t||"undefined"==t||("all"==t&&($(".form-group[data-field='"+i+"']:not(.submitContainer)").addClass("disabled_value_by_"+e),$(".form-group[data-field='"+i+"']").find(".ndk-accessory-quantity[value!=0]").val(0).trigger("change").trigger("keyup").addClass("disabled_value_by_"+e),$(".ndkQuickAccessBox-item[data-target='"+i+"']:not(.submitContainer)").addClass("disabled_value_by_"+e)),-1<t.indexOf("[")?(idValArr=t.split("["),idValue=idValArr[0],qttyVal=idValArr[1].replace("]",""),$("#ndk-accessory-quantity-"+a).val()==qttyVal&&($("#ndk-accessory-quantity-"+idValue).addClass("disabled_value_by_"+e+(0<a?"_"+a:"")).val(0).trigger("change").trigger("keyup"),$("#ndk-accessory-quantity-"+idValue).parent().parent().parent().addClass("disabled_value_by_"+e),$("#ndk-accessory-quantity-"+idValue).parent().parent().parent().addClass("disabled_value_by_"+e+(0<a?"_"+a:"")).val(0).trigger("change").trigger("keyup"))):($("#ndk-accessory-quantity-"+t).addClass("disabled_value_by_"+e+(0<a?"_"+a:"")).val(0).trigger("change").trigger("keyup"),$("#ndk-accessory-quantity-"+t).parent().parent().parent().addClass("disabled_value_by_"+e),$("#ndk-accessory-quantity-"+t).parent().parent().parent().addClass("disabled_value_by_"+e+(0<a?"_"+a:"")).val(0).trigger("change").trigger("keyup")),$("[data-id-value='"+t+"']").addClass("disabled_value_by_"+e),void $(".ndk-radio[data-id-value='"+t+"']").parent().addClass("disabled_value_by_"+e))}function convertPercent(){if("function"==typeof convertPercent_Override)return convertPercent_Override();$(".absolute-visu:visible").each(function(){dragToPercent($(this))}),$("#image-block").css({width:"100%",height:"auto"})}function convertPercentBAK(){if("function"==typeof convertPercentBAK_Override)return convertPercentBAK_Override();$(".absolute-visu:visible").each(function(){-1<(group=$(this).attr("id").replace("visual_","")).indexOf("-")&&(group=group.split("-")[0]),target=0<$(".zone_limit[data-group='"+group+"']").length?(container=".zone_limit[data-group='"+group+"']",2):(container="#image-block",1),containerWidth=$(container).width(),containerHeight=$(container).height(),elWidth=$(this).width(),elHeight=$(this).height(),elLeft=$(this)[0].style.left.replace("px",""),elTop=$(this)[0].style.top.replace("px",""),widthPercent=elWidth/containerWidth*100+"%",elHeight,containerHeight,heightPercent="auto",leftPercent=elLeft/containerWidth*100+"%",topPercent=elTop/containerHeight*100+"%",$(this).css({width:widthPercent,height:heightPercent,margin:""}),elLeft.indexOf("%")<1&&$(this).css({left:leftPercent}),elTop.indexOf("%")<1&&$(this).css({top:topPercent}),1==target||2!=target||$(this).parent().hasClass("zone_limit")||"#image-block"==$(this).parent().attr("id")||$(this).parent().css({width:widthPercent,height:heightPercent}),$("#image-block").css({width:"100%",height:"auto"})})}function convertDegree(t){if("function"==typeof convertDegree_Override)return convertDegree_Override(t);var t=document.getElementById(t),t=window.getComputedStyle(t,null),t=(t.getPropertyValue("-webkit-transform")||t.getPropertyValue("-moz-transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-o-transform")||t.getPropertyValue("transform")||"FAIL").split("(")[1].split(")")[0].split(","),e=t[0],i=t[1];t[2],t[3],Math.sqrt(e*e+i*i),Math.round(Math.atan2(i,e)*(180/Math.PI))}function applyDefaultValuesNdk(t,e,i){if(t=t||$("#ndkcsfields"),i=i||!0,"function"==typeof applyDefaultValuesNdk_Override)return applyDefaultValuesNdk_Override(t);var a;i&&(a="",t.find('*[data-hide-field="1"]').each(function(){var t=$(this).closest("[data-field]").data("field");t!=a&&(a=t,$(this).is(":checkbox")?checkFieldRestrictions($(this).attr("data-value-id"),$(this).attr("data-group")):checkFieldRestrictions($(this).attr("data-id-value"),$(this).attr("data-group")))}))}function scrollToNdk(t,e){if("function"==typeof scrollToNdk_Override)return scrollToNdk_Override(t,e);1!=ndk_disableAutoScroll&&(e=e||750,t.length)&&$("html").animate({scrollTop:t.offset().top-100,scrollLeft:t.offset().left},e)}function strReplaceAll(e,t,i){try{return e.replace(new RegExp(t,"gi"),i)}catch(t){return e}}function emptyFormNdk(t){if("function"==typeof emptyFormNdk_Override)return emptyFormNdk_Override(t);checkbox=t.find('input[type="checkbox"]'),radio=t.find('input[type="radio"]'),text=t.find('input[type="text"], input[type="hidden"]'),select=t.find("select"),checkbox.prop("checked",!1).trigger("change"),radio.prop("checked",!1).trigger("change")}function setQuickNav(){if("function"==typeof setQuickNav_Override)return setQuickNav_Override();$("#ndkQuickAccessBox").remove(),0<$(".pb-right-column").length?$(".pb-right-column").append('<div id="ndkQuickAccessBox" class="quickFullWidth"><ul></ul></div>'):$("#ndkcsfields-block").append('<div id="ndkQuickAccessBox"><ul></ul></div>').addClass("withQuickNav"),$(".toggler:not(.dontquick)").each(function(){(groupTitleEl=$(this).clone()).find(".toggleText, .tooltipDescription, .tooltipDescMark").remove(),title=groupTitleEl.text(),group=$(this).parent().attr("data-field"),$("#ndkQuickAccessBox ul").append('<li class="ndkQuickAccessBox-item" data-target="'+group+'">'+title+"</li>")}),$(document).on("click",".ndkQuickAccessBox-item",function(){$(".ndkQuickAccessBox-item").removeClass("active"),group=$(this).attr("data-target"),$(this).addClass("active"),$(".ndkackFieldItem[data-field='"+group+"'] label:eq(0)").trigger("click")}),$(".pb-right-column").length<1&&makeFloat("#ndkQuickAccessBox")}function updateDisplayAttrNdk(){ps_version<=1.6&&(productPrice,productPriceWithoutReduction,!selectedCombination.unavailable&&0<quantityAvailable&&1==productAvailableForOrder||allowBuyWhenOutOfStock&&!selectedCombination.unavailable&&productAvailableForOrder?$(".ndkcsfields-block").fadeIn(600):$(".ndkcsfields-block").fadeOut(600))}$(document).on("click",".colorize_svg li",function(){root=$(this).parent().parent().parent().parent().parent(),color=$(this).find("span").text(),$(this).parent().find("li").removeClass("selected"),$(this).addClass("selected"),$(this).parent().parent().find(".index-value").html($(this).html()),root.find(".replaced-svg").each(function(){$(this).attr("fill",color);var t=$(this).parent();$(this).parent().hasClass("selected-svg")&&$.when(t.parent().parent().trigger("click")).done(function(){t.trigger("click")})})}),$.fn.setNdkSelector=function(){visible=!1;var e=$(this).find("ul"),t=e.find("li").first(),i=(0==$(this).find(".index-value").length&&$(this).prepend('<div class="index-value"></div>'),e.find("li.selected"));i.length?$(this).find(".index-value").html(i.html()):$(this).find(".index-value").html(t.html()),e.find("li").length<2&&$(this).parent().hide(),e.hide(),$(this).click(function(){var t;visible||(e.show("fast",function(){visible=!0}),(t=e.find("li.selected")).length&&$(this).find(".index-value").html(t.html()))}),$("html").click(function(){visible&&$(".ndk_selector").find("ul").hide("fast",function(){visible=!1})})},equalheight=function(t){var e,i=0,a=new Array;$(t).each(function(){for(e=$(this),topPostion=e.position().top,a.push(e),i=i<e.height()?e.height():i,currentDiv=0;currentDiv<a.length;currentDiv++)a[currentDiv].height(i)})},equalheightbyRow=function(t){var e,i=0,a=0,r=new Array;$(t).each(function(){if(e=$(this),$(e).height("auto"),topPostion=e.position().top,topPositionParent=e.parent().parent().position().top,a!=topPostion){for(currentDiv=0;currentDiv<r.length;currentDiv++)r[currentDiv].height(i);r.length=0,a=topPostion,i=e.height(),r.push(e)}else if(a!=topPositionParent){for(currentDiv=0;currentDiv<r.length;currentDiv++)r[currentDiv].height(i);r.length=0,a=topPositionParent,i=e.height(),r.push(e)}else r.push(e),i=i<e.height()?e.height():i;for(currentDiv=0;currentDiv<r.length;currentDiv++)r[currentDiv].height(i)})},$(document).on("click",".ndkcfLoaded .color_pick",function(t){updatePriceNdkGeneric(),update_price_dynamic(0),snapShotLight()}),$(document).on("change",".ndkcfLoaded .attribute_select",function(){updatePriceNdkGeneric(),update_price_dynamic(0),updateDisplayAttrNdk()}),$(document).on("click",".ndkcfLoaded .attribute_radio",function(){updatePriceNdkGeneric(),update_price_dynamic(0),updateDisplayAttrNdk()}),$(document).on("change","#quantity_wanted",function(t){$("#max_options_quantity").remove(),void 0!==$(this).attr("max")&&"null"!=$(this).attr("max")&&parseFloat($(this).val())>parseFloat($(this).attr("max"))?($(this).val($(this).attr("max")).trigger("keyup"),$(this).parent().append('<span class="quantity_warning" id="max_options_quantity">'+textMaxQuantity+" "+$(this).attr("max")+"</span>")):$("#max_options_quantity").remove(),updatePriceNdkGeneric()}),$(document).on("keyup",".dimension_text",function(t){$(this).trigger("change")}),$(document).on("change",".dimension_text",function(t){groupf=parseInt($(this).attr("data-group")),width=$("#dimension_text_width_"+groupf).val(),height=$("#dimension_text_height_"+groupf).val();var e=!1;height=""!=height?height:1,"640259"===id_product&&$("#dimension_text_height_"+groupf).val(3e3),null!=width&&null!=height&&"949"!=groupf&&"1048"!=groupf&&(clearTimeout(typingTimer),typingTimer=setTimeout(function(){$.ajax({type:"GET",async:!0,url:baseUrl+"modules/ndk_advanced_custom_fields/front_ajax.php?action=getRangePrice",data:{width:width,height:height,group:groupf,id_product:$("#ndkcf_id_product").val()},success:function(t){e=checkRangeDimensions(groupf,width,height),isNaN(t)||(parseFloat(t)<0&&"number"==$("#dimension_text_height_"+groupf).attr("type")&&parseFloat(height)<$("#dimension_text_height_"+groupf).attr("max")?getMinHeight(groupf,width,height):parseFloat(height)>$("#dimension_text_height_"+groupf).attr("max")||($(".dimensions_block").length&&(3==t&&999999==t||(HideNDKFieldError(groupf),e=!1),3!=t&&999999!=t||(message='<span class="error alert-danger clear clearfix">Die Maße '+width+"mm x "+height+"mm sind nicht herstellbar.</span>",ShowNDKFieldError(groupf,message),e=!0)),e?updatePriceNdk(parseFloat(0),groupf):(updatePriceNdk(parseFloat(t),groupf),ProgressBar())));-1!==$.inArray(groupf,[4134,4092,4093,4131,4098,4099,4030,4103,4104,4112,4113,4114])&&Cintreecheck(groupf,width,height)}})},500))}),jQuery.fn.rotationDegrees=function(){var t,e=this.css("-webkit-transform")||this.css("-moz-transform")||this.css("-ms-transform")||this.css("-o-transform")||this.css("transform");return(e="string"==typeof e&&"none"!==e?(t=(e=e.split("(")[1].split(")")[0].split(","))[0],e=e[1],Math.round(Math.atan2(e,t)*(180/Math.PI))):0)<0?e+360:e},$(document).on("click","[data-dismiss='modal']",function(){location.reload()}),$(document).on("hidden.bs.modal","#blockcart-modal",function(){location.reload()}),$(document).on("change",".ndk-radio, .ndk-checkbox",function(){$(this).is(":radio")&&$("input[name='"+$(this).attr("name")+"']").not(this).removeAttr("checked").removeAttr("checkme"),$(this).is(":checked")?$(this).attr("checked","checked").attr("checkme","1"):($(this).removeAttr("checked"),$(this).removeAttr("checkme"))}),$(document).on("focus",".ndk-select",function(){$(this).find("option").removeAttr("disabled"),$(this).find('[class*="disabled_value_by"]').attr("disabled","disabled")}),$(window).on("load",function(){id_product=$("#ndkcf_id_product").val(),$(".form-group[data-iteration='1']").removeClass("aluclass-disable-div"),$(".additionnal_price").remove();var t=$("#portivaaumento").val();reductionpercentprice=$("#reductionpercentprice").val(),reductionpercent=$("#reductionpercent").val(),reductionpercentname=$("#reductionpercentname").val(),t=parseFloat(t)-.3*parseFloat(t),t=parseFloat(t)-parseFloat(reductionpercent)/100*parseFloat(t),0<parseInt(reductionpercentprice)&&(reductionpercentprice=parseFloat(reductionpercentprice)+parseFloat(t),console.log(reductionpercentprice),$(".productPriceUpHT, #our_price_display:visible").before('<span id="additionnal_price" data-price="'+customizationPrice+'" class=" product-price price additionnal_price">'+formatCurrencyNdk(customizationPrice)+"hehe</span>"),formatCurrencyNdkCallback(reductionpercentprice,".additionnal_price"," Mit Code "+reductionpercentname+" : ","<br> Code auf 1 Tag begrenzt")),$(".tooltipDescMark").hover(function(){$(this).find(".tooltip-ndk").css({opacity:"1",visibility:"visible",filter:"alpha(opacity=100)"})},function(){$(this).find(".tooltip-ndk").css({opacity:"0",visibility:"hidden",filter:"alpha(opacity=0)"})}),$(".tooltipDescMark").on("touchstart",function(){var t=$(this).find(".tooltip-ndk");0<t.css("opacity")&&"visible"===t.css("visibility")?t.css({opacity:"0",visibility:"hidden",filter:"alpha(opacity=0)"}):t.css({opacity:"1",visibility:"visible",filter:"alpha(opacity=100)"})})}),$(document).on("change",".ndkackFieldItem, select.form-control-ndk",function(){ActiveFieldNDK(this)}),$(document).on("click",".img-value",function(){ActiveFieldNDK(this)}),$(document).on("click",".color-ndk ",function(){priceColor=$(this).attr("data-price"),datagroupColor=$(this).attr("data-group");var t=(dataValueColor=$(this).attr("data-title")).split("+");-1===$.inArray(datagroupColor,["3060","3061","3062","3063","2905","4772","4773","4774","4775"])&&(0<parseInt(priceColor)||"5%"==t[1]||"8%"==t[1]||"37,5€ m2"==t[1]||"79€ m2"==t[1]||"185,4€ m2"==t[1]||"180,3€ m2"==t[1]||"45€ m2"==t[1]||"83€ m2"==t[1]||"44,6€ m2"==t[1]||"52,5€ m2"==t[1]||"91,25€ m2"==t[1]||"49,09€ m2"==t[1]||"57,75€ m2"==t[1]?$("#textwarringcolor_"+datagroupColor).html("<p class='pt-1' style='color:red;' >Eine zusätzliche Frist von 15 Werktagen</p>"):$("#textwarringcolor_"+datagroupColor).html("<p></p>"))}),$(".product_666_1121").on("click"," div.accessory_img_block",function(){$("div[data-field='723']").hasClass("disabled_value_by")?$("div[data-field='723']").removeClass("disabled_value_by"):($("div[data-field='723']").addClass("disabled_value_by"),$(".accessory-ndk[data-id-value='6495']").hasClass("selected-accessory")&&$("#img_div_6495").trigger("mousedown"))}),$(document).on("change",".ndk-select",function(){$("#ndkcsfield_"+$(this).attr("data-group")+" option[value='']").remove()}),$(".dimension_text_height").change(function(t){product_id=$("#product_page_product_id").val(),widthValue=$(this).val(),ndkgroupid=$(this).data("group"),4575!=parseInt(ndkgroupid)&&2021!=parseInt(ndkgroupid)&&2013!=parseInt(ndkgroupid)&&2244!=parseInt(ndkgroupid)&&2577!=parseInt(ndkgroupid)&&3944!=parseInt(ndkgroupid)&&3945!=parseInt(ndkgroupid)&&2574!=parseInt(ndkgroupid)&&3946!=parseInt(ndkgroupid)&&3947!=parseInt(ndkgroupid)&&2579!=parseInt(ndkgroupid)&&3948!=parseInt(ndkgroupid)&&3949!=parseInt(ndkgroupid)&&2627!=parseInt(ndkgroupid)&&2655!=parseInt(ndkgroupid)&&2665!=parseInt(ndkgroupid)&&126!=parseInt(ndkgroupid)&&4797!=parseInt(ndkgroupid)&&4836!=parseInt(ndkgroupid)&&5328!=parseInt(ndkgroupid)&&5329!=parseInt(ndkgroupid)&&4837!=parseInt(ndkgroupid)&&5330!=parseInt(ndkgroupid)&&5331!=parseInt(ndkgroupid)&&4838!=parseInt(ndkgroupid)&&5332!=parseInt(ndkgroupid)&&5333!=parseInt(ndkgroupid)&&4839!=parseInt(ndkgroupid)&&5335!=parseInt(ndkgroupid)&&5336!=parseInt(ndkgroupid)&&5315!=parseInt(ndkgroupid)&&5322!=parseInt(ndkgroupid)&&5323!=parseInt(ndkgroupid)&&5321!=parseInt(ndkgroupid)&&5324!=parseInt(ndkgroupid)&&5325!=parseInt(ndkgroupid)&&5343!=parseInt(ndkgroupid)&&5344!=parseInt(ndkgroupid)&&5345!=parseInt(ndkgroupid)&&5352!=parseInt(ndkgroupid)&&5353!=parseInt(ndkgroupid)&&5355!=parseInt(ndkgroupid)&&5361!=parseInt(ndkgroupid)&&5362!=parseInt(ndkgroupid)&&5363!=parseInt(ndkgroupid)&&5380!=parseInt(ndkgroupid)&&5381!=parseInt(ndkgroupid)&&5382!=parseInt(ndkgroupid)&&5568!=parseInt(ndkgroupid)&&5569!=parseInt(ndkgroupid)&&5570!=parseInt(ndkgroupid)&&5576!=parseInt(ndkgroupid)&&5577!=parseInt(ndkgroupid)&&5578!=parseInt(ndkgroupid)&&5584!=parseInt(ndkgroupid)&&5585!=parseInt(ndkgroupid)&&5586!=parseInt(ndkgroupid)&&5530!=parseInt(ndkgroupid)&&5531!=parseInt(ndkgroupid)&&5532!=parseInt(ndkgroupid)&&5539!=parseInt(ndkgroupid)&&5540!=parseInt(ndkgroupid)&&5541!=parseInt(ndkgroupid)&&5595!=parseInt(ndkgroupid)&&5596!=parseInt(ndkgroupid)&&5597!=parseInt(ndkgroupid)&&5606!=parseInt(ndkgroupid)&&5607!=parseInt(ndkgroupid)&&5608!=parseInt(ndkgroupid)&&("string"==typeof(widthValuetemp=$("#dimension_text_width_"+ndkgroupid).val())&&0===widthValuetemp.length||(widthValuetemp=widthValuetemp.replace(/\D/g,""),widthValue=widthValue.replace(/\D/g,""),$.isNumeric(widthValuetemp)&&$.isNumeric(widthValue)&&parseInt(widthValuetemp)>parseInt(widthValue)&&(widthValue=widthValuetemp)),ndkgroupid="width",$.ajax({type:"POST",url:"../modules/alucarrier/ajax.php",data:{action:"getpriceportes",product_id:product_id,widthValue:widthValue,ndkgroupid:ndkgroupid},success:function(t){"false"!=(objport=JSON.parse(t)).status&&($(".prazoentrega").html(objport.text_price),"true"==objport.free_shipping||"true"==objport.half_free_shipping)&&$("#portivaaumento").val(parseInt(objport.price))}}))}),$(".dimension_text_width").change(function(t){product_id=$("#product_page_product_id").val(),widthValue=$(this).val(),ndkgroupid=$(this).data("group"),4575!=parseInt(ndkgroupid)&&2021!=parseInt(ndkgroupid)&&2013!=parseInt(ndkgroupid)&&2244!=parseInt(ndkgroupid)&&4836!=parseInt(ndkgroupid)&&5328!=parseInt(ndkgroupid)&&5329!=parseInt(ndkgroupid)&&4837!=parseInt(ndkgroupid)&&5330!=parseInt(ndkgroupid)&&5331!=parseInt(ndkgroupid)&&4838!=parseInt(ndkgroupid)&&5332!=parseInt(ndkgroupid)&&5333!=parseInt(ndkgroupid)&&4839!=parseInt(ndkgroupid)&&5335!=parseInt(ndkgroupid)&&5336!=parseInt(ndkgroupid)&&5315!=parseInt(ndkgroupid)&&5322!=parseInt(ndkgroupid)&&5323!=parseInt(ndkgroupid)&&5321!=parseInt(ndkgroupid)&&5324!=parseInt(ndkgroupid)&&5325!=parseInt(ndkgroupid)&&5343!=parseInt(ndkgroupid)&&5344!=parseInt(ndkgroupid)&&5345!=parseInt(ndkgroupid)&&5352!=parseInt(ndkgroupid)&&5353!=parseInt(ndkgroupid)&&5355!=parseInt(ndkgroupid)&&5361!=parseInt(ndkgroupid)&&5362!=parseInt(ndkgroupid)&&5363!=parseInt(ndkgroupid)&&5380!=parseInt(ndkgroupid)&&5381!=parseInt(ndkgroupid)&&5382!=parseInt(ndkgroupid)&&5568!=parseInt(ndkgroupid)&&5569!=parseInt(ndkgroupid)&&5570!=parseInt(ndkgroupid)&&5576!=parseInt(ndkgroupid)&&5577!=parseInt(ndkgroupid)&&5578!=parseInt(ndkgroupid)&&5584!=parseInt(ndkgroupid)&&5585!=parseInt(ndkgroupid)&&5586!=parseInt(ndkgroupid)&&5530!=parseInt(ndkgroupid)&&5531!=parseInt(ndkgroupid)&&5532!=parseInt(ndkgroupid)&&5539!=parseInt(ndkgroupid)&&5540!=parseInt(ndkgroupid)&&5541!=parseInt(ndkgroupid)&&5595!=parseInt(ndkgroupid)&&5596!=parseInt(ndkgroupid)&&5597!=parseInt(ndkgroupid)&&5606!=parseInt(ndkgroupid)&&5607!=parseInt(ndkgroupid)&&5608!=parseInt(ndkgroupid)&&("string"==typeof(widthValuetemp=$("#dimension_text_height_"+ndkgroupid).val())&&0===widthValuetemp.length||2577!=parseInt(ndkgroupid)&&3944!=parseInt(ndkgroupid)&&3945!=parseInt(ndkgroupid)&&2574!=parseInt(ndkgroupid)&&3946!=parseInt(ndkgroupid)&&3947!=parseInt(ndkgroupid)&&2579!=parseInt(ndkgroupid)&&3948!=parseInt(ndkgroupid)&&3949!=parseInt(ndkgroupid)&&2627!=parseInt(ndkgroupid)&&2655!=parseInt(ndkgroupid)&&2665!=parseInt(ndkgroupid)&&126!=parseInt(ndkgroupid)&&4797!=parseInt(ndkgroupid)&&(widthValuetemp=widthValuetemp.replace(/\D/g,""),widthValue=widthValue.replace(/\D/g,""),$.isNumeric(widthValuetemp))&&$.isNumeric(widthValue)&&parseInt(widthValuetemp)>parseInt(widthValue)&&(widthValue=widthValuetemp),ndkgroupid="width",$.ajax({type:"POST",url:"../modules/alucarrier/ajax.php",data:{action:"getpriceportes",product_id:product_id,widthValue:widthValue,ndkgroupid:ndkgroupid},success:function(t){"false"!=(objport=JSON.parse(t)).status&&($(".prazoentrega").html(objport.text_price),"true"==objport.free_shipping||"true"==objport.half_free_shipping)&&$("#portivaaumento").val(parseInt(objport.price))}}))}),$(".ndk-radio").click(function(){product_id=$("#product_page_product_id").val(),widthValue=$(this).val(),ndkgroupid=$(this).data("group"),$.ajax({type:"POST",url:"../modules/alucarrier/ajax.php",data:{action:"getpriceportes",product_id:product_id,widthValue:widthValue,ndkgroupid:ndkgroupid},success:function(t){"false"!=(objport=JSON.parse(t)).status&&($(".prazoentrega").html(objport.text_price),"true"==objport.free_shipping||"true"==objport.half_free_shipping)&&$("#portivaaumento").val(parseInt(objport.price))}})}),$(".img-value").click(function(){product_id=$("#product_page_product_id").val(),widthValue=$(this).data("value"),ndkgroupid=$(this).data("group"),$.ajax({type:"POST",url:"../modules/alucarrier/ajax.php",data:{action:"getpriceportes",product_id:product_id,widthValue:widthValue,ndkgroupid:ndkgroupid},success:function(t){"false"!=(objport=JSON.parse(t)).status&&($(".prazoentrega").html(objport.text_price),"true"==objport.free_shipping||"true"==objport.half_free_shipping)&&$("#portivaaumento").val(parseInt(objport.price))}})}),$(".img-value-4578").click(function(){portao=$(this).attr("data-id-value");$(".img-value-4587[data-id-value='"+{27035:27059,27036:27060}[portao]+"']").trigger("click"),$(".img-value-4588[data-id-value='"+{27035:27061,27036:27062}[portao]+"']").trigger("click")}),$("select.dimension_text_width").change(function(t){dataid=$(this).attr("data-group"),"undefined"!=typeof(selectheight=$("#dimension_text_height_"+dataid).attr("data-selected"))&&$(".form-group[data-field='"+dataid+"']").removeClass("focusRequired").find(".error").remove()}),$("select.dimension_text_height").change(function(t){dataid=$(this).attr("data-group"),"undefined"!=typeof(selectwidth=$("#dimension_text_width_"+dataid).attr("data-selected"))&&$(".form-group[data-field='"+dataid+"']").removeClass("focusRequired").find(".error").remove()});