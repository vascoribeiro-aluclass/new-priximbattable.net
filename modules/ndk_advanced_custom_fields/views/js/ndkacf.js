var groupAdded=[],customizationId=0,mesures=[],defaultMesures=[],preloadImg=[],filtersTags=[],maxQttyAvailable=[],htmlOutput=[],customizationPrice=0,initialValues=[],scrollbarWidth=0,checked=!1,allFonts=[],doneTypingInterval=1e3,alreadyModify=!1,compoImages=[],selectedIdValue=[],ndkBrowserVersion=ndkDetectIE();function ndkDetectIE(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");return 0<t?parseInt(e.substring(t+5,e.indexOf(".",t)),10):0<e.indexOf("Trident/")?(t=e.indexOf("rv:"),parseInt(e.substring(t+3,e.indexOf(".",t)),10)):0<(t=e.indexOf("Edge/"))&&parseInt(e.substring(t+5,e.indexOf(".",t)),10)}function formatCurrencyNdk(e){return"function"==typeof formatCurrencyNdk_Override?formatCurrencyNdk_Override(e):1.6<ps_version?formatCurrency17(parseFloat(e),currencyFormat17,currencySign,1):formatCurrency(parseFloat(e),currencyFormat,currencySign,currencyBlank)}function formatCurrencyNdkCallback(e,t,i,a){if("function"==typeof formatCurrencyNdkCallback_Override)return formatCurrencyNdkCallback_Override(e,t,i,a);i=i||"",a=a||"",1.6<ps_version?$(t).html(i+formatCurrency17(parseFloat(e),currencyFormat17,currencySign,1)+a):$(t).html(i+formatCurrency(parseFloat(e),currencyFormat,currencySign,currencyBlank)+a)}function getIdCombinationNdk(){if("function"==typeof getIdCombinationNdk_Override)return getIdCombinationNdk_Override();setTimeout(function(){$("#add-to-cart-or-refresh");myDatas=$(".product-variants").find("input, select, textarea").serialize(),$.ajax({type:"GET",url:baseUrl+"modules/ndk_advanced_custom_fields/front_ajax.php?action=getCombination&id_product="+$("#ndkcf_id_product").val(),data:myDatas,dataType:"json",success:function(e){if(null!=e){if($("#ndkcf_id_combination, #idCombination").val(e.id_product_attribute),0==$(".view_tab.activeView").length&&$("#bigpic").attr("src",e.images[0]),1<e.images.length){thumbs="";for(var t=0;t<e.images.length;t++)thumbs+='<li class="thumb-container"><img class="thumb js-thumb" data-image-medium-src="'+e.images[t]+'" data-image-large-src="'+e.images[t]+'" src="'+e.images[t]+'" itemprop="image"></li>';$("ul.product-images").html(thumbs),$("ul.product-images").html(thumbs),"function"==typeof coverImage&&(coverImage(),imageScrollBox())}var i;1.6<ps_version&&void 0!==(i=$("#product-details").data("product"))&&(ndkcfAttrStock=e.stock,parseFloat(e.stock)<1&&0==i.allow_oosp?($(".ndkcsfields-block").fadeOut(600),$("#product-availability").fadeIn()):($(".ndkcsfields-block").fadeIn(600),$("#product-availability").fadeOut())),formatCurrencyNdkCallback(e.price,".current-price span")}else $("#ndkcf_id_combination").val(0);$("#quantity_wanted").trigger("change")}})},2e3)}function imageScrollBox(){2<$("#main .js-qv-product-images li").length?($("#main .js-qv-mask").addClass("scroll"),$(".scroll-box-arrows").addClass("scroll"),$("#main .js-qv-mask").scrollbox({direction:"h",distance:113,autoPlay:!1}),$(".scroll-box-arrows .left").click(function(){$("#main .js-qv-mask").trigger("backward")}),$(".scroll-box-arrows .right").click(function(){$("#main .js-qv-mask").trigger("forward")})):($("#main .js-qv-mask").removeClass("scroll"),$(".scroll-box-arrows").removeClass("scroll"))}function coverImage(){$.prototype.bxSlider&&($(".product-cover .layer").addClass("hideImportant"),$(".js-qv-product-images").unwrap().unwrap().parent().find(".bx-controls").remove(),$.prototype.bxSlider)&&$(".js-qv-product-images").bxSlider({responsive:!0,useCSS:!1,pager:!1,slideWidth:150,slideMargin:4})}$(document).ready(function(){$(window).keydown(function(e){if(13==e.keyCode)return e.preventDefault(),!1})}),conf_img_url=$("#bigpic").attr("data-original-image"),"undefined"==typeof contentOnly&&(contentOnly=!1),$.jMaskGlobals={maskElements:"input,td,span,div",dataMaskAttr:"*[data-mask]",dataMask:!0,watchInterval:300,watchInputs:!0,watchDataMask:!1,byPassKeys:[9,16,17,18,36,37,38,39,40,91],translation:{0:{pattern:/\d/},9:{pattern:/\d/,optional:!0},"#":{pattern:/\d/,recursive:!0},A:{pattern:/[a-zA-Z0-9]/},M:{pattern:/[A-Z0-9]/},S:{pattern:/[a-zA-Z]/},s:{pattern:/[a-z]/,optional:!0},a:{pattern:/[a-zà-ÿ'-]/,recursive:!0}}},$(document).on("click",".ndkcfLoaded .js-thumb",function(e){$(".js-thumb.selected").removeClass("selected"),view_img=0<$(".view_tab.activeView").length?(img=$(e.currentTarget).data("image-large-src"),$(".view_tab.activeView").attr("data-img")):img=$(e.currentTarget).data("image-large-src"),$(e.target).addClass("selected"),$(".js-qv-product-cover").attr("src",view_img),$(".js-modal-product-cover").attr("src",img),$("[data-target='#product-modal']").trigger("click")}),$(document).on("change, click",".ndkcfLoaded .product-variants input",function(){$.when(getIdCombinationNdk()).done(function(){setTimeout(function(){initPriceVars()},800)})}),$(document).on("change",".ndkcfLoaded .product-variants select",function(){$.when(getIdCombinationNdk()).done(function(){setTimeout(function(){initPriceVars()},800)})});var fonts,colors,typingTimer,default_colors=["AliceBlue","AntiqueWhite","Aqua","Aquamarine","Azure","Beige","Bisque","Black","BlanchedAlmond","Blue","BlueViolet","Brown","BurlyWood","CadetBlue","Chartreuse","Chocolate","Coral","CornflowerBlue","Cornsilk","Crimson","Cyan","DarkBlue","DarkCyan","DarkGoldenRod","DarkGray","DarkGrey","DarkGreen","DarkKhaki","DarkMagenta","DarkOliveGreen","Darkorange","DarkOrchid","DarkRed","DarkSalmon","DarkSeaGreen","DarkSlateBlue","DarkSlateGray","DarkSlateGrey","DarkTurquoise","DarkViolet","DeepPink","DeepSkyBlue","DimGray","DimGrey","DodgerBlue","FireBrick","FloralWhite","ForestGreen","Fuchsia","Gainsboro","GhostWhite","Gold","GoldenRod","Gray","Grey","Green","GreenYellow","HoneyDew","HotPink","IndianRed","Indigo","Ivory","Khaki","Lavender","LavenderBlush","LawnGreen","LemonChiffon","LightBlue","LightCoral","LightCyan","LightGoldenRodYellow","LightGray","LightGrey","LightGreen","LightPink","LightSalmon","LightSeaGreen","LightSkyBlue","LightSlateGray","LightSlateGrey","LightSteelBlue","LightYellow","Lime","LimeGreen","Linen","Magenta","Maroon","MediumAquaMarine","MediumBlue","MediumOrchid","MediumPurple","MediumSeaGreen","MediumSlateBlue","MediumSpringGreen","MediumTurquoise","MediumVioletRed","MidnightBlue","MintCream","MistyRose","Moccasin","NavajoWhite","Navy","OldLace","Olive","OliveDrab","Orange","OrangeRed","Orchid","PaleGoldenRod","PaleGreen","PaleTurquoise","PaleVioletRed","PapayaWhip","PeachPuff","Peru","Pink","Plum","PowderBlue","Purple","Red","RosyBrown","RoyalBlue","SaddleBrown","Salmon","SandyBrown","SeaGreen","SeaShell","Sienna","Silver","SkyBlue","SlateBlue","SlateGray","SlateGrey","Snow","SpringGreen","SteelBlue","Tan","Teal","Thistle","Tomato","Turquoise","Violet","Wheat","White","WhiteSmoke","Yellow","YellowGreen"],default_fonts=["Arial,Arial,Helvetica,sans-serif","Arial Black,Arial Black,Gadget,sans-serif","Comic Sans MS,Comic Sans MS,cursive","Courier New,Courier New,Courier,monospace","Georgia,Georgia,serif","Impact,Charcoal,sans-serif","Times New Roman,Times,serif","Indie Flower","Lobster","Chewy","Alpha Slab One","Rock Salt","Comfortaa","Audiowide","Yellowtail","Black Ops One","Frijole","Press Star 2p","Kranky","Meddon","Love Ya Like A Sister","Bree Serif, serif"];function updatePriceNdk(e,t){if("function"==typeof updatePriceNdk_Override)return updatePriceNdk_Override(e,t);if($("#price_"+t).val(e).trigger("keyup"),customizationPrice=0,isNaN(e)&&(e=0),!isNaN(e)&&void 0!==e&&void 0!==t&&"undefined"!=t){groupAdded[t]=parseFloat(e);var i,a=!1,r=[5426,5417,5424,5425,5439,5440,5441,5442,5443,5444,5445,5446,5447,5448,5449,5450,5452,5453,5454,5455,5456,5457,5458,5459,5460,5462,5463,5465,5466,5467,5472,5473,5518,5522,5523,5524,5546];for(i in groupAdded){var o=i.split("-"),a=-1!==$.inArray(parseInt(o[0]),r);void 0!==groupAdded[i]&&"percent"!=(price_type=$("#price_type_"+i).attr("data-price-type"))&&0<parseFloat(groupAdded[i])&&(customizationPrice="one_time"==price_type?parseFloat(customizationPrice)+parseFloat(groupAdded[i])/$("#quantity_wanted").val():parseFloat(customizationPrice)+parseFloat(a?groupAdded[i]:groupAdded[i]-groupAdded[i]*valorReducao))}var n=$(".current_price_aluclass").attr("content");for(i in groupAdded)void 0!==groupAdded[i]&&"undefined"!=typeof(price_type=$("#price_type_"+i).attr("data-price-type"))&&"percent"==price_type&&(multiplicator=groupAdded[i]/100,totalPrice=parseFloat(+n)/(1-valorReducao),toAdd=totalPrice*multiplicator,0<parseFloat(toAdd))&&(customizationPrice=parseFloat(customizationPrice)+toAdd);new_price=parseFloat(+productPrice)+parseFloat(+customizationPrice),$(".additionnal_price").remove(),id_product3=$("#ndkcf_id_product").val(),4511==parseFloat(id_product3)&&(t=$(".current_price_aluclass").attr("content"),customizationPrice-=parseFloat(t));e=$("#portivaaumento").val();reductionpercentprice=$("#reductionpercentprice").val(),reductionpercent=$("#reductionpercent").val(),reductionpercentname=$("#reductionpercentname").val(),e=parseFloat(e)-parseFloat(e)*valorReducao,e=parseFloat(e)-parseFloat(reductionpercent)/100*parseFloat(e),customizationPriceReducao=parseFloat(customizationPrice),serviceiva10&&(customizationPriceReducao=customizationPriceReducao/1.2*1.1),0<customizationPrice&&0<parseInt(reductionpercentprice)?(reductioncustomizationPrice=parseFloat(customizationPrice),reductioncustomizationPrice=parseFloat(reductioncustomizationPrice)-parseFloat(reductionpercent)/100*parseFloat(reductioncustomizationPrice),reductionpercentprice=parseFloat(reductionpercentprice)+parseFloat(e)+parseFloat(reductioncustomizationPrice),$(".productPriceUpHT, #our_price_display:visible").before('<span id="additionnal_price" data-price="'+customizationPrice+'" class="product-price price additionnal_price ">'+formatCurrencyNdk(customizationPrice)+"hehe</span>"),formatCurrencyNdkCallback(customizationPriceReducao,".additionnal_price","( "+additionnalText," ) <br><br> Avec code "+reductionpercentname+" : "+formatNumber(reductionpercentprice,2,",",".")+" € Code limité à 1 jour")):0==customizationPrice&&0<parseInt(reductionpercentprice)?(reductionpercentprice=parseFloat(reductionpercentprice)+parseFloat(e),$(".productPriceUpHT, #our_price_display:visible").before('<span id="additionnal_price" data-price="'+customizationPrice+'" class="product-price price additionnal_price ">'+formatCurrencyNdk(customizationPrice)+"hehe</span>"),formatCurrencyNdkCallback(reductionpercentprice,".additionnal_price"," Avec code "+reductionpercentname+" : ","<br> Code limité à 1 jour")):(0<customizationPrice&&0==parseInt(reductionpercentprice)&&$(".productPriceUpHT, #our_price_display:visible").before('<span id="additionnal_price" data-price="'+customizationPrice+'" class="product-price price additionnal_price ">'+formatCurrencyNdk(customizationPrice)+"hehe</span>"),formatCurrencyNdkCallback(customizationPriceReducao,".additionnal_price","( "+additionnalText," ) ")),1==templateType&&($("#timeline").trigger("mouseover"),setTimeout(function(){$("#timeline").trigger("mouseout")},5e3))}update_price_dynamic(0)}function updatePriceNdkGeneric(e,t){if("function"==typeof updatePriceNdkGeneric_Override)return updatePriceNdkGeneric_Override(e,t);customizationPrice=0;var i,a=$.trim($("#our_price_display").text().replace(currencySign,"").replace(",",".").replace(/\ /g,"").replace("-",""));for(i in groupAdded)void 0!==groupAdded[i]&&0<parseFloat(groupAdded[i])&&"percent"!=(price_type=$("#price_type_"+i).attr("data-price-type"))&&(customizationPrice=parseFloat(customizationPrice)+parseFloat(groupAdded[i]));for(i in groupAdded)void 0!==groupAdded[i]&&"undefined"!=typeof(price_type=$("#price_type_"+i).attr("data-price-type"))&&"percent"==price_type&&(multiplicator=groupAdded[i]/100,totalPrice=parseFloat(+a)-(parseFloat(+a)-$("#priceSimulation").val())+parseFloat(+customizationPrice),toAdd=totalPrice*multiplicator,0<parseFloat(toAdd))&&(customizationPrice=parseFloat(customizationPrice)+toAdd);new_price=parseFloat(+a)+parseFloat(+customizationPrice),$(".additionnal_price").remove(),0<customizationPrice&&$(".productPriceUpHT, #our_price_display:visible").before('<span id="additionnal_price" data-price="'+customizationPrice+'" class="product-price price additionnal_price">'+formatCurrencyNdk(customizationPrice)+"</span>"),formatCurrencyNdkCallback(customizationPrice,".additionnal_price","( "+additionnalText," )"),1==templateType&&($("#timeline").trigger("mouseover"),setTimeout(function(){$("#timeline").trigger("mouseout")},5e3))}function svg_textMultiline(e,t,i,a,r,o){var n=1,d=(e=document.getElementById(e),t.split(" ")),s="";e.innerHTML='<tspan style="font-size='+a+'px;" '+r+' id="PROCESSING">busy</tspan >';for(var l=0;l<d.length;l++){var c=s+d[l]+" ",p=document.getElementById("PROCESSING"),p=(p.innerHTML=c,p.getBoundingClientRect());testWidth=p.width,testWidth+=30,"±"==d[l]?(e.innerHTML+='<tspan style="font-size='+a+'px;" '+r+' x="'+o+'" y="'+a*n+'">'+s.escape()+"</tspan>",s=" ",n++):testWidth>i&&0<l?(e.innerHTML+='<tspan style="font-size='+a+'px;" '+r+' x="'+o+'" y="'+a*n+'">'+s.escape()+"</tspan>",s=d[l]+" ",n++):s=c}e.innerHTML+='<tspan style="font-size='+a+'px;" '+r+' x="'+o+'" y="'+a*n+'">'+s.escape()+"</tspan>",document.getElementById("PROCESSING").remove()}function updateQuantityForValue(e,t){if("function"==typeof updateQuantityForValue_Override)return updateQuantityForValue_Override(e,t);var i,a=999999999999999;for(i in void 0!==e&&void 0!==t&&"undefined"!=t&&("null"==e&&(e=999999999999999),maxQttyAvailable[t]=parseFloat(e)),groupAdded)void 0!==maxQttyAvailable[i]&&parseFloat(maxQttyAvailable[i])<=parseFloat(a)&&(a=parseFloat(maxQttyAvailable[i]))}function resizeZones(e){if("function"==typeof resizeZones_Override)return resizeZones_Override(e);lbkWidth=e.attr("original-width"),lbkHeight=e.attr("original-height"),newWidth=e.width(),newHeight=e.height(),e.width(newWidth/lbkWidth*100+"%"),e.height(newHeight/lbkHeight*100+"%"),newMarginL=e.css("left").replace("px",""),newMarginT=e.css("top").replace("px",""),e.css("left",newMarginL/lbkWidth*100+"%"),e.css("top",newMarginT/lbkHeight*100+"%")}function redesignPage(){if("function"==typeof redesignPage_Override)return redesignPage_Override();1.6<ps_version&&("undefined"==typeof contentOnly&&(contentOnly=!1),$("#content").parent().addClass("pb-left-column"),$(".product-price:eq(0)").parent().addClass("pb-center-column")),setTags(),$("#add_to_cart, .product-add-to-cart > *:not(.product-quantity), .add button, .add-to-cart, .product-customization").hide(),$("h1").prependTo(".pb-left-column"),$("#short_description_block").appendTo(".pb-left-column"),$(".pb-left-column").removeClass("col-md-5").addClass("col-md-7"),$(".pb-center-column").removeClass("col-sm-4").addClass("col-sm-5"),$(".pb-right-column").removeClass("col-sm-4").removeClass("col-md-3").removeClass("col-xs-12").appendTo(".pb-left-column").addClass("clearfix").wrap('<div id="timeline" class="floatingBarre"></div>'),"undefined"!=typeof isFieldsPack&&1==isFieldsPack?$(".replace-img-block").each(function(){(viewsTabs=$(this).clone()).find(".view_tab").length<2&&viewsTabs.hide(),$(this).parent().prepend(viewsTabs),$(this).remove()}):(viewsTabs=$(".replace-img-block").clone().addClass("clonedTabs"),$(".replace-img-block").remove(),viewsTabs.find(".view_tab").length<2&&viewsTabs.hide(),$("#image-block").before(viewsTabs)),$("#image-block").attr("data-view",0),setTimeout(function(){$(".view_tab:first").trigger("click")},500),767<$(window).width()&&($(".pb-right-column").addClass("clearfix"),$(".box-info-product > div").removeClass("clearfix").addClass("col-md-4 col-sm-3 col-xs-6")),0<$(".ndkmask").length&&$(".ndkmask").each(function(){zindex=0<$(this).attr("data-zindex")?$(this).attr("data-zindex"):"99",$("#image-block").append('<img style="z-index:'+zindex+';" src="'+$(this).attr("data-src")+'" id="view-'+$(this).attr("data-view")+'" class="absolute-visu absolute-mask view-'+$(this).attr("data-view")+'"/>'),$("#image-block").find(":not(img, #view_full_size, #product-zoom, .fontSelect, canvas, .ui-rotatable-handle, .zone_limit)").hide()}),0<$(".zone_limit").length&&$(".zone_limit").each(function(){resizeZones($(this)),cloned=$(this).clone(),$("#image-block").append(cloned),$(this).remove()}),$(".colorize_svg").each(function(){myGroup=$(this).attr("data-group"),myUl=$(this),myColors=0<window["fieldColors_"+myGroup].length?window["fieldColors_"+myGroup]:colors;for(var e=0;e<myColors.length;e++)$("<li "+(0==e?'class="initial_color"':"")+'><span data-color="'+myColors[e]+'" style="background:'+myColors[e]+';">'+myColors[e]+"</span></li>").appendTo(myUl)}),setTimeout(function(){$(".initial_color").trigger("click")},500),$(".ndk_selector").each(function(){$(this).setNdkSelector()}),$("#submitNdkcsfields, .submitNdkcsfields").attr("disabled",!1),$(".tagify").tagify({delimiters:[13,188,44],addTagPrompt:tagslabel}),$(document).on("mouseover","#views_block li a",function(e){e.preventDefault()});var e=new HoverWatcher("#timeline");$("#timeline").prepend("<h3>"+timelineText+"</h3>"),setTimeout(function(){$(".pb-right-column").hide("slow")},4e3),$("#timeline").hover(function(){$(".pb-right-column").stop(!0,!0).show(450),$(this).removeClass("active")},function(){setTimeout(function(){e.isHoveringOver()||$(".pb-right-column").stop(!0,!0).hide(450),$(this).addClass("active")},200)}),$("#image-block").after('<div id="layer-block" class="clearfix clear"></div>'),"undefined"!=typeof is_visual&&1==is_visual&&($("#views_block .shown").removeClass("shown"),$(document).on("mouseover","#views_block li a",function(e){e.preventDefault(),$(".view_tab.activeView").trigger("click"),$("#views_block .shown").removeClass("shown")}))}function HoverWatcher(e){if("function"==typeof HoverWatcher_Override)return HoverWatcher_Override(e);this.hovering=!1;var t=this;this.isHoveringOver=function(){return t.hovering},$(e).hover(function(){t.hovering=!0},function(){t.hovering=!1})}function restoreDesign(){if("function"==typeof restoreDesign_Override)return restoreDesign_Override();null!=(savedDesign=localStorage.getItem("customNdk_"+$("#ndkcsfields-block").attr("data-key")))&&"undefined"!=typeof savedDesign&&""!=savedDesign&&setTimeout(function(){$("#image-block").html(savedDesign),$(".ui-draggable").draggable().rotatable({wheelRotate:!1}),$(".ui-resizable > img").resizable()},3e3)}function restoreForm(){if("function"==typeof restoreForm_Override)return restoreForm_Override();null!=(savedForm=localStorage.getItem("customNdkForm_"+$("#ndkcsfields-block").attr("data-key")))&&"undefined"!=typeof savedForm&&""!=savedForm&&setTimeout(function(){$("#ndkcsfields-block").html(savedForm)},3e3)}function redesignPageLight(){if("function"==typeof redesignPageLight_Override)return redesignPageLight_Override();$("#add_to_cart, product-add-to-cart > *:not(.product-quantity), .add button, .add-to-cart, .product-customization").hide(),"undefined"!=typeof isFieldsPack&&1==isFieldsPack?$(".replace-img-block").each(function(){(viewsTabs=$(this).clone()).find(".view_tab").length<2&&viewsTabs.hide(),$(this).parent().prepend(viewsTabs),$(this).remove()}):((viewsTabs=$(".replace-img-block").clone().addClass("clonedTabs")).find(".view_tab").length<2&&viewsTabs.hide(),$(".replace-img-block").remove(),$("#image-block").before(viewsTabs)),$("#image-block").attr("data-view",0),0<$(".ndkmask").length&&$(".ndkmask").each(function(){zindex=0<$(this).attr("data-zindex")?$(this).attr("data-zindex"):"99",$("#image-block").append('<img style="z-index:'+zindex+';" src="'+$(this).attr("data-src")+'" id="view-'+$(this).attr("data-view")+'" class="absolute-visu absolute-mask view-'+$(this).attr("data-view")+'"/>'),$("#image-block").find(":not(img, #view_full_size, #product-zoom, .fontSelect, canvas, .ui-rotatable-handle, .zone_limit)").hide(),$("#image-block").find(":not(img, #view_full_size, #product-zoom, .fontSelect, canvas, .ui-rotatable-handle, .zone_limit)").hide()}),0<$(".zone_limit").length&&$(".zone_limit").each(function(){resizeZones($(this)),cloned=$(this).clone(),$("#image-block").append(cloned),$(this).remove()}),setTags(),$(".colorize_svg").each(function(){myGroup=$(this).attr("data-group"),myUl=$(this),myColors=0<window["fieldColors_"+myGroup].length?window["fieldColors_"+myGroup]:colors;for(var e=0;e<myColors.length;e++)$("<li "+(0==e?'class="initial_color"':"")+'><span data-color="'+myColors[e]+'" style="background:'+myColors[e]+';">'+myColors[e]+"</span></li>").appendTo(myUl)}),$(".ndk_selector").each(function(){$(this).setNdkSelector()}),$("#submitNdkcsfields, .submitNdkcsfields").attr("disabled",!1),$(".tagify").tagify({delimiters:[13,188,44],addTagPrompt:tagslabel}),"undefined"!=typeof is_visual&&1==is_visual&&($("#views_block .shown").removeClass("shown"),$(document).on("mouseover","#views_block li a",function(e){e.preventDefault(),$(".view_tab.activeView").trigger("click"),$("#views_block .shown").removeClass("shown")})),$("#image-block").after('<div id="layer-block" class="clearfix clear"></div>')}function redesignPageLight_bak(){$("#add_to_cart, .product-add-to-cart, .add, .add-to-cart").hide(),0<$(".ndkmask").length&&($("#image-block").append('<img src="'+$(".ndkmask").attr("data-src")+'" class="absolute-visu absolute-mask view-'+$(".ndkmask").attr("data-view")+'"/>'),$("#image-block").find(":not(img, #view_full_size,  #product-zoom, .fontSelect, canvas, .ui-rotatable-handle)").hide()),0<$(".zone_limit").length&&$(".zone_limit").each(function(){setTimeout(function(){resizeZones($(this)),cloned=$(this).clone(),$("#image-block").append(cloned),$(this).remove()},1e3)}),viewsTabs=$(".replace-img-block").clone(),$(".replace-img-block").remove(),$("#image-block").before(viewsTabs),$("#image-block").attr("data-view",0),setTimeout(function(){$(".clonedTabs .view_tab:first").trigger("click")},500)}function setImgValue(e,t){if("function"==typeof setImgValue_Override)return setImgValue_Override(e,t);$("#ndkcsfield_"+t).val(e.attr("data-value")).trigger("keyup"),$(e).parent().parent().find(".selected-value").removeClass("selected-value"),$(e).parent().parent().parent().find(".svg-container").removeClass("selected-svg"),$(".img-value-"+t).removeClass("selected-value"),$(e).addClass("selected-value"),e.parent().hasClass("svg-container")&&e.parent().addClass("selected-svg"),checkFieldRestrictions(e.attr("data-id-value"),e.attr("data-group"))}function setEditable(e,t,i,a,r,o,n){if("function"==typeof setEditable_Override)return setEditable_Override(e,t,i,a,r,o,n);i="",1==o?(group=$(e).attr("data-group").split("-"),$(e).resizable({aspectRatio:!0,containment:i,autoHide:!0,handles:"se",start:function(){!$(this).hasClass("activeZone")&&group&&$(".form-group[data-field='"+group[0]+"']").trigger("click"),$("#image-block").addClass("editing")},stop:function(){setTimeout(function(){$(".resetZones").trigger("click"),convertPercent()},2850),$(".editing").removeClass("editing")}}),$(e).removeClass("notResizeable")):($(e).resizable({aspectRatio:!0,containment:i,autoHide:!0,maxHeight:$(e).parent().height(),maxWidth:$(e).parent().width(),minHeight:$(e).parent().height(),minWidth:$(e).parent().width(),handles:"se",create:function(e,t){$(".ui-icon-gripsmall-diagonal-se").remove()},stop:function(){setTimeout(function(){$(".resetZones").trigger("click"),convertPercent()},2850)}}),$(e).addClass("notResizeable")),rotDragEl=$(e),$(e).attr("data-dragdrop",r).attr("data-rotateable",n).attr("data-resizeable",o),$(e).css("z-index",t).attr("data-zindex",t),group=rotDragEl.attr("data-group").split("-"),1==r&&rotDragEl.draggable({containment:i,start:function(){!$(this).hasClass("activeZone")&&group&&$(".form-group[data-field='"+group[0]+"']").trigger("click"),$("#image-block").addClass("editing")},stop:function(){setTimeout(function(){$(".resetZones").trigger("click"),convertPercent()},2850),$(".editing").removeClass("editing"),$(e).css("z-index",t)},zIndex:t}),1==n&&rotDragEl.rotatable({wheelRotate:!1,start:function(){!$(this).hasClass("activeZone")&&group&&$(".form-group[data-field='"+group[0]+"']").trigger("click"),$("#image-block").addClass("editing")},stop:function(){setTimeout(function(){$(".resetZones").trigger("click")},2850),$(".editing").removeClass("editing"),$(e).css("z-index",t)}}).css("z-index",t).addClass("rotatable"),$(e).parent().find(".layer_view").length<1&&$("#layer-block").append(a),checkLayerChanges(),$("#image-block").find(".fontSelect >*, canvas > *").show(),$("#image-block").find(".ui-wrapper").show().css("position","absolute")}function dragToPercent(e){if("function"==typeof dragToPercent_Override)return dragToPercent_Override(e);e.position();var t=e.parent().height(),i=e.parent().width(),a=parseFloat(e.css("top").replace("px","")),r=parseFloat(e.css("left").replace("px",""));e.css("top",a/t*100+"%").css("left",r/i*100+"%").css("width",e.width()/i*100+"%").css("height",e.height()/t*100+"%").addClass("percented")}function dragToPercentBak(e){if("function"==typeof dragToPercentBak_Override)return dragToPercentBak_Override(e);var t,i,a;e.hasClass("percented")||(t=100*parseFloat(e.css("left"))/parseFloat(e.parent().css("width"))+"%",i=100*parseFloat(e.css("top"))/parseFloat(e.parent().css("height"))+"%",a=100*parseFloat(e.css("width"))/parseFloat(e.parent().css("width"))+"%",e.css("left",t),e.css("top",i),e.css("width",a),e.css("height","auto"),e.addClass("percented"))}function designCompo(t,i,e,a,r,o,n,d,s,l,c,p){if("function"==typeof designCompo_Override)return designCompo_Override(t,i,e,a,r,o,n,d,s,l,c,p);if(c=c||"normal",p=p||"",specifiView=!0,isItem=!1,number=0,itemGroup=0,-1<i.indexOf("-")&&(isItem=!0,number=i.split("-")[1],itemGroup=i.split("-")[0]),originalWidth=d+"px",0<$(".zone_limit[data-group='"+(0<itemGroup?itemGroup:i)+"']").length&&0<$(".view_tab[data-view='"+e+"']").length?(container=".zone_limit[data-group='"+(0<itemGroup?itemGroup:i)+"']",containment="parent",maxwidth=$(".zone_limit[data-group='"+(0<itemGroup?itemGroup:i)+"']").width()+"px",maxheight=$(".zone_limit[data-group='"+(0<itemGroup?itemGroup:i)+"']").height()+"px",s="auto",maxwidth="100%",maxheight="100%",$(".zone_limit[data-group='"+(0<itemGroup?itemGroup:i)+"']").css("mix-blend-mode",c)):(container="#image-block",containment="",maxwidth="100%",maxheight="100%",s="auto"),0<o&&(maxwidth="5000px",maxheight="5000px"),$(container).css("z-index",a),editIndex="",editButton="<span "+editIndex+' class="editIt"></span>',0!=$("#image-block[data-view='"+e+"']").length&&0!=e||(specifiView=!1),$("#image-block").attr("data-view")==e||0==e||!specifiView){if(void 0!==t)if(0<$("#image-block .group-"+i).length)"canvas"==l||"text"==l||"svg"==l?$("#image-block .group-"+i+" .composition_element").replaceWith(t):"colorize"==l?($("#image-block .group-"+i+" svg").remove(),$("#image-block .group-"+i+" object").remove(),ndkImagetoDataURLForSvg(p,function(e){png2svg(e,t,p,i)})):$("#image-block .group-"+i+" .composition_element").replaceWith('<img class="composition_element img-reponsive" src="'+t+'"/>'),$("#image-block .group-"+i).fadeIn("slow"),1!=r&&1!=o&&1!=n||(layerOptions="","canvas"==l||"text"==l?layerOptions+='<span id="layer-edit-'+i+'" data-view="'+e+'" data-group="'+i+'" class="editThisLayer">'+t+"</span>":"svg"==l?(output="object"==typeof t?t.prop("outerHTML"):t,layerOptions+='<span id="layer-edit-'+i+'" data-view="'+e+'" data-group="'+i+'" class="editThisLayer">'+output+"</span>"):layerOptions+='<span id="layer-edit-'+i+'" data-view="'+e+'" data-group="'+i+'" class="editThisLayer"><img class="img-responsive very-small-img" src="'+t+'"/></span>',0<$("#layer-edit-"+i).length?($("#layer-edit-"+i).replaceWith(layerOptions),layerOptions=""):$("#layer-block").append(layerOptions).show()),$("#image-block .group-"+i).css("mix-blend-mode",c);else{if(viewClass=" ",-1<e.indexOf("|")){views=e.split("|");for(var u=0;u<views.length;u++)viewClass+=" view-"+views[u]}$("#image-block .group-"+i).remove(),"canvas"==l?($(container).append('<div data-group="'+i+'" data-zindex="'+a+'" id="visual_'+i+'" style="margin:none;width:auto; height:'+s+"; max-width:"+maxwidth+"; max-height:"+maxheight+"; z-index:"+a+"; mix-blend-mode:"+c+'" class="'+(1==r?"dragdrop":"")+" absolute-visu group-"+i+" view-"+e+viewClass+'"></div>'),$("#visual_"+i).html(t+editButton)):"svg"==l?($(container).append('<div data-group="'+i+'" data-zindex="'+a+'" id="visual_'+i+'" style="margin:none; height:'+s+"; max-width:"+maxwidth+"; max-height:"+maxheight+"; z-index:"+a+";mix-blend-mode:"+c+'" class="'+(1==r?"dragdrop":"")+" absolute-visu group-"+i+" view-"+e+viewClass+' absolute-svg-text"><div class="composition_element"></div>'+editButton+"</div>"),$("#image-block .group-"+i+" .composition_element").replaceWith(t)):"text"==l?$(container).append('<div data-group="'+i+'" data-zindex="'+a+'" id="visual_'+i+'" style="margin:none;width:'+originalWidth+"; height:"+s+"; max-width:"+maxwidth+"; max-height:"+maxheight+"; z-index:"+a+"; mix-blend-mode:"+c+'" class="'+(1==r?"dragdrop":"")+" absolute-visu group-"+i+" view-"+e+viewClass+'">'+t+editButton+"</div>"):"colorize_bak"==l?ndkBrowserVersion?$(container).append('<div data-group="'+i+'" data-zindex="'+a+'" id="visual_'+i+'" style="height:'+s+"; max-width:"+maxwidth+"; max-height:"+maxheight+"; z-index:"+a+" ;mix-blend-mode:"+c+';" class="'+(1==r?"dragdrop":"")+" absolute-visu group-"+i+" view-"+e+viewClass+" absolute-img "+("color"==l?"multiply-mode-color":"")+'"><div  style="" class=""><img class=" composition_element img-reponsive " src="'+t+'"/></div>'+editButton+"</div>"):$(container).append('<div data-group="'+i+'" data-zindex="'+a+'" id="visual_'+i+'" style="height:'+s+"; max-width:"+maxwidth+"; max-height:"+maxheight+"; z-index:"+a+" ;mix-blend-mode:"+c+';" class="'+(1==r?"dragdrop":"")+" absolute-visu group-"+i+" view-"+e+viewClass+" absolute-img "+("color"==l?"multiply-mode-color":"")+'"><div  style="background:'+p+"; mask-image: url('"+t+"');-webkit-mask-image: url('"+t+'\');" class="colorize-cover-item"><img class=" composition_element img-reponsive " src="'+t+'"/></div>'+editButton+"</div>"):"colorize"==l?($(container).append('<div data-group="'+i+'" data-zindex="'+a+'" id="visual_'+i+'" style="height:'+s+"; max-width:"+maxwidth+"; max-height:"+maxheight+"; z-index:"+a+" ;mix-blend-mode:"+c+';" class="'+(1==r?"dragdrop":"")+" absolute-visu group-"+i+" view-"+e+viewClass+" absolute-img "+("color"==l?"multiply-mode-color":"")+'">'+editButton+"</div>"),ndkImagetoDataURLForSvg(p,function(e){png2svg(e,t,p,i)})):$(container).append('<div data-group="'+i+'" data-zindex="'+a+'" id="visual_'+i+'" style="margin:none;width:auto; height:'+s+"; max-width:"+maxwidth+"; max-height:"+maxheight+"; z-index:"+a+" ;mix-blend-mode:"+c+';" class="'+(1==r?"dragdrop":"")+" absolute-visu group-"+i+" view-"+e+viewClass+" absolute-img "+("color"==l?"multiply-mode-color":"")+'"><img class=" composition_element img-reponsive" src="'+t+'"/>'+editButton+"</div>"),1!=r&&1!=o&&1!=n||(layerOptions="","canvas"==l||"text"==l?layerOptions+='<span id="layer-edit-'+i+'" data-view="'+e+'" data-group="'+i+'" class="editThisLayer">'+t+"</span>":"svg"==l?(output="object"==typeof t?t.prop("outerHTML"):t,layerOptions+='<span id="layer-edit-'+i+'" data-view="'+e+'" data-group="'+i+'" class="editThisLayer">'+output+"</span>"):layerOptions+='<span id="layer-edit-'+i+'" data-view="'+e+'" data-group="'+i+'" class="editThisLayer"><img class="img-responsive very-small-img" src="'+t+'"/></span>',setEditable("canvas"==l?"#visual_"+i+" > canvas":"#visual_"+i,a,containment,layerOptions,r,o,n))}scrollToNdk($(container),800)}setTimeout(function(){$(".orientation_selection[data-group-target='"+i+"']").find(".active_orientation").trigger("click")},800)}function createPreview(e){if("function"==typeof createPreview_Override)return createPreview_Override(e);var t;t=((0<customizationPrice||"undefined"!=typeof is_visual&&1==is_visual)&&(convertPercent(),$(".ndk-img-url").val("").trigger("keyup"),0<(viewTabs=$(".view_tab")).length)&&$("li.view_tab").first().trigger("click"),snapShot(!1,!1,!0)),$.when(t).done(function(){setTimeout(function(){e()},500)})}function simuViews(e,t){return"function"==typeof simuViews_Override?simuViews_Override(e):(snapShot(e=e||!1,t=t||!1),!0)}function snapShot(e,t,i){if("function"==typeof snapShot_Override)return snapShot_Override(e,t,i);var a,r;1==showImgPreview&&1==is_visual&&$("#image-block").addClass("hight_quality"),e=e||!1,t=t||!1,i=i||!1,(0<customizationPrice||"undefined"!=typeof is_visual&&1==is_visual)&&((dataView=0)==$("li.view_tab").length&&(htmlOutput[0]='<div class="print-page-breaker">'+$("#image-block").html()+"</div>"),compoImages=[],$.when((a=e,r=i,void(0<(e=t?$("li.view_tab:eq(0)"):$("li.view_tab")).length?e.each(function(){var e=(tab=$(this)).trigger("click");$.when(e).done(function(){processTabForSnapShot(parseFloat(tab.attr("data-view")),a,r)})}):processTabForSnapShot(0,a,r)))).done(function(){$(".image-url").each(function(){compoImages.push($(this).val())}),$("#image-block").removeClass("hight_quality")}))}function processTabForSnapShot(t,e,i){if("function"==typeof processTabForSnapShot_Override)return processTabForSnapShot_Override(t,e,i);0==showImgPreview&&(only_html=!0),clonedView=$("#image-block[data-view ='"+t+"']").clone(),$(clonedView).find("> :not(.view-"+t+" , .view-0, #view_full_size, #product-zoom, .ndk-svg-view, #bigpic, .tempSvg, .middle-content)").remove(),$(clonedView).find(".hiddenForSnapshot").show().removeClass(".hiddenForSnapshot"),$(clonedView).find("#image-block[data-view ='"+t+"'] svg").show(),htmlOutput[t]='<div class="print-page-breaker">'+clonedView.html()+"</div>",clonedView.remove(),e||$(this).addClass("snapshoot"),e=i?function(){return!0}:svgToCanvas($("#image-block")),$.when(e).done(function(){html2canvas($("#image-block"),{onrendered:function(e){e=e.toDataURL("image/png");$("#image-url-"+t).val(e).trigger("keyup"),$(".tempSvg").remove(),$(".hiddenForSnapshot").show().removeClass(".hiddenForSnapshot"),$("#image-block[data-view ='"+t+"']").find("svg").show(),$(".current_config_img").attr("src",e).show(),$("#image-url-0").val(e).trigger("keyup")}})})}function svgToCanvas(e){if("function"==typeof svgToCanvas_Override)return svgToCanvas_Override(e);e=e.find("svg");$(".tempSvg").remove(),e.each(function(e,t){(el=$(this)).show();var i=new Image,a=t.parentNode,t=t.outerHTML;width=el[0].getBoundingClientRect().width,height=el[0].getBoundingClientRect().height,i.src="data:image/svg+xml,"+escape(t),a.appendChild(i),$(i).addClass("tempSvg replaced-svg composition_element"),el.addClass("hiddenForSnapshot"),$(i).load(function(){var e=document.createElement("canvas"),t=(i.width=width,i.height=height,e.width=width,e.height=height,e.getContext("2d"));$.when(t.drawImage(i,0,0)).done(function(){i.src=e.toDataURL()})}),el.hide()})}function snapShotFirst(){if("function"==typeof snapShotFirst_Override)return snapShotFirst_Override();html2canvas($("#image-block"),{onrendered:function(e){e=e.toDataURL("image/png");$("#image-url-0").val(e).trigger("keyup"),$(".ndkzoom").attr("href",e)}})}void 0!==fonts&&0!=fonts.length||(fonts=default_fonts),void 0!==colors&&0!=colors.length||(colors=default_colors);doneTypingInterval=1e3;function snapShotLight(){if("function"==typeof snapShotLight_Override)return snapShotLight_Override();(0<customizationPrice||"undefined"!=typeof is_visual&&1==is_visual)&&($(".ndkzoom").attr("disabled","disabled").addClass("loadingButton"),dataView=0,dataView=$("#image-block").attr("data-view"),(dataView=0).length&&0!=dataView.length||(dataView=0),html2canvas($("#image-block"),{onrendered:function(e){e=e.toDataURL("image/png");$("#image-url-"+dataView).val(e).trigger("keyup"),$(".ndkzoom").attr("href",e),$(".ndkzoom").attr("disabled",!1).removeClass("loadingButton")}}))}function setToZone(e,t){if("function"==typeof setToZone_Override)return setToZone_Override(e,t);left=$(t).offset().left,top=$(t).offset().top+$(t).outerHeight(),$(e).css({position:"absolute",left:left+"px",top:top+"px"})}function initText(e){if("function"==typeof initText_Override)return initText_Override(e);var t=e.parent().find(".texteditor"),i=e.attr("data-group"),a=e.attr("data-number");if(void 0===a&&(a=!1),pattern=(pattern=""!=e.attr("data-pattern")&&void 0!==e.attr("data-pattern")?e.attr("data-pattern"):"|").split("|"),canvasDom='<canvas id="myCanvas'+e.attr("data-group")+'" width="0" height="0"></canvas>',!t.length||0==t.length){if(0<e.attr("data-lines"))if(e.hasClass("type_textarea"))zone_text=(zone_text='<span class="textarea">')+"<textarea "+(0<e.attr("data-max")?'maxlength="'+e.attr("data-max")+'"':"")+' class="noborder countmychars" data-pattern="'+pattern[0]+'"></textarea></span><style>.arcSelector{display:none!important;}</style>',e.after('<div class="fontSelect " id="textZone'+e.attr("data-group")+(0!=a?"-"+a:"")+'"><span class="texteditor">'+zone_text+'</span><span class="submitText'+(0!=a?"Item":"")+'">'+applyText+'</span></div><div class="conter-container"></div>');else{zone_text='<span class="textarea">';for(var r=0;r<e.attr("data-lines");r++)zone_text+='<input data-pattern="'+pattern[r]+'" type="text" '+(0<e.attr("data-max")?'maxlength="'+e.attr("data-max")+'"':"")+' size="15" value="" class="noborder" placeholder="Text line '+(r+1)+'"/>';zone_text+="</span><style>.arcSelector{display:none!important;}</style>",e.after('<div class="fontSelect " id="textZone'+e.attr("data-group")+(0!=a?"-"+a:"")+'"><span class="texteditor">'+zone_text+'</span><span class="submitText'+(0!=a?"Item":"")+'">'+applyText+"</span></div>")}else zone_text=e.hasClass("type_textarea")?(width="auto",height="auto",0<$(".zone_limit[data-group='"+i+"']").length&&(container=".zone_limit[data-group='"+i+"']",width=$(container).width(),height=$(container).height()),zone_text='<span class="textarea">',(zone_text+='<textarea style="width:'+width+"; height:"+height+' " '+(0<e.attr("data-max")?'maxlength="'+e.attr("data-max")+'"':"")+' type="text" class="noborder"></textarea>')+'<div id="poptext_'+i+'" class="poptext"></div></span><style>.arcSelector{display:none!important;}</style>'):(zone_text='<span class="textarea">')+"<input "+(0<e.attr("data-max")?'maxlength="'+e.attr("data-max")+'"':"")+' type="text" size="15" value="Votre texte " class="noborder"/></span><style>.arcSelector{display:none!important;}</style>',e.after('<div class="fontSelect " "textZone'+e.attr("data-group")+(0!=a?"-"+a:"")+'"><span class="texteditor">'+zone_text+'</span><span class="submitText'+(0!=a?"Item":"")+'">'+applyText+"</span></div>");e.after(canvasDom),$(".noborder, .simpleText, .noborderSimple").each(function(){maxChars=$(this).attr("maxlength"),0<parseInt(maxChars)&&$(this).maxlength({slider:!0,maxCharacters:maxChars}),""!=(textmask=$(this).attr("data-pattern"))&&"undefined"!=typeof textmask&&(""!=(mask=textmask.split("&&"))[0]&&void 0!==mask[0]?$(this).mask(mask[0],{placeholder:mask[1]}):""!=mask[1]&&void 0!==mask[1]&&$(this).attr("placeholder",mask[1]))});t=fonts;myColors=colors,mySizes=["20","30","40","50","60","70","80","90","100"],myEffects=["applatMe","concavMe","convexMe"],myAlignments=["left","center","right"],0<window["fieldFonts_"+i].length&&(t=window["fieldFonts_"+i]),0<window["fieldColors_"+i].length&&(myColors=window["fieldColors_"+i]),0<window["fieldSizes_"+i].length&&(mySizes=window["fieldSizes_"+i]),0<window["fieldEffects_"+i].length&&(myEffects=window["fieldEffects_"+i]),0<window["fieldAlignments_"+i].length&&(myAlignments=window["fieldAlignments_"+i]),allFonts.push(t),$("#textZone"+e.attr("data-group")+(0!=a?"-"+a:"")).fontSelector({hide_fallbacks:!0,initial:t[0],initialSize:$(window).width()<768?mySizes[0]/2:mySizes[0],initialColor:myColors[0],initialEffect:myEffects[0],initialAlignment:myAlignments[0],selected:function(e){},selectedSize:function(e){},selectedColor:function(e){$(".colorSelector").css("background",e)},fonts:t,sizes:mySizes,colors:myColors,effects:myEffects,alignments:myAlignments,showStroke:stroke_color[i]})}$("#textZone"+e.attr("data-group")).css("font-size",mySizes[0]+"px"),setTimeout(function(){$(".fontSelectUl").each(function(){$(this).find("li").first().addClass("active")}),$(".fontColorSelectUl").each(function(){$(this).find("li").first().addClass("active")})},1500)}function initTextLight(e){if("function"==typeof initTextLight_Override)return initTextLight_Override(e);var t=e.hasClass("initiated"),i=e.attr("data-group");e.attr("data-number");if(pattern=(pattern=""!=e.attr("data-pattern")&&void 0!==e.attr("data-pattern")?e.attr("data-pattern"):"").split("|"),!t){if(0<e.attr("data-lines")){zone_text='<div class="zone_text_inputs pt-1">';for(var a=0;a<e.attr("data-lines");a++)zone_text+='<input id = "text_'+i+'"  data-pattern="'+pattern[a]+'" type="text" '+(0<e.attr("data-max")?'maxlength="'+e.attr("data-max")+'"':"")+' size="15" value="" class="'+(e.hasClass("required_field")?"required_field_test":"")+' noborderSimple" placeholder="Text line '+(a+1)+'" data-message="'+e.attr("data-message")+'"/>';zone_text+="</div>",e.after(zone_text).addClass("initiated").hide()}$(".noborderSimple, .simpleText, .noborderSimple").each(function(){maxChars=$(this).attr("maxlength"),0<parseInt(maxChars)&&$(this).maxlength({slider:!0,maxCharacters:maxChars}),""!=(textmask=$(this).attr("data-pattern"))&&"undefined"!=typeof textmask&&(""!=(mask=textmask.split("&&"))[0]&&void 0!==mask[0]?$(this).mask(mask[0],{placeholder:mask[1]}):""!=mask[1]&&void 0!==mask[1]&&$(this).attr("placeholder",mask[1]))})}}function stopWheel(e){if("function"==typeof stopWheel_Override)return stopWheel_Override(e);(e=e||window.event).preventDefault&&e.preventDefault(),e.returnValue=!1}function calculateSurface(e,t,i){if("function"==typeof calculateSurface_Override)return calculateSurface_Override(e,t,i);result=1;for(var a=0;a<t.length;a++)void 0!==t[a]&&(result=parseFloat(parseFloat(result)*parseFloat(t[a])));updatePriceNdk(price=0<parseFloat(result)?($("#resultValue_"+e).html(parseFloat(result).toFixed(2)),$(".resultValue_"+e).show(),parseFloat(i*result)):($("#resultValue_"+e).html(),$(".resultValue_"+e).hide(),0),e)}function setNdkImgTooltip(){$(".img-item-row").each(function(){var e=$(this),t=e.find(".img-value:eq(0)").attr("data-src");""!=t&&(html_img='<img class="img-responsive" src="'+t+'"/>',e.tooltip({html:!0,content:html_img,placement:"top"}))})}function loadAccessoryAttrPrice(e,t,i,a){if("function"==typeof loadAccessoryAttrPrice_Override)return loadAccessoryAttrPrice_Override(e,t,i,a);group=a.attr("data-group"),$.ajax({type:"GET",url:baseUrl+"modules/ndk_advanced_custom_fields/front_ajax.php",data:{id_product:e,id_product_attribute:t,quantity:i,action:"getAttributePrice"},dataType:"json",async:!0,success:function(e){a.attr("data-price",e.price),qtty=(a.hasClass("ndk-accessory-comb-tab")?$("#ndkcf_totalprod_quantity_"+a.attr("data-id-value")):a).val(),qtty=a.val(),unitPrice=e.price,price=qtty*unitPrice,valueId=a.attr("data-value-id"),$(".ndk-accessory-quantity[data-group='"+group+"'][value!=0]").not(a).each(function(){0<$(this).val()&&$(this).attr("data-price")!=e.price&&$(this).trigger("keyup")}),updatePriceNdk(price,a.attr("data-value-id")),$(".final_price_"+a.attr("data-id-value")).html(formatCurrencyNdk(e.price)),1==displayPriceHT&&(key=a.hasClass("ndk-accessory-comb-tab")?a.attr("data-value-id"):a.attr("data-id-value"),$(".final_price_"+key+" .priceht").remove(),$(".final_price_"+key).append('<span class="priceht clear clearfix"></span>'),getPriceHt(e.price,".final_price_"+key+" .priceht")),0<(price_ratio=a.attr("data-price-ratio"))&&(unit_price=e.price/price_ratio,a.parent().parent().parent().find(".unit_price_display").html(formatCurrencyNdk(unit_price))),productWeight=parseFloat(a.attr("data-product-weight")),attrWeight=e.weight?productWeight+parseFloat(e.weight):productWeight,lastWeight=parseFloat(a.attr("data-weight")),a.attr("data-weight",attrWeight),lastWeight==attrWeight||isNaN(attrWeight)||isNaN(lastWeight)||a.trigger("keyup")}})}function loadAccessoryAttrImg(t,e,i,a){if("function"==typeof loadAccessoryAttrImg_Override)return loadAccessoryAttrImg_Override(t,e,i,a);$.ajax({type:"GET",url:baseUrl+"modules/ndk_advanced_custom_fields/front_ajax.php",data:{id_product:t,id_product_attribute:e,link_rewrite:i,action:"getAttributeImg"},dataType:"html",success:function(e){a.parent().parent().parent().find(".img-responsive").attr("src",e),$(".accessory-ndk[data-id-product-value='"+t+"']").trigger("click").addClass("test")}})}function saveCustomization(e){if("function"==typeof saveCustomization_Override)return saveCustomization_Override(e);e=e||!1,$("#ndkcf_config_tags").val($("#ndkcf_config_tags").tagify("serialize")),left_block=$("#image-block").html(),right_block=$("#ndkcsfields").html(),layer_block=$("#layer-block").html(),id_product=$("#ndkcf_id_product").val(),id_customer=$("#ndkcf_id_customer").val(),config_tags=e?(config_name=e,""):(config_name=$("#ndkcf_config_name").val(),$("#ndkcf_config_tags").val()),$("body").append('<div class="ndk-loader" id="ndkloader"><div class="sk-folding-cube"><div class="sk-cube1 sk-cube"></div><div class="sk-cube2 sk-cube"></div><div class="sk-cube4 sk-cube"></div><div class="sk-cube3 sk-cube"></div></div></div>'),$(right_block).find(".image-url").val(""),leftDatas=btoa(RawDeflate.deflate(left_block)),rightDatas=btoa(RawDeflate.deflate(right_block)),layerDatas=btoa(RawDeflate.deflate(layer_block)),json_values=getSelectedValuesFromConfig($.parseHTML(strReplaceAll(right_block,"¬","€"))),configPrice=getPriceHt(totalUnitPrice,"",!0),$.when(simuViews(!0,!0)).done(function(){$.ajax({type:"POST",url:baseUrl+"modules/ndk_advanced_custom_fields/saveConfig.php",data:{action:"saveConfig",leftBlock:leftDatas,rightBlock:rightDatas,layerBlock:layerDatas,idCustomer:id_customer,idProduct:id_product,idCustomization:0,configName:config_name,configTags:config_tags,configImg:compoImages,price:configPrice,json_values:json_values},dataType:"html",success:function(e){$("#name_already_exists").hide(),$("#ndkcsfields").append('<p id="saved"><span>'+savedtext+"</span></p>"),$(".current_config_img").attr("src",compoImages[0]).show(),makeSocialCompo(e,!0),setTimeout(function(){$("#saved, #ndkloader").remove()},800)},error:function(){}})})}function loadCustomization(t){if("function"==typeof loadCustomization_Override)return loadCustomization_Override(t);var i=$("#ndkcf_id_product").val(),a=($("#quantity_wanted").val(),$("#ndkcf_id_combination").val());$.ajax({type:"GET",url:baseUrl+"modules/ndk_advanced_custom_fields/saveConfig.php",data:{action:"getConfig",idConfig:t},dataType:"json",success:function(e){e=copyHtmlBlocks(e);$.when(e).then(function(){$(".fieldPane").show(),loadInitialValues(),reCalculatePrice(),applyConfigValuesNdk(),reSetEditableFields(),$(".pace").remove(),0==parseInt(letOpen)&&$(".fieldPane").hide(),1==makeSlide?makeGroupFieldsSlide():$(".ndkackFieldItem").removeClass("sliderBlock"),$("#ndkcf_id_product").val(i),$("#ndkcf_id_combination").val(a),$("#submitNdkcsfields, .submitNdkcsfields").attr("disabled",!1),$(".image-url").val(""),$(".current_config_img").attr("src",$("#configItem_"+t+" .ndkLoadConfigImg").attr("src")),setTimeout(function(){equalheight(".img-item-row"),makeSocialCompo(t,!1),$(".tooltipDescMark").each(function(){text=$(this).parent().find(".tooltipDescription").html(),$(this).tooltip({html:!0,title:text,placement:"auto"})}),$.prototype.uniform,$(".resetZones").trigger("click"),setOpenedStatus(),$(".ndk_tag_selector").val("all").trigger("change"),$("#submitNdkcsfields, .submitNdkcsfields").unbind("click").click(function(e){$("#ndkcsfields").ndkSubmit(e)})},1e3)})},error:function(){}})}function copyHtmlBlocks(e){if("function"==typeof copyHtmlBlocks_Override)return copyHtmlBlocks_Override(e);for(idField in $("#image-block").html($.parseHTML(strReplaceAll(e.leftBlock,"¬","€"))),$("#layer-block").html($.parseHTML(strReplaceAll(e.layerBlock,"¬","€"))),$("#ndkcsfields").html($.parseHTML(strReplaceAll(e.rightBlock,"¬","€"))),configToSet=getSelectedValuesFromConfig($.parseHTML(strReplaceAll(e.rightBlock,"¬","€"))))void 0!==configToSet[idField]&&triggerConfig(idField,configToSet[idField])}function triggerConfig(e,t){if("function"==typeof triggerConfig_Override)return triggerConfig_Override(e,t);$("#main-"+e).find(".img-value[data-id-value='"+t+"']").trigger("click"),$("#main-"+e).find(".color-ndk[data-id-value='"+t+"']").trigger("click"),$("#main-"+e).find(".ndk-select").val(t).trigger("change"),$("#main-"+e).find(".ndk-radio[value='"+t+"']").prop("checked",!0).trigger("click").trigger("change"),$("#main-"+e).find(".ndk-checkbox[value='"+t+"']").prop("checked",!0).trigger("click").trigger("change"),$("#main-"+e).find(".simpleText, input.visual-text, .noborder").val(t).trigger("change").trigger("keyup")}function applyConfigValuesNdk(){if("function"==typeof applyConfigValuesNdk_Override)return applyConfigValuesNdk_Override();$(".color-ndk.selected-value").trigger("click"),$(".img-value.selected-value").each(function(){(0<$(this).parent().find(".svg-container").length?$(this).parent().find(".svg-container"):$(this)).trigger("click")}),$(".ndk-radio:checked, .checked .ndk-radio").prop("checked",!0).trigger("click").trigger("change"),$(".ndk-checkbox:checked, .checked .ndk-checkbox,.ndk-checkbox[checkme='1']").prop("checked",!0).trigger("change"),$(".ndk-select").each(function(){$(this).find("option:selected").prop("selected","selected"),$(this).trigger("change")}),$(".dimension_text").each(function(){$(this).trigger("keyup").trigger("change")}),$(".form-group").removeClass("activeFormGroup"),$.prototype.uniform&&$("select.form-control,input[type='radio'],input[type='checkbox']").not(".not_uniform").uniform()}function reCalculatePrice(){if("function"==typeof reCalculatePrice_Override)return reCalculatePrice_Override();$(".selected-value, .ndk-radio:checked, .ndk-select option:selected").each(function(){group=$(this).attr("data-group"),updatePriceNdk(price=$(this).attr("data-price"),group)}),$(".selected-svg").each(function(){group=$(this).parent().find(".img-value").attr("data-group"),updatePriceNdk(price=$(this).parent().find(".img-value").attr("data-price"),group)}),$(".noborderSimple").each(function(){rootInput=$(this).parent().parent().find(".simpleText"),group=rootInput.attr("data-group"),price=rootInput.attr("data-price"),ppcprice=rootInput.attr("data-ppcprice"),el=$(this),texte="",charsCount=0,inputNumber=el.parent().find(".noborderSimple").length,separator=1<inputNumber?" \n ":"",el.parent().find(".noborderSimple").each(function(){""!=$(this).val()&&(texte+=$(this).val()+separator,charsCount+=$(this).val().replace(/\ /g,"").length)}),""==texte||" "==texte?(price=0,texte=""):price=0<ppcprice?ppcprice*charsCount:rootInput.attr("data-price"),""!=texte&&" "!=texte||(price=0,texte=""),rootInput.val(texte),updatePriceNdk(price,group)}),$(".submitSimpleText").each(function(){group=$(this).parent().find(".visual-text").attr("data-group"),price=$(this).parent().find(".visual-text").attr("data-price"),ppcprice=$(this).parent().find(".visual-text").attr("data-ppcprice"),(charsCount=charsCount=0)<$(this).parent().find("input.visual-text").length?(texte="",$(this).parent().find("input.visual-text").each(function(){""!=$(this).val()&&(texte+=$(this).val()+" ",charsCount+=$(this).val().replace(/\ /g,"").length)})):texte=$(this).parent().find("textarea").text(),""==texte||" "==texte?(price=0,texte=""):price=0<ppcprice?ppcprice*charsCount:$(this).parent().parent().find("textarea").attr("data-price"),""!=texte&&" "!=texte||(price=0,texte=""),updatePriceNdk(price,group)}),$(".submitText").each(function(){group=$(this).parent().parent().find(".ndktextarea").attr("data-group"),price=$(this).parent().parent().find(".ndktextarea").attr("data-price"),ppcprice=$(this).parent().parent().find(".ndktextarea").attr("data-ppcprice"),charsCount=0,inputNumber=$(this).parent().find(".noborder").length,separator=1<inputNumber?" \n ":"",0<$(this).parent().find(".noborder").length?(texte="",$(this).parent().find(".noborder").each(function(){""!=$(this).val()&&(texte+=$(this).val()+separator,charsCount+=$(this).val().replace(/\ /g,"").length)})):texte=$(this).parent().find(".textarea").text(),""==texte||" "==texte?(price=0,texte=""):price=0<ppcprice?ppcprice*charsCount:$(this).parent().parent().find(".ndktextarea").attr("data-price"),""!=texte&&" "!=texte||(price=0,texte=""),updatePriceNdk(price,group)}),$("#ndkcsfields-block select").each(function(){$(this).val($(this).attr("data-selected")).trigger("change")}),$(".ndk-accessory-quantity[value!=0]").each(function(){$(this).trigger("keyup")}),$(".simpleText").each(function(){$(this).trigger("keyup")})}function getSelectedValuesFromConfig(e){return"function"==typeof getSelectedValuesFromConfig_Override?getSelectedValuesFromConfig_Override(e):(selectedConfig=[],(e=$(e)).find(".ndk-radio:checked").each(function(){group=$(this).attr("data-group"),price=$(this).attr("data-price"),selectedConfig[group]=$(this).val()}),e.find(".ndk-checkbox:checked").each(function(){group=$(this).attr("data-value-id"),price=$(this).attr("data-price"),selectedConfig[group]=$(this).val()}),e.find(".selected-value").each(function(){group=$(this).attr("data-group"),price=$(this).attr("data-price"),selectedConfig[group]=$(this).attr("data-id-value")}),e.find(".selected-svg").each(function(){group=$(this).parent().find(".img-value").attr("data-group"),price=$(this).parent().find(".img-value").attr("data-price"),selectedConfig[group]=$(this).parent().find(".img-value").attr("data-value")}),e.find(".submitSimpleText").each(function(){group=$(this).parent().find(".visual-text").attr("data-group"),price=$(this).parent().find(".visual-text").attr("data-price"),ppcprice=$(this).parent().find(".visual-text").attr("data-ppcprice"),(charsCount=charsCount=0)<$(this).parent().find("input.visual-text").length?(texte="",$(this).parent().find("input.visual-text").each(function(){""!=$(this).val()&&(texte+=$(this).val()+" ",charsCount+=$(this).val().replace(/\ /g,"").length)})):texte=$(this).parent().find("textarea").text(),""==texte||" "==texte?(price=0,texte=""):price=0<ppcprice?ppcprice*charsCount:$(this).parent().parent().find("textarea").attr("data-price"),""!=texte&&" "!=texte||(price=0,texte=""),selectedConfig[group]=texte}),e.find(".submitText").each(function(){group=$(this).parent().parent().find(".ndktextarea").attr("data-group"),price=$(this).parent().parent().find(".ndktextarea").attr("data-price"),ppcprice=$(this).parent().parent().find(".ndktextarea").attr("data-ppcprice"),(charsCount=0)<$(this).parent().find(".noborder").length?(texte="",$(this).parent().find(".noborder").each(function(){""!=$(this).val()&&(texte+=$(this).val()+" \n ",charsCount+=$(this).val().replace(/\ /g,"").length)})):texte=$(this).parent().find(".textarea").text(),""==texte||" "==texte?(price=0,texte=""):price=0<ppcprice?ppcprice*charsCount:$(this).parent().parent().find(".ndktextarea").attr("data-price"),""!=texte&&" "!=texte||(price=0,texte=""),selectedConfig[group]=texte}),e.find(".ndk-accessory-quantity[value!=0]").each(function(){group=$(this).attr("data-group"),selectedConfig[group]=$(this).attr("data-id-value")}),e.find(".simpleText").each(function(){group=$(this).attr("data-group"),selectedConfig[group]=$(this).val()}),e.find(".ndk-select").each(function(){group=$(this).attr("data-group"),price=$(this).attr("data-price"),selectedConfig[group]=$(this).val()}),selectedConfig)}function reSetEditableFields(){if("function"==typeof reSetEditableFields_Override)return reSetEditableFields_Override();window.event;$(".textzone").each(function(){el=$(this),myGroup=$(this).attr("data-group"),number=$(this).attr("data-number"),myFonts=fonts,myColors=colors,mySizes=["20","30","40","50","60","70","80","90","100"],myEffects=["applatMe","concavMe","convexMe"],myAlignments=["left","center","right"],0<window["fieldFonts_"+myGroup].length&&(myFonts=window["fieldFonts_"+myGroup]),0<window["fieldColors_"+myGroup].length&&(myColors=window["fieldColors_"+myGroup]),0<window["fieldSizes_"+myGroup].length&&(mySizes=window["fieldSizes_"+myGroup]),0<window["fieldEffects_"+myGroup].length&&(myEffects=window["fieldEffects_"+myGroup]),0<window["fieldAlignments_"+myGroup].length&&(myAlignments=window["fieldAlignments_"+myGroup]),$("#textZone"+el.attr("data-group")).fontSelector({hide_fallbacks:!0,initial:myFonts[0],initialSize:$(window).width()<768?mySizes[0]/2:mySizes[0],initialColor:myColors[0],initialEffect:myEffects[0],initialAlignment:myAlignments[0],selected:function(e){},selectedSize:function(e){},selectedColor:function(e){$(".colorSelector").css("background",e)},fonts:myFonts,sizes:mySizes,colors:myColors,effects:myEffects,alignments:myAlignments,showStroke:stroke_color[myGroup]}),$("#textZone"+el.attr("data-group")+"-"+el.attr("data-number")).fontSelector({hide_fallbacks:!0,initial:myFonts[0],initialSize:$(window).width()<768?mySizes[0]/2:mySizes[0],initialColor:myColors[0],initialEffect:myEffects[0],initialAlignment:myAlignments[0],selected:function(e){},selectedSize:function(e){},selectedColor:function(e){$(".colorSelector").css("background",e)},fonts:myFonts,sizes:mySizes,colors:myColors,effects:myEffects,alignments:myAlignments,showStroke:stroke_color[myGroup]})}),$(".ndk_selector").each(function(){$(this).setNdkSelector()}),equalheight(".svg-container"),$(".absolute-visu").each(function(){is_resizeable=$(this).attr("data-resizeable"),is_dragdrop=$(this).attr("data-dragdrop"),is_rotateable=$(this).attr("data-rotateable"),zindex=$(this).attr("data-zindex"),containment=$(this).parent().hasClass("zone_limit")?"parent":"",layerOptions="",$(this).resizable().resizable("destroy").rotatable({wheelRotate:!1}).rotatable("destroy").draggable().draggable("destroy"),1!=is_resizeable&&1!=is_dragdrop&&1!=is_rotateable||setEditable("#"+$(this).attr("id"),zindex,containment,layerOptions,is_dragdrop,is_resizeable,is_rotateable)}),0<$(".view_tab").length&&$("li.view_tab").first().trigger("click")}function uploadForSafari(e,t){if("function"==typeof uploadForSafari_Override)return uploadForSafari_Override(e,t);url=t.attr("data-action"),(el=t).parent().parent().append('<div class="ndk-loader" id="ndkloader"><div class="sk-folding-cube"><div class="sk-cube1 sk-cube"></div><div class="sk-cube2 sk-cube"></div><div class="sk-cube4 sk-cube"></div><div class="sk-cube3 sk-cube"></div></div></div>'),files=e.target.files,upFileType="other";for(var i=new FormData,a=0;a<files.length;a++){var r=files[a],o=(r.type.match("image.*")&&(upFileType="image"),i.append("file",r,r.name),i.append("safari",!0),new XMLHttpRequest);o.open("POST",url,!0),o.send(i),o.onload=function(){var e=o.responseText;200===o.status&&(el.parent().hide(),("image"==upFileType?el.parent().parent().find(".img-value:eq(0)").removeClass("hidden").attr("src",baseUrl+e).attr("data-src",baseUrl+e).attr("data-value",baseUrl+e):el.parent().parent().find(".img-value:eq(0)").removeClass("hidden").attr("src",baseUrl+"modules/ndk_advanced_custom_fields/views/img/file_picto.png").attr("data-value",baseUrl+e).addClass("pictoFileUpload")).trigger("click"),el.parent().parent().find(".remove-upload").show(),$("#ndkloader").fadeOut().remove())}}upFileType="other";e=t.val().split(".").pop().toLowerCase();(-1<e.indexOf("jpg")||-1<e.indexOf("png")||-1<e.indexOf("png")||-1<e.indexOf("gif")||-1<e.indexOf("jpeg")||-1<e.indexOf("pjpeg")||-1<e.indexOf("x-png"))&&(upFileType="image")}function hexToRgb(e){e=e.replace(/[^0-9A-F]/gi,"");e=parseInt(e,16);return[e>>16&255,e>>8&255,255&e].join()}function writeMyCanvas(e,t,i,a){return"function"==typeof writeMyCanvas_Override?writeMyCanvas_Override(e,t,i,a):(document.getElementById("myCanvas"+e),e=new C2S(t,i),newWidth=t+10,newHeight=i+20,e.canvas.width=newWidth,e.canvas.height=newHeight,e.clearRect(0,0,newWidth,newHeight),t=newWidth/1.9,i=newHeight/1.5,e.clearRect(0,0,newWidth,newHeight),e.font="bold 20px Helvetica",e.lineWidth=3,e.textAlign="center",e.fillStyle="black",e.fillText(a,t,i),a=e.getSvg(),e.getSerializedSvg(),a)}function goToStepQuantity(e,t,i){if("function"==typeof goToStepQuantity_Override)return goToStepQuantity_Override(e,t,i);if("-"==i)for(var a=last_encountred=0;a<t.length;a++)t[a]<e&&t[a]>=last_encountred&&(last_encountred=t[a],nextVal=t[a]);else{last_encountred=1e17;for(a=0;a<t.length;a++)e<t[a]&&t[a]<=last_encountred&&(last_encountred=t[a],nextVal=t[a])}return nextVal}function setAccessoryCustomization(e){customizationBlock=$("#accessory_customization_"+e.attr("data-id-value")),qtty_total=parseInt(e.val()),id_product=e.attr("data-id-product-accessory"),id_combination=e.attr("data-id_combination"),attrName=e.attr("data-attr-lang"),valueId=e.attr("data-id-value"),cusCount=customizationBlock.find(".ndkackFieldItem").length,customizationBlock.find(".required_field_back").addClass("required_field").removeClass("required_field_back"),customizationBlock.find("textarea, input, select").addClass("dontSend");for(var t=0;t<qtty_total;t++)0<cusCount&&(newCustomizationBlock=customizationBlock.clone(),group=newCustomizationBlock.find(".ndkackFieldItem:eq(0)").attr("data-field"),newGroup=group+"_"+e.attr("data-id-value")+"_"+id_combination+"-"+t,customAllDescendants(newCustomizationBlock,group,newGroup),window["fieldFonts_"+group]&&(window["fieldFonts_"+newGroup]=window["fieldFonts_"+group],window["fieldColors_"+newGroup]=window["fieldColors_"+group],window["fieldSizes_"+newGroup]=window["fieldSizes_"+group],window["fieldEffects_"+newGroup]=window["fieldEffects_"+group],window["fieldAlignments_"+newGroup]=window["fieldAlignments_"+group]),newCustomizationBlock.attr("id","accessory_customization_"+e.attr("data-id-value")+"_"+id_combination+"-"+t).attr("class","col-xs-12 cloned_accessory_customization_"+e.attr("data-id-value")+"_"+id_combination+" cloned_accessory_customization_"+e.attr("data-id-value")+" accessory_customization cloned_accessory_customization clearfix").removeClass("hidden"),newCustomizationBlock.find(".form-group .toggler").removeClass("toggler").addClass("smallToggler"),newCustomizationBlock.find(".toggleText:eq(0)").remove(),oldTitle=newCustomizationBlock.find(".toggler_title").text(),newCustomizationBlock.find(".toggler_title").text(oldTitle+" "+attrName),newCustomizationBlock.find("textarea, input, select").each(function(){void 0!==$(this).attr("name")&&-1<$(this).attr("name").indexOf("ndkcsfield")&&$(this).attr("name",$(this).attr("name")+"[accessory_customization]["+valueId+"|"+id_product+"|"+id_combination+"|"+t+"|"+attrName+"]")}),newCustomizationBlock.find("textarea, input, select").removeClass("dontSend"),customizationBlock.parent().prepend(newCustomizationBlock),customizationBlock.find(".required_field").addClass("required_field_back").removeClass("required_field"),newCustomizationBlock.find(".fieldPane").slideUp());if(attrBlockCount=$(".cloned_accessory_customization_"+e.attr("data-id-value")+"_"+id_combination).length,0<(blockDiff=attrBlockCount-qtty_total))for(t=0;t<blockDiff;t++)$("#accessory_customization_"+e.attr("data-id-value")+"_"+id_combination+"-"+t).remove();0<(prodBlockCount=$(".cloned_accessory_customization_"+e.attr("data-id-value")).length)?($("#t_a_c_"+e.attr("data-id-value")).show(),1<prodBlockCount?customizationBlock.parent().find(".cloned_accessory_customization").addClass("col-md-4"):customizationBlock.parent().find(".cloned_accessory_customization").removeClass("col-md-4")):$("#t_a_c_"+e.attr("data-id-value")).hide()}function customAllDescendants(e,t,i){e.find("*").each(function(){customAllDescendants($(this)),void 0!==$(this).attr("data-group")&&$(this).attr("data-group",i),void 0!==$(this).attr("data-field")&&$(this).attr("data-field",i),void 0!==$(this).attr("id")&&$(this).attr("id",$(this).attr("id").replace(t,i))})}function strpos(e,t,i){e=(e+"").indexOf(t,i||0);return-1!==e&&e}function checkEmptyForm(e){return"function"==typeof checkEmptyForm_Override?checkEmptyForm_Override(e):(e=e||!1,emptyForm=!0,$i=0,$("*[name^='ndkcsfield[']").each(function(){if(rootBlock="",val=$(this).hasClass("quantity_error_down")||$(this).hasClass("quantity_error_up")?(group=$(this).parent().parent().parent().attr("data-field"),$(this).attr("val")):(group=(group=(group=(void 0!==$(this).attr("data-name")?$(this).attr("data-name"):$(this).attr("name")).split("ndkcsfield["))[1].split("]"))[0],$(this).val()),rootBlock=$(".form-group[data-field='"+group+"']:not(.submitContainer)"),$(this).is(":radio")){if($k=1,others=rootBlock.find('input[type="radio"]'),$(this).is(":checked"))for(var e=0;e<others.length;e++)$i++,$k++}else if($(this).is(":checkbox")){if($k=0,group=$(this).attr("data-group"),others=rootBlock.find('input[type="checkbox"]'),$(this).is(":checked"))for(e=0;e<others.length;e++)$i++,$k++}else""!=val&&": "!=val.slice(-2)&&$i++}),0!=$i||(e&&e.preventDefault(),$("#add-to-cart-or-refresh .add-to-cart, #add_to_cart .exclusive").prop("disabled",!1).trigger("click"),!1))}function setRecommends(){if("function"==typeof setRecommends_Override)return setRecommends_Override();for(var e=0;e<recommended.length;e++)$(".form-group[data-field='"+recommended[e]+"']").addClass("recommended_field"),$(".form-group[data-field='"+recommended[e]+"']").find("input:not([name*='ndkcsfieldPdf']):not('.noborder'),textarea:not([name*='ndkcsfieldPdf']), select:not(.ndk_tag_selector)").attr("data-group-recommend",recommended[e])}function checkRecommends(e,t){if("function"==typeof checkRecommends_Override)return checkRecommends_Override(e,t);recommend_list=[];var i,e=$(".form-group.recommended_field:not([class*='disabled_value_by'])").find("input:not(.ndk_tag_selector, .dontCare),textarea:not(.ndk_tag_selector), select:not(.ndk_tag_selector)");if($i=0,e.each(function(){if(group=$(this).attr("data-group-recommend"),val=$(this).val(),rootBlock=$(".form-group[data-field='"+group+"']"),(groupTitleEl=rootBlock.find("label:eq(0)").clone()).find(".toggleText").remove(),groupTitle=groupTitleEl.text(),"undefined"==typeof group)$i++;else if($(this).is(":radio"))if($k=1,others=rootBlock.find('input[type="radio"]'),$(this).is(":checked"))for(var e=0;e<others.length;e++)$i++,$k++;else $k<others.length&&(recommend_list[group]=groupTitle);else if($(this).is(":checkbox"))if($k=0,others=rootBlock.find('input[type="checkbox"]'),$(this).is(":checked"))for(e=0;e<others.length;e++)$i++,$k++;else $k<others.length&&(recommend_list[group]=groupTitle);else if($(this).is(".ndk-accessory-quantity"))if($k=1,others=rootBlock.find(".ndk-accessory-quantity[value!=0]"),0<parseFloat(val))for(e=0;e<others.length;e++)$i++,$k++;else $k<others.length&&(recommend_list[group]=groupTitle);else""==val?recommend_list[group]=groupTitle:$i++}),$i>=e.length)return checked=!0,checkEmptyForm(t);for(i in t.preventDefault(),ret=!1,$("#recommends_list").html(""),recommend_list)""!=recommend_list[i]&&$("#recommends_list").append('<li id="showRecommendItem_'+i+'"><span class="showRecommendItem">'+recommend_list[i]+"</span></li>");$.fancybox("#confirm_recommends",{modal:!0,afterShow:function(){$(".confirm_recommends").on("click",function(e){$(e.target).is(".yes")?(checked=!0,checkEmptyForm(e)&&$("#ndkcsfields").trigger("submit")):checked=!1,$.fancybox.close()})},afterClose:function(){}})}function checkCustomizations(){return"function"!=typeof checkCustomizations_Override||checkCustomizations_Override()}function resizeInput(){if("function"==typeof resizeInput_Override)return resizeInput_Override();"search_query_top"!=$(this).attr("id")&&($(this).attr("size",$(this).val().length+5),$(this).parent().css("width",$(this).innerWidth))}$(function(){$("#ndkcsfields-block").length<1||!isFields?$(".ndkcsfields-block.config_boxes").remove():$("body").append('<div class="ndk-loader" id="ndkloader"><div class="sk-folding-cube"><div class="sk-cube1 sk-cube"></div><div class="sk-cube2 sk-cube"></div><div class="sk-cube4 sk-cube"></div><div class="sk-cube3 sk-cube"></div></div></div>')}),initApplication=function(){1!=isFields||$("#ndkcsfields-block").length<1||(identifyResctictives(),$("#submitNdkcsfields, .submitNdkcsfields").unbind("click").click(function(e){$("#ndkcsfields").ndkSubmit(e)}),$("body").addClass("ndkcfLoaded"),$("body").addClass("is_customizable_product_ndk"),$(".product-cover:eq(0)").attr("id","image-block"),$(".product-cover:eq(0) img[itemprop='image']").attr("id","bigpic"),$(".images-container").removeClass("images-container"),redesignPageLight())},$(document).ready(function(){0<$("#ndkcsfields").length&&($(".images-container").removeClass("images-container"),setTimeout(function(){$.when(initApplication()).then(function(){setTimeout(function(){$("#ndkloader").remove(),$(".resetZones").trigger("click"),0<makeItFloat&&(1.6<ps_version?("undefined"==typeof contentOnly&&(contentOnly=!1),$("#content").parent().addClass("pb-left-column"),makeFloat(".pb-left-column:eq(0)")):makeFloat(".pb-left-column"),makeFloat(".pb-right-column","#ndkcsfields")),setOpenedStatus()},50)})},150))}),$(document).on("keyup",".noborderSimple",function(){rootInput=$(this).parent().parent().find(".simpleText"),group=rootInput.attr("data-group"),price=rootInput.attr("data-price"),ppcprice=rootInput.attr("data-ppcprice"),el=$(this),texte="",charsCount=0,clearTimeout(typingTimer),inputNumber=el.parent().find(".noborderSimple").length,separator=1<inputNumber?"\n":"",typingTimer=setTimeout(function(){el.parent().find(".noborderSimple").each(function(){""!=$(this).val()&&(texte+=$(this).val()+separator,charsCount+=$(this).val().replace(/\ /g,"").length)}),""==texte||" "==texte?(price=0,texte=""):price=0<ppcprice?ppcprice*charsCount:rootInput.attr("data-price"),""!=texte&&" "!=texte||(price=0,texte=""),rootInput.val(texte).trigger("keyup"),updatePriceNdk(price,group)},1e3)}),$(document).on("keyup, change",".surface",function(){group=$(this).attr("data-group"),valuePrice=$(this).attr("data-price"),0<parseFloat($(this).attr("min"))&&parseFloat($(this).val())<parseFloat($(this).attr("min"))&&$(this).val($(this).attr("min")),0<parseFloat($(this).attr("max"))&&parseFloat($(this).val())>parseFloat($(this).attr("max"))&&$(this).val($(this).attr("max")),$(".surface_"+group).each(function(){$i=$(this).attr("data-val"),mesures[$i]=parseFloat($(this).val()),defaultMesures[$i]=parseFloat($(this).attr("min"))}),1==$(this).attr("data-preserve-ratio")&&(defaultMesures.sort(),ratio=defaultMesures[1]/defaultMesures[0],el=$(this),$(".surface_"+group).not(this).each(function(){newVal=$(this).attr("min")==defaultMesures[1]?el.val()*ratio:el.val()/ratio,$(this).val()!=newVal.toFixed(2)&&$(this).val(newVal.toFixed(2)).trigger("change")})),calculateSurface(group,mesures,valuePrice)}),$(document).on("click",".toggleGroupField",function(){$(this).hasClass("opened")?($(".groupFieldBlock:visible").hide(),$(this).removeClass("opened").addClass("closed"),$("#bigpic").attr("src",$("#bigpic").attr("data-original-image")),$(".zone_limit, .absolute-visu, .editThisLayer").hide()):(target=$(this).attr("target"),$(".toggleGroupField").removeClass("opened").addClass("closed"),$(target).is(":visible")&&!$(target).hasClass("groupFieldBlock")?($(this).removeClass("opened").addClass("closed"),$(target).hide()):($(this).removeClass("closed").addClass("opened"),$(target).show(),$(target+" .view_tab:first").trigger("click")),$(".groupFieldBlock:visible:not("+target+")").hide(),$(target).find(".ndkcfPagerItem:eq(0)").trigger("click"),$(".img-item-row, .svg-container").css("height",""),setTimeout(function(){equalheight(".img-item-row"),equalheight(".svg-container")},500))}),$(document).on("submit",".ajax_form",function(e){e.preventDefault(),$("#submitNdkcsfields, .submitNdkcsfields").prop("disabled",!0),convertPercent(),loading_steps="undefined"!=typeof is_visual&&1==is_visual&&1==showHdPreview?3:2,$("body").append('<div class="ndk-loader" id="ndkloader"><h4 class="reveal-text"><span id="loader_step">(1/'+loading_steps+") </span>"+loadingText+'</h4><div class="sk-folding-cube"><div class="sk-cube1 sk-cube"></div><div class="sk-cube2 sk-cube"></div><div class="sk-cube4 sk-cube"></div><div class="sk-cube3 sk-cube"></div></div></div>'),$("#ndkcf_id_combination").val($("#idCombination").val()).trigger("keyup"),getIdCombinationNdk();var i=$(this),t=i.attr("action");id_product=$("#ndkcf_id_product").val(),qtty=$("#quantity_wanted").val(),parseFloat(qtty)<1&&(qtty=1,$("#quantity_wanted").val("1")),1==addProductPrice?id_combination=$("#ndkcf_id_combination").val():(id_combination=0,$("#ndkcf_id_combination").val(0).trigger("keyup")),myDatas=i.find("input, select, textarea").not(".ndk-accessory-quantity[value=0]").not(".ndk_attribute_select, .dontSend").serialize(),old_conf="undefined"==typeof oldRef||alreadyModify?(old_id=0,old_id_customization=0):(old_ref=oldRef.split("-"),old_id=refProd,old_id_customization=old_ref[4],editConfig),$(".form-group").removeClass("focusRequired"),$(".form-group").find(".error").remove(),createPreview(function(){$.ajax({type:"POST",url:t+(0<customizationPrice||$(".ndk-accessory-quantity[value!=0]").length,"createNdkcsfields.php"),data:myDatas+"&qty="+qtty+"&old_id="+old_id+"&old_id_customization="+old_id_customization+"&old_conf="+old_conf+"&is_visual="+(is_visual?1:0)+"&cover="+compoImages,dataType:"json",success:function(t){$("#product_customization_id").val(t.id_customization),convertPercent(),alreadyModify=!0,$("#image-block").removeClass("hight_quality"),$(".tempSvg").remove(),$(".hiddenForSnapshot").show().removeClass(".hiddenForSnapshot"),$("#image-block svg").show(),left_block=$("#image-block").html(),right_block=$("#ndkcsfields").html(),layer_block=0<$("#layer-block").length?$("#layer-block").html():"",id_product=$("#ndkcf_id_product").val(),id_customer=$("#ndkcf_id_customer").val(),config_name="custom-"+id_product+"-"+(0<parseFloat(id_combination)?parseFloat(id_combination):0)+"-"+t.id_cart+"-"+t.id_customization,config_tags="",$(right_block).find(".image-url").val(""),leftDatas=btoa(RawDeflate.deflate(left_block)),rightDatas=btoa(RawDeflate.deflate(right_block)),layerDatas=btoa(RawDeflate.deflate(layer_block)),$("#loader_step").html("(2/"+loading_steps+") "),$.when(simuViews(!0,!0)).done(function(){0==showImgPreview&&(compoImages=[]),compoImages=[$("#image-url-0").val()],configPrice=getPriceHt(totalUnitPrice,"",!0),configdatas=0<allowEdit?{action:"saveConfig",leftBlock:leftDatas,rightBlock:rightDatas,layerBlock:layerDatas,idCustomer:id_customer,idProduct:id_product,idCustomization:t.id_customization,configName:config_name,configTags:config_tags,configImg:compoImages,preview_field:t.preview_field_img,base_url:baseUrl,skip:0,price:configPrice}:{skip:1},$.ajax({type:"POST",url:baseUrl+"modules/ndk_advanced_custom_fields/saveConfig.php",data:configdatas,dataType:"html",success:function(e){i.append('<p id="saved"><svg id="savedSvg" width="220" height="150"><path id="check" d="M30,50 l60,60 l95,-80"></path></svg></p>'),$("#ndkloader").fadeOut().remove(),1.6<ps_version?0<t.id_product&&t.id_product!=id_product?($(".product-variants input, .product-variants select").val("").remove(),$("#product_customization_id").val(t.id_customization),$.when($("#product_page_product_id").val(t.id_product)).then(function(){$("#add-to-cart-or-refresh .add-to-cart").prop("disabled",!1).trigger("click")})):$("#add-to-cart-or-refresh .add-to-cart").prop("disabled",!1).trigger("click"):0<t.id_product&&t.id_product!=id_product?ajaxCart.add(t.id_product,null,!1,null,qtty):ajaxCart.add(id_product,0<id_combination?id_combination:null,!1,null,qtty),setTimeout(function(){$("#saved").remove(),$(".snapshoot").removeClass("snapshoot"),$("#submitNdkcsfields, .submitNdkcsfields").prop("disabled",!1).removeClass("loadingButton"),0<allowEdit&&makeSocialCompo(e,!0)},200),contentOnly},error:function(){}})}),customizationId=t.id_customization,"undefined"!=typeof is_visual&&1==is_visual&&1==showHdPreview&&($("#loader_step").html("(3/"+loading_steps+") "),$.ajax({type:"POST",url:baseUrl+"modules/ndk_advanced_custom_fields/createPdf.php",data:{htmlNodes:htmlOutput,idCustomer:t.id_customer,idProduct:t.id_product,idCustomization:t.id_customization,preview_field:t.preview_field,base_url:baseUrl,images:"",fonts:allFonts},dataType:"html",success:function(e){},error:function(){}}))},error:function(){}})})}),$(document).on("change",".ndk_attribute_select",function(){id_product=$(this).attr("ref");var e=$(this).parent().parent().find("input[data-id-product-accessory='"+id_product+"']");0<e.length&&0<e.val()&&(currName=e.attr("name"),newName=currName.split("|")[0]+"|"+currName.split("|")[1]+"|"+$(this).val()+"]",e.attr("name",newName).attr("data-id_combination",$(this).val()),e.hasClass("price_overrided")?1==displayPriceHT&&0<e.val()&&($(".final_price_"+e.attr("data-id-value")+" .priceht").remove(),$(".final_price_"+e.attr("data-id-value")).append('<span class="priceht clear clearfix"></span>'),getPriceHt(e.attr("data-price"),".final_price_"+e.attr("data-id-value")+" .priceht")):loadAccessoryAttrPrice(id_product,$(this).val(),e.val(),e),loadAccessoryAttrImg(id_product,$(this).val(),$(this).attr("data-link-rewrite"),e))}),$(document).on("change, keyup","#ndkcsfields-block input",function(){$(this).attr("value",$(this).val())}),$(document).on("change","#ndkcsfields-block select",function(){$(this).attr("data-selected",$(this).val())}),$(document).on("change, keyup","#ndkcsfields-block textarea",function(){$(this).html($(this).val()),ProgressBar()}),$(document).on("click","#ndkSaveCustomization",function(e){e.preventDefault(),""!=$("#ndkcf_config_name").val()?(convertPercent(),saveCustomization()):($("#ndkcf_config_name").css("background","#F2DEDE").focus(),$("#ndkcf_config_name").parent().find(".error").remove(),$("#ndkcf_config_name").after('<span class="error alert-danger clear clearfix">'+$("#ndkcf_config_name").attr("data-message")+"</span>"))}),$(document).on("click",".ndkLoadConfigImg",function(){$(this).parent().parent().find(".ndkLoadConfig").trigger("click")}),$(document).on("click",".ndkLoadConfig",function(){$(".tagify").tagify("destroy");var e=$(this).text(),t=$(this).attr("data-tags");"0"!=$(this).attr("data-id")?($("#ndkcf_config_name").val(e),$("#ndkcf_config_tags").val(t),loadCustomization($(this).attr("data-id")),setTimeout(function(){$(".tagify").tagify({delimiters:[13,188,44],addTagPrompt:tagslabel})},500),$(".configItem").removeClass("active"),$(this).parent().addClass("active")):window.location.reload()}),$(document).on("change",".upload_ndk_visu",function(e){var t;e.preventDefault(),url=$(this).attr("data-action"),el=$(this),bidon=!1,window.File&&window.FileReader&&window.FileList&&window.Blob&&!bidon?(t=new FileReader,el.parent().parent().append('<div class="ndk-loader" id="ndkloader"><div class="sk-folding-cube"><div class="sk-cube1 sk-cube"></div><div class="sk-cube2 sk-cube"></div><div class="sk-cube4 sk-cube"></div><div class="sk-cube3 sk-cube"></div></div></div>'),upFileType="other",t.onloadend=function(){(-1<(extension=t.result.split("base64,")[0]).indexOf("jpg")||-1<extension.indexOf("png")||-1<extension.indexOf("png")||-1<extension.indexOf("gif")||-1<extension.indexOf("jpeg")||-1<extension.indexOf("pjpeg")||-1<extension.indexOf("x-png"))&&(upFileType="image"),dataToBeSent=t.result.split("base64,")[1],$.post(url,{data:dataToBeSent}).done(function(e){el.parent().hide(),("image"==upFileType?el.parent().parent().find(".img-value:eq(0)").removeClass("hidden").attr("src",baseUrl+e).attr("data-src",baseUrl+e).attr("data-value",baseUrl+e):el.parent().parent().find(".img-value:eq(0)").removeClass("hidden").attr("src",baseUrl+"modules/ndk_advanced_custom_fields/views/img/file_picto.png").attr("data-value",baseUrl+e).addClass("pictoFileUpload")).trigger("click"),el.parent().parent().find(".remove-upload").show(),$("#ndkloader").fadeOut().remove()})},t.readAsDataURL(this.files[0])):uploadForSafari(e,$(this)),killer=$(this).parent().parent().parent().attr("data-killer"),0<parseFloat(killer)&&($(".form-group[data-field='"+killer+"'] .doneOption").remove(),$(".form-group[data-field='"+killer+"']").append('<span class="doneOption"></span>'),$(".form-group[data-field='"+killer+"']").find(".ndk-select").val("Oui").trigger("change"))}),$(document).on("click",".remove-upload",function(e){e.preventDefault(),group=$(this).parent().find(".img-value").attr("data-group"),$(this).parent().find(".img-value").addClass("hidden"),$(this).parent().parent().find(".uploader").show(),$("input#ndkcsfield_"+group).val("").trigger("keyup"),$("#visual_"+group).remove(),$(this).hide(),updatePriceNdk(0,group),$("#layer-edit-"+group).remove(),killer=$(".form-group[data-field='"+group+"']").attr("data-killer"),$(".form-group[data-field='"+killer+"']").find(".ndk-select").val("Non").trigger("change"),$(".form-group[data-field='"+killer+"'] .doneOption").remove()}),$("tr.customization > .cart_quantity").html(""),$(document).on("click",".ndkzoom",function(e){e.preventDefault(),$(".resetZones").trigger("click"),convertPercent(),$.prototype.fancybox&&$.fancybox.open([{type:"inline",autoScale:!1,minHeight:30,width:"80%",height:"80%",showCloseButton:!1,autoDimensions:!1,content:'<div class="popupPreviewContainer clear clearfix">'+$("#image-block").html()+"</div>",beforeShow:function(){$(".popupPreviewContainer .svggradient, .popupPreviewContainer .svgfilter").remove()}}],{padding:0})}),"undefined"!=typeof is_visual&&1==is_visual&&$(document).on("click","#image-block",function(e){return e.preventDefault(),!1}),$(document).on("click",".visual-effect",function(){visu=$(this).attr("data-src"),group=$(this).attr("data-group"),zindex=$(this).attr("data-zindex"),dragdrop=$(this).attr("data-dragdrop"),resizeable=$(this).attr("data-resizeable"),rotateable=$(this).attr("data-rotateable"),view=$(this).attr("data-view"),coloreffect="normal",background="",type=!1,$(this).hasClass("img-value")&&(coloreffect=$(this).attr("data-blend"),void 0!==$(this).attr("data-mask-image"))&&""!=$(this).attr("data-mask-image")&&(type="colorize",background=$(this).attr("data-src"),visu=$(this).attr("data-mask-image")),$(this).hasClass("color-ndk")&&(type="color",coloreffect=$(this).attr("data-blend"),$(this).hasClass("colorize-ndk")&&(type="colorize",background=$(this).attr("data-color")),void 0!==$(this).attr("data-mask-image"))&&""!=$(this).attr("data-mask-image")&&(type="colorize",background=$(this).attr("data-color"),visu=$(this).attr("data-mask-image")),!$(this).hasClass("accessory-ndk")||(group=group+"-"+$(this).attr("data-id-product-value"),0==visu&&(visu=$(this).find(".accessory-img-block img").attr("src")),0<$(this).find(".ndk-accessory-quantity:eq(0)").val())?designCompo(visu,group,view,zindex,dragdrop,resizeable,rotateable,0,0,type,coloreffect,background):($("#visual_"+group).remove(),$("#layer-edit-"+group).remove(),$(this).find(".selected-value").removeClass("selected-value"))}),$(document).on("change",".visual-effect-select",function(){visu=$(this).find("option:selected").attr("data-src"),group=$(this).find("option:selected").attr("data-group"),zindex=$(this).find("option:selected").attr("data-zindex"),dragdrop=$(this).find("option:selected").attr("data-dragdrop"),resizeable=$(this).find("option:selected").attr("data-resizeable"),rotateable=$(this).find("option:selected").attr("data-rotateable"),view=$(this).find("option:selected").attr("data-view"),designCompo(visu,group,view,zindex,dragdrop,resizeable,rotateable,0,0,!1),"undefined"==typeof visu&&$("#visual_"+group+", #layer-edit-"+group).remove()}),0==letOpen?$(document).on("click",".toggler",function(){toggler=$(this),thisFieldPane=$(this).parent().find(".fieldPane"),$(".fieldPane:visible").not(thisFieldPane).hide(),$.when($(this).parent().find(".fieldPane").toggle()).then(function(){$(this).parent().find(".fieldPane").is(":visible")?(toggler.addClass("active"),toggler.find(".toggleText").html(toggleCloseText)):(toggler.removeClass("active"),toggler.find(".toggleText").html(toggleOpenText)),scrollToNdk($(this).parent(),800)}),$(".ndkQuickAccessBox-item").removeClass("active"),$(".ndkQuickAccessBox-item[data-target='"+$(this).parent().attr("data-field")+"']").addClass("active")}):$(".toggler").addClass("letOpen"),$(document).on("click",".color-ndk",function(){$('.img-value[data-default-value="1"]').trigger("click"),ActiveFieldNDK(this),group=$(this).attr("data-group"),$("#temporary-ndk-color-image-"+group).remove(),view=$(this).attr("data-view"),price=$(this).attr("data-price"),$(this).hasClass("color_square")||(updatePriceNdk(price,group),setImgValue($(this),group)),$(this).parent().find(".color-ndk").removeClass("selected-color"),$(this).addClass("selected-color"),myel=$(this),"null"==$(this).attr("data-quantity-available")||$(this).hasClass("color_square")||updateQuantityForValue(myel.attr("data-quantity-available"),group),container=0<$(".zone_limit[data-group='"+group+"']").length&&0<$(".view_tab[data-view='"+view+"']").length?".zone_limit[data-group='"+group+"']":"#image-block",$(this).hasClass("visual-effect")&&"0"==$(this).attr("data-src")&&(-1<$(this).attr("data-color").indexOf("url")?(uri=$(this).attr("data-color").replace("url('","").replace("')",""),$(this).attr("data-color",uri)):(svg='<svg xmlns="http://www.w3.org/2000/svg" width="'+$(container).width()+'" height="'+$(container).height()+'"><rect width="'+$(container).width()+'" height="'+$(container).height()+'" style="fill:rgb('+hexToRgb($(this).attr("data-color"))+');"></rect></svg>',uri="data:image/svg+xml;base64,"+window.btoa(svg)),myel.attr("data-src",uri).trigger("click")),ProgressBar()}),$(document).on("click, change",".ndk-radio",function(){group=$(this).attr("data-group"),checkedRadio=$(".ndk-radio[data-group='"+group+"']:checked"),$(".form-group[data-field='"+group+"']").find(".selected_radio").removeClass("selected_radio"),checkedRadio.parent().addClass("selected_radio"),updatePriceNdk(price=checkedRadio.attr("data-price"),group),"null"!=checkedRadio.attr("data-quantity-available")&&updateQuantityForValue(checkedRadio.attr("data-quantity-available"),group),checkFieldRestrictions(checkedRadio.attr("data-id-value"),group),ProgressBar()}),$(document).on("change",".ndk-select",function(){group=$(this).find("option:selected").attr("data-group"),updatePriceNdk(price=$(this).find("option:selected").attr("data-price"),group),"null"!=$(this).find("option:selected").attr("data-quantity-available")&&updateQuantityForValue($(this).find("option:selected").attr("data-quantity-available"),group),checkFieldRestrictions($(this).find("option:selected").attr("data-id-value"),group)}),$(document).on("change",".arcText",function(){$texteditor=$(".textarea"),(val=680<(val=$(this).val())?1e4:val)<-680&&(val=-1e4),$texteditor.circleType({radius:val}),ghoape(".textarea")}),$(document).on("click",".visible_layer",function(){hideLayer($(this))}),$(document).on("click",".hidden_layer",function(){showLayer($(this))}),$(document).on("click",".submitSimpleText",function(){group=$(this).parent().find(".visual-text").attr("data-group"),zindex=$(this).parent().find(".visual-text").attr("data-zindex"),price=$(this).parent().find(".visual-text").attr("data-price"),ppcprice=$(this).parent().find(".visual-text").attr("data-ppcprice"),view=$(this).parent().find(".visual-text").attr("data-view"),dragdrop=$(this).parent().find(".visual-text").attr("data-dragdrop"),resizeable=$(this).parent().find(".visual-text").attr("data-resizeable"),rotateable=$(this).parent().find(".visual-text").attr("data-rotateable"),(charsCount=0)<$(this).parent().find("input.visual-text").length?(texte="",$(this).parent().find("input.visual-text").each(function(){""!=$(this).val()&&(texte+=$(this).val()+" ",charsCount+=$(this).val().replace(/\ /g,"").length)})):texte=$(this).parent().find("textarea").text(),""==texte||" "==texte?(price=0,texte=""):price=0<ppcprice?ppcprice*charsCount:$(this).parent().parent().find("textarea").attr("data-price"),""!=texte&&" "!=texte||(price=0,texte=""),height=$(this).parent().find(".visual-text").height(),width=$(this).parent().find(".visual-text").width(),updatePriceNdk(price,group),html2canvas($(this).parent().find(".visual-text"),{onrendered:function(e){designCompo(e.toDataURL("image/png"),group,view,zindex,dragdrop,resizeable,rotateable,width,height,!1)}})}),$(document).on("click",".submitText",function(){if(group=$(this).parent().parent().find(".ndktextarea").attr("data-group"),zindex=$(this).parent().parent().find(".textzone").attr("data-zindex"),price=$(this).parent().parent().find(".ndktextarea").attr("data-price"),ppcprice=$(this).parent().parent().find(".ndktextarea").attr("data-ppcprice"),blend=$(this).parent().parent().find(".ndktextarea").attr("data-blend"),view=$(this).parent().parent().find(".ndktextarea").attr("data-view"),dragdrop=$(this).parent().parent().find(".ndktextarea").attr("data-dragdrop"),resizeable=$(this).parent().parent().find(".ndktextarea").attr("data-resizeable"),rotateable=$(this).parent().parent().find(".ndktextarea").attr("data-rotateable"),coloreffect=$(this).parent().parent().find(".ndktextarea").attr("data-blend"),svgPath="",svgPath=$(this).parent().parent().find(".ndktextarea").attr("data-path"),charsCount=0,inputNumber=$(this).parent().find(".noborder").length,separator=1<inputNumber?" \n ":"",0<$(this).parent().find(".noborder").length?(texte="",$(this).parent().find(".noborder").each(function(){""!=$(this).val()&&(texte+=$(this).val()+separator,charsCount+=$(this).val().replace(/\ /g,"").length)})):texte=$(this).parent().find(".textarea").text(),""==texte||" "==texte?(price=0,texte=""):price=0<ppcprice?ppcprice*charsCount:$(this).parent().parent().find(".ndktextarea").attr("data-price"),$(this).parent().parent().find(".ndktextarea").val(texte).trigger("keyup"),""!=texte&&$(this).parent().find(".fontSelectUl li.active").trigger("click"),""!=texte&&" "!=texte||(price=0,texte=""),verticalPadding=10,horizontalPadding=0,$(this).parent().find(".status_counter").hide(),$(this).parent().find(".noborder").css("position","relative"),height=$(this).parent().find(".textarea").innerHeight()-parseFloat(verticalPadding),width=$(this).parent().find(".textarea").innerWidth()-parseFloat(horizontalPadding)-scrollbarWidth,$(this).parent().find(".noborder").css("position",""),updatePriceNdk(price,group),$(".status_counter").hide(),0<$(".zone_limit[data-group='"+group+"']").length&&0<$(".view_tab[data-view='"+view+"']").length&&0<$(this).parent().find("textarea.noborder").length&&(container=".zone_limit[data-group='"+group+"']",zwidth=$(container).width(),zheight=$(container).height(),0<zwidth&&0<zheight&&$(this).parent().find(".textarea").css({width:zwidth}),height=zheight,width=zwidth),svglines="",fontSize=parseFloat($(this).parent().css("font-size")),alignment=$(this).parent().find(".texteditor").css("text-align"),x=10,txtanchord='text-anchor="start"',startOffset=' startOffset="50%"',"left"==alignment?(x=10,txtanchord='text-anchor="start"',startOffset=' startOffset="0%"'):"center"==alignment?(x=width/2,txtanchord='text-anchor="middle"',startOffset=' startOffset="50%"'):"right"==alignment&&(x=width,txtanchord='text-anchor="end"',startOffset=' startOffset="100%"'),0==svgPath&&(svgPath=""),0<$(this).parent().find("textarea.noborder").length){var e=$(this).parent().find("textarea.noborder").val().split("\n");y=1,onlyText="";for(var t=0;t<e.length;t++)""!=svgPath?svglines+='<textPath style="z-index:'+zindex+';" '+txtanchord+startOffset+' xlink:href="#'+svgPath+'">'+e[t]+"</textPath>":svglines+="<tspan "+txtanchord+' x="'+x+'" y="'+fontSize*y+'">'+e[t].escape()+"</tspan>",y++;textToWrite=$(this).parent().find("textarea.noborder").val()}else textToWrite="",y=1,$(this).parent().find(".noborder").each(function(){""!=svgPath?(textToWrite+='<textPath style="z-index:'+zindex+';" '+txtanchord+startOffset+'  xlink:href="#'+svgPath+'">'+$(this).val()+"</textPath>",onlyText=$(this).val()):textToWrite+=$(this).val()+" \n ",y++});style=$(this).parent().attr("style").replace('"',"'").replace('"',"'"),fontSize=parseInt($(this).parent().find(".texteditor").css("font-size")),fontFamily=(fontFamily=$(this).parent().find(".texteditor").css("font-family")).replace('"',"'").replace('"',"'");var i=!1,a=[];a.effect="",a.fill="",a.fillLight="",a.fillShadow="",a="rgb(255, 215, 0)"==$(this).parent().find(".texteditor").css("color")?(i=!0,metaleffect("#efd8a2","#a28156","#efd8a2","#2f1f05","#fff3c6",group,textToWrite,width,height,fontFamily,fontSize,i,!1)):"rgb(192, 192, 192)"==$(this).parent().find(".texteditor").css("color")?(i=!0,metaleffect("#888888","#dedede","#F5F5F5","#444444","#dedede",group,textToWrite,width,height,fontFamily,fontSize,i,!1)):"concavMe"==$(this).parent().find(".texteditor").attr("data-effect")?(color1=$(this).parent().find(".texteditor").css("color"),color2=darkerColor($(this).parent().find(".texteditor").css("color"),.2),shadowcolor=darkerColor($(this).parent().find(".texteditor").css("color"),.4),lightcolor=lighterColor($(this).parent().find(".texteditor").css("color"),.2),strokecolor=lighterColor($(this).parent().find(".texteditor").css("color"),.2),i=!0,metaleffect(color2,color1,strokecolor,lightcolor,shadowcolor,group,textToWrite,width,height,fontFamily,fontSize,i,!1)):"convexMe"==$(this).parent().find(".texteditor").attr("data-effect")?(color1=$(this).parent().find(".texteditor").css("color"),color2=lighterColor($(this).parent().find(".texteditor").css("color"),.2),shadowcolor=darkerColor($(this).parent().find(".texteditor").css("color"),.2),lightcolor=lighterColor($(this).parent().find(".texteditor").css("color"),.3),strokecolor=darkerColor($(this).parent().find(".texteditor").css("color"),.2),i=!0,metaleffect(color1,color2,strokecolor,shadowcolor,lightcolor,group,textToWrite,width,height,fontFamily,fontSize,i,!1)):""!=$(this).parent().find(".texteditor").attr("data-texture")?(color1=$(this).parent().find(".texteditor").css("color"),color2=darkerColor($(this).parent().find(".texteditor").css("color"),.2),shadowcolor=darkerColor($(this).parent().find(".texteditor").css("color"),.4),lightcolor=lighterColor($(this).parent().find(".texteditor").css("color"),.2),strokecolor=lighterColor($(this).parent().find(".texteditor").css("color"),.2),i=!1,texture=$(this).parent().find(".texteditor").attr("data-texture").replace('url("',"").replace('")',""),metaleffect(color2,color1,strokecolor,lightcolor,shadowcolor,group,textToWrite,width,height,fontFamily,fontSize,i,texture)):(color1=$(this).parent().find(".texteditor").css("color"),"undefined"==typeof(strokecolor=$(this).parent().find(".texteditor").attr("stroke-color"))&&(strokecolor="transparent"),i=!1,metaleffect(color1,color1,strokecolor,"transparent","transparent",group,textToWrite,width,height,fontFamily,fontSize,i,!1,!0)),""!=svgPath&&"undefined"!=typeof svgPath&&0!=svgPath&&$(this).parent().parent().find(".ndktextarea").hasClass("visual-effect")?($("#svgText_"+group).remove(),$("#svgUse_"+group).remove(),$(".ndk-svg-view:visible > svg > [data-group-text='"+group+"']").remove(),writeCurve=$(".ndk-svg-view:visible > svg ").append(a.textPathEffect+'<text data-font-family="'+fontFamily+'" data-group-text="'+group+'" id="svgText_'+group+'" style="font-family:'+fontFamily+" ;font-size:"+fontSize+"px;fill:"+a.fill+";z-index:"+zindex+';" >'+textToWrite+"</text>"),$.when(writeCurve).then(function(){setTimeout(function(){$("#ndk-svg-view-"+view+" > svg").html($("#ndk-svg-view-"+view+" > svg").html()),$("#ndk-svg-view-"+view).css("z-index",zindex).css("mix-blend-mode",coloreffect)},500)})):$(this).parent().parent().find(".ndktextarea").hasClass("visual-effect")&&designCompo(a.svg,group,view,zindex,dragdrop,resizeable,rotateable,width,height,"svg",blend),0<$(this).parent().find("textarea.noborder").length&&"undefined"!=typeof textToWrite&&""!=textToWrite&&(svg_textMultiline("svgText_"+group,textToWrite.replace(/\n/g," ± "),width,fontSize,txtanchord,x),svg_textMultiline("svgText_"+group+"-shadow",textToWrite.replace(/\n/g," ± "),width,fontSize,txtanchord,x),svg_textMultiline("svgText_"+group+"-light",textToWrite.replace(/\n/g," ± "),width,fontSize,txtanchord,x)),$(this).parent().parent().parent().find(".fontColorSelectUl li.active").trigger("click")}),$(document).on("keyup",".textarea",function(){clearTimeout(typingTimer),button=$(this).parent().parent().find(".submitText"),typingTimer=setTimeout(function(){},doneTypingInterval)}),$(document).on("keyup",".visual-text",function(){clearTimeout(typingTimer),button=$(this).parent().find(".submitSimpleText"),typingTimer=setTimeout(function(){button.trigger("click")},doneTypingInterval)}),$(document).on("click",".svg-container",function(){group=$(this).parent().find("img").attr("data-group"),zindex=$(this).parent().find("img").attr("data-zindex"),price=$(this).parent().find("img").attr("data-price"),view=$(this).parent().find("img").attr("data-view"),blend=$(this).parent().find("img").attr("data-blend"),dragdrop=$(this).parent().find("img").attr("data-dragdrop"),resizeable=$(this).parent().find("img").attr("data-resizeable"),rotateable=$(this).parent().find("img").attr("data-rotateable"),height=(0<$(".zone_limit[data-group='"+group+"']").length?(width=$(".zone_limit[data-group='"+group+"']").innerWidth(),$(".zone_limit[data-group='"+group+"']")):(width=$("#image-block").innerWidth(),$("#image-block"))).innerHeight(),updatePriceNdk(price,group),$(this).parent().parent().parent().find(".remove-img-item").show(),"null"!=$(this).parent().find("img").attr("data-quantity-available")&&updateQuantityForValue($(this).parent().find("img").attr("data-quantity-available"),group),clonedSvg=$(this).find("svg").clone(),0<$(this).parent().find("img.visual-effect").length&&designCompo(clonedSvg,group,view,zindex,dragdrop,resizeable,rotateable,width,height,"svg",blend),setImgValue($(this).parent().find("img"),group),$(this).parent().parent().parent().find(".img-value").removeClass("selected-value"),$(this).parent().parent().parent().find(".svg-container").removeClass("selected-svg"),$(this).addClass("selected-svg"),equalheight(".svg-container"),$(".view_tab.activeView").trigger("click")}),$(document).on("click",".editIt",function(){isItem=!1,el=$(this).parent(),-1<(group=el.attr("id").replace("visual_","")).indexOf("-")&&(isItem=!0,number=group.split("-")[1],group=itemGroup=group.split("-")[0]),$("#ndkcsfields .toggler").removeClass("active"),0==parseInt(letOpen)&&$("#ndkcsfields .fieldPane").hide(),scrollToNdk(formGroup=$(".form-group[data-field='"+group+"']"),800),1==makeSlide&&($(".sliderBlock .ndkackFieldItem").removeClass("activeItem"),formGroup.addClass("activeItem")),formGroup.find(".toggler:not(.active)").trigger("click"),isItem&&(scrollToNdk(formGroup.find(".designer-item[data-number='"+number+"']"),800),$(".designer-item[data-number='"+number+"']").show())}),$(document).on("click",".view_tab",function(){$(".resetZones").trigger("click"),scrollToNdk($(".primary_block"),800),$("#image-block").find(".ndk-svg-view").hide(),$("#image-block").attr("data-view",$(this).attr("data-view")).attr("data-id",$(this).attr("data-id")),$(".groupFieldBlock").css("padding-bottom",$(".sliderBlock .ndkackFieldItem:visible:eq(0)").height()),0<$("#ndkcsfieldSVGView_"+$(this).attr("data-view")).length&&(svgImage=$("#ndkcsfieldSVGView_"+$(this).attr("data-view")).find("image").attr("xlink:href"),$("#bigpic").attr("src",svgImage),0==$("#ndk-svg-view-"+$(this).attr("data-view")).length)&&$.when($("#image-block").append('<div class="ndk-svg-view" id="ndk-svg-view-'+$(this).attr("data-view")+'">'+$("#ndkcsfieldSVGView_"+$(this).attr("data-view")).html()+"</div>")).done(function(){$("#ndk-svg-view-"+$(this).attr("data-view")).find("image").remove()}),0<$("#ndk-svg-view-"+$(this).attr("data-view")).length?$("#ndk-svg-view-"+$(this).attr("data-view")).show():$("#bigpic").attr("src",$(this).attr("data-img")),$("#ndkcsfields-block .form-group").hide(),$(".form-group[data-view='"+$(this).attr("data-view")+"'], .form-group[data-view='0']").show(),$(".form-group[data-view*='"+$(this).attr("data-view")+"|']").show(),$(".form-group[data-view*='|"+$(this).attr("data-view")+"']").show(),$(".editThisLayer").hide(),$(".editThisLayer[data-view='"+$(this).attr("data-view")+"'], .editThisLayer[data-view='0']").show(),$(".editThisLayer[data-view*='"+$(this).attr("data-view")+"|']").show(),$(".editThisLayer[data-view*='|"+$(this).attr("data-view")+"']").show(),1!=makeSlide||$(this).hasClass("activeView")||($(".ndkcfPagerItem").hide(),$(".ndkcfPagerItem[data-view='"+$(this).attr("data-view")+"'], .ndkcfPagerItem[data-view='0']").show(),$(".ndkcfPagerItem[data-view*='"+$(this).attr("data-view")+"|']").show(),$(".ndkcfPagerItem[data-view*='|"+$(this).attr("data-view")+"']").show(),ndkCfShowSlide($(".sliderBlock .ndkackFieldItem:visible:eq(0)"))),$(".view_tab").removeClass("activeView"),$(this).addClass("activeView"),$(".absolute-visu").hide(),$(".zone_limit").hide(),$(".absolute-visu.view-"+$(this).attr("data-view")).show(),$(".zone_limit.view-"+$(this).attr("data-view")).show(),$("[class*='"+$(this).attr("data-view")+"|']").show(),$("[class*='|"+$(this).attr("data-view")+"']").show(),$(".absolute-visu.view-0").show(),$(".zone_limit.view-0").show(),$(".layer_view").addClass("visible_layer").removeClass("hidden_layer")}),$(document).on("keyup",'#ndkcsfields-block input[type="text"]',function(){"search_query_top"!=$(this).attr("id")&&(""!=$(this).val()?$(this).attr("size",$(this).val().length+5):$(this).attr("size",15),$(this).parent().css("width",$(this).innerWidth))}),$(document).on("click",".fontSelectUl li, .fontColorSelectUl li, .fontSizeSelectUl li",function(){input=$(this).parent().parent().parent().find(".ndktextarea"),color=$(this).parent().parent().find(".fontColorSelectUl li.active").text(),font=$(this).parent().parent().find(".fontSelectUl li.active").text(),0<$(this).parent().parent().find(".noborder").length?(texte="",inputNumber=input.parent().find(".noborder").length,separator=1<inputNumber?" \n ":"",$(this).parent().parent().find(".noborder").each(function(){texte+=$(this).val()+separator})):texte=$(this).parent().parent().find(".ndktextarea").text(),0<(charsCount=texte.replace(/\ /g,"").length)?input.val(texte+" ["+color+" - "+font+"]").trigger("keyup"):input.val("")}),$(document).on("click",".quantity-ndk-plus",function(e){e.preventDefault(),targetClass=void 0!==$(this).attr("data-target-class")?"."+$(this).attr("data-target-class"):".ndk-accessory-quantity",input=$(this).parent().find(targetClass),step=void 0!==input.attr("step")?parseFloat(input.attr("step")):1,currentVal=parseInt($(this).parent().find(targetClass).val()),quantityAvailableNdk=0<$(this).parent().find(targetClass).attr("data-qtty-available")?$(this).parent().find(targetClass).attr("data-qtty-available"):1e8,quantityMaxNdk=0<$(this).parent().find(targetClass).attr("data-qtty-max")?$(this).parent().find(targetClass).attr("data-qtty-max"):quantityAvailableNdk,(!isNaN(currentVal)&&currentVal+step<quantityAvailableNdk&&currentVal<quantityMaxNdk?$(this).parent().find(targetClass).val(currentVal+step):$(this).parent().find(targetClass).val(quantityMaxNdk)).trigger("keyup").trigger("change"),""!=input.attr("data-step_quantity")&&(stepQtty=input.attr("data-step_quantity").split(";").map(Number),val=parseInt(input.val()),-1==$.inArray(val,stepQtty))&&input.val(goToStepQuantity(val,stepQtty,"+")).trigger("keyup").trigger("change")}),$(document).on("click",".quantity-ndk-minus",function(e){e.preventDefault(),targetClass=void 0!==$(this).attr("data-target-class")?"."+$(this).attr("data-target-class"):".ndk-accessory-quantity",input=$(this).parent().find(targetClass),step=void 0!==input.attr("step")?parseFloat(input.attr("step")):1,currentVal=parseInt($(this).parent().find(targetClass).val()),quantityMinNdk=0<$(this).parent().find(targetClass).attr("data-qtty-min")?$(this).parent().find(".ndk-accessory-quantity").attr("data-qtty-min"):0,(""!=input.attr("data-step_quantity")?(stepQtty=input.attr("data-step_quantity").split(";").map(Number),val=parseInt(input.val()),input.val(goToStepQuantity(val,stepQtty,"-"))):!isNaN(currentVal)&&currentVal-step>quantityMinNdk?$(this).parent().find(targetClass).val(currentVal-parseFloat(step)):$(this).parent().find(targetClass).val(quantityMinNdk)).trigger("keyup").trigger("change")}),$(document).on("click",".ndkcfTitle",function(e){}),$(document).on("click",".userPanelTitle",function(e){$(".userPanel").toggle()}),$(document).on("change",".ndk-accessory-quantity[data-step_quantity!='']",function(e){""!=$(this).attr("data-step_quantity")&&(stepQtty=$(this).attr("data-step_quantity").split(";").map(Number),val=parseInt($(this).val()),-1==$.inArray(val,stepQtty))&&$(this).val(goToStepQuantity(val,stepQtty,"+")).trigger("keyup")}),$(document).on("change",".ndk-accessory-quantity",function(e){setAccessoryCustomization($(this)),$(this).trigger("keyup")}),$(document).on("click",".trigger-close-fancybox",function(e){e.preventDefault(),$(".fancybox-close").trigger("click")}),$(document).on("keyup",".ndk-accessory-quantity[value!='0'], .ndk-accessory-quantity-block .ndk-accessory-quantity",function(e){rootBlock=$(".form-group[data-field='"+$(this).attr("data-group")+"']"),qttyCheckNode=rootBlock,current_row=$(this).attr("data-id-product-accessory"),rowNode=$(".form-group[data-field='"+$(this).attr("data-group")+"']").find(".accessory-ndk[data-id-product-value='"+current_row+"']"),0==(max=parseInt(rootBlock.attr("data-qtty-max")))&&(max=parseInt(rowNode.attr("data-qtty-max")),qttyCheckNode=rowNode),max_weight=parseFloat(rootBlock.attr("data-weight-max")),(max_weight=0)==max&&(max=9999999999),0==max_weight&&(max_weight=9999999999),0==(min=parseInt(rootBlock.attr("data-qtty-min")))&&(min=parseInt(rowNode.attr("data-qtty-min")),qttyCheckNode=rowNode),0==(min_weight=parseFloat(rootBlock.attr("data-weight-min")))&&(min_weight=parseInt(rowNode.attr("data-weight-min")),qttyCheckNode=rowNode),qtty_total=0,weight_total=0,rootBlock.find(".quantity_error_up").fadeOut().delay(1e4),qttyCheckNode.find(".ndk-accessory-quantity[value!=0]").each(function(){qtty_total+=parseInt($(this).val()),weight_total+=parseInt($(this).val())*parseFloat($(this).attr("data-weight"))}),weight_total=weight_total.toPrecision(3),(parentBlock=rootBlock.find(".accessory-ndk[data-id-product-value='"+$(this).attr("data-id-product-accessory")+"']")).addClass("selected-product-accessory"),id_product=$(this).attr("data-id-product-accessory"),$("#attribute_combination_"+id_product).trigger("change"),rootBlock.find(".total_weight").html(parseFloat(weight_total).toFixed(3)),rootBlock.find(".total_qtty").html(parseInt(qtty_total)),parseFloat(weight_total)>=parseFloat(min_weight)?rootBlock.find(".weight_error_down").removeClass("required_field").fadeOut():rootBlock.find(".weight_error_down").addClass("required_field"),parseInt(qtty_total)>parseInt(max)?(rootBlock.find(".quantity_error_up").show(),$(this).parent().find(".quantity-ndk-minus").trigger("click")):parseFloat(weight_total)>parseFloat(max_weight)?(rootBlock.find(".weight_error_up").show(),$(this).parent().find(".quantity-ndk-minus").trigger("click")):(qtty=parseInt(this.value),unitPrice=$(this).attr("data-price"),group=$(this).attr("data-group"),price=qtty*unitPrice,valueId=$(this).attr("data-value-id"),name=$(this).attr("data-value"),0==$(this).val()?($(".disabled_value_by_"+group).removeClass("disabled_value_by_"+group),parentBlock.removeClass("selected-product-accessory")):checkFieldRestrictions($(this).attr("data-id-value")+"["+qtty+"]",group),id_product=$(this).attr("data-id-product-accessory"),id_combination=$(this).attr("data-id_combination"),t=$(this),qtty=t.hasClass("ndk-accessory-comb-tab")?(qtty_total=0,parentBlock=$(".form-group[data-field='"+group+"']"),targets=t.hasClass("ndk-accessory-comb-tab")?".ndk-accessory-quantity[value!=0][data-id-value="+t.attr("data-id-value")+"]":".ndk-accessory-quantity[value!=0]",parentBlock.find(targets).each(function(){qtty_total+=parseInt($(this).val())}),$("#ndkcf_totalprod_quantity_"+t.attr("data-id-value")).val(qtty_total).trigger("change"),attrBlock=t.parent().parent().parent(),qtty_total_attr=0,attrBlock.find(".ndk-accessory-quantity[value!=0]").each(function(){qtty_total_attr+=parseInt($(this).val())}),attrBlock.parent().find(".color_counter").html(qtty_total_attr),qtty_total):$(this).val(),t.hasClass("price_overrided")?updatePriceNdk(price,valueId):(0<qtty&&id_combination,loadAccessoryAttrPrice(id_product,id_combination,qtty,t)));var t=$(this);1==displayPriceHT&&0<qtty&&($(".final_price_"+t.attr("data-id-value")+" .priceht").remove(),$(".final_price_"+t.attr("data-id-value")).append('<span class="priceht clear clearfix"></span>'),getPriceHt(t.attr("data-price"),".final_price_"+t.attr("data-id-value")+" .priceht"))}),$(document).on("change",".ndk-checkbox",function(e){qtty=1,unitPrice=$(this).attr("data-price"),group=$(this).attr("data-group"),price=qtty*unitPrice,valueId=$(this).attr("data-value-id"),name=$(this).attr("data-value"),$(this).is(":checked")?(checkFieldRestrictions($(this).attr("data-value-id"),group),updatePriceNdk(price,valueId)):($(".disabled_value_by_"+group).removeClass("disabled_value_by_"+group),updatePriceNdk(0,valueId))}),$(document).on("click",".img-value",function(){group=$(this).attr("data-group"),updatePriceNdk(price=$(this).attr("data-price"),group),"null"!=$(this).attr("data-quantity-available")&&updateQuantityForValue($(this).attr("data-quantity-available"),group),setImgValue($(this),group),$(this).parent().parent().parent().find(".remove-img-item").show(),ProgressBar()}),$.fn.ndkSubmit=function(e){if("function"==typeof $.fn.ndkSubmit_Override)return $.fn.ndkSubmit_Override(e);var t,i;if(t)return!0;($('input.ndk-accessory-quantity[data-group="2982"]').length||$('input.ndk-accessory-quantity[data-group="2983"]').length)&&(i=0,$.each($('input.ndk-accessory-quantity[data-group="2982"], input.ndk-accessory-quantity[data-group="2983"]'),function(){i+=parseInt($(this).attr("value"))}),0==i?($("p[data-name='ndkcsfield[2983]']").remove(),$(".form-group[data-field='2983']").find(".fieldPane").append('<p data-name="ndkcsfield[2983]" class="alert-danger clear clearfix quantity_error_down  required_field" val="" style="display: block;">Vous devez ajouter un minimum de 1 quantités</p>'),$(".form-group[data-field='2983']").css("background","#F2DEDE").focus(),$("p[data-name='ndkcsfield[2982]']").remove(),$(".form-group[data-field='2982']").find(".fieldPane").append('<p data-name="ndkcsfield[2982]" class="alert-danger clear clearfix quantity_error_down  required_field" val="" style="display: block;">Vous devez ajouter un minimum de 1 quantités</p>'),$(".form-group[data-field='2982']").css("background","#F2DEDE").focus(),e.preventDefault()):($("p[data-name='ndkcsfield[2983]']").remove(),$("p[data-name='ndkcsfield[2982]']").remove(),$(".form-group[data-field='2982']").css("background","#FFFFFF").focus(),$(".form-group[data-field='2983']").css("background","#FFFFFF").focus()));var a=$(this),r=$(".form-group:not([class*='disabled_value_by'])").find(".required_field");return $i=0,r.each(function(){rootBlock="";if(verificaCampo=$(this).parent().parent().parent().attr("data-typefield"),-1===$.inArray(verificaCampo,["11","23","17","24"])&&(val=$(this).hasClass("quantity_error_down")||$(this).hasClass("quantity_error_up")?(group=$(this).parent().parent().parent().attr("data-field"),$(this).attr("val")):(group=(group=(group=(void 0!==$(this).attr("data-name")?$(this).attr("data-name"):$(this).attr("name")).split("ndkcsfield["))[1].split("]"))[0],$(this).val())),rootBlock=$(".form-group[data-field='"+group+"']:not(.submitContainer)"),$(this).is(":radio"))if($k=1,rootBlock.find(".error").remove(),others=rootBlock.find('input[type="radio"]'),$(this).is(":checked")){for(var e=0;e<others.length;e++)$i+=1,$k+=1;rootBlock.removeClass("focusRequired"),rootBlock.find(".error").remove()}else(c=rootBlock.find('input[type="radio"]:checked').length)<1?(rootBlock.addClass("focusRequired").focus(),rootBlock.find(".error").remove(),$(".view_tab[data-view='"+rootBlock.attr("data-view")+"']").trigger("click"),1==makeSlide&&ndkCfShowSlide(rootBlock),scrollToNdk($(this),800),rootBlock.parent().hasClass("groupFieldBlock")&&(targetButtonPack=$(".toggleGroupField[target='#"+rootBlock.parent().attr("id")+"']")).trigger("click"),void 0!==$(this).attr("data-message")&&"undefined"!=$(this).attr("data-message")&&rootBlock.find(".fieldPane").append('<span class="error alert-danger clear clearfix">'+$(this).attr("data-message")+"</span>")):(rootBlock.removeClass("focusRequired"),rootBlock.find(".error").remove());else if($(this).is(":checkbox"))if($k=0,group=$(this).attr("data-group"),rootBlock.find(".error").remove(),others=rootBlock.find('input[type="checkbox"]'),$(this).is(":checked")){for(e=0;e<others.length;e++)$i++,$k++;rootBlock.removeClass("focusRequired"),rootBlock.find(".error").remove()}else $k<others.length&&(rootBlock.addClass("focusRequired").focus(),$(".view_tab[data-view='"+rootBlock.attr("data-view")+"']").trigger("click"),1==makeSlide&&ndkCfShowSlide(rootBlock),scrollToNdk($(this),800),rootBlock.parent().hasClass("groupFieldBlock")&&(targetButtonPack=$(".toggleGroupField[target='#"+rootBlock.parent().attr("id")+"']")).trigger("click"),void 0!==$(this).attr("data-message"))&&"undefined"!=$(this).attr("data-message")&&rootBlock.find(".fieldPane").append('<span class="error alert-danger clear clearfix">'+$(this).attr("data-message")+"</span>");else $(this).is("select")?val?($i++,rootBlock.removeClass("focusRequired"),rootBlock.find(".error").remove()):(rootBlock.addClass("focusRequired").focus(),rootBlock.find(".fieldPane").show().find(".error").remove(),$(".view_tab[data-view='"+rootBlock.attr("data-view")+"']").trigger("click"),1==makeSlide&&ndkCfShowSlide(rootBlock),scrollToNdk($(this),800),rootBlock.parent().hasClass("groupFieldBlock")&&(targetButtonPack=$(".toggleGroupField[target='#"+rootBlock.parent().attr("id")+"']")).trigger("click"),void 0!==$(this).attr("data-message")&&"undefined"!=$(this).attr("data-message")&&rootBlock.find(".fieldPane").append('<span class="error alert-danger clear clearfix">'+$(this).attr("data-message")+"</span>"),$(this).is("p")&&$(this).show(),rootBlock.parent().parent().hasClass("ac_container")&&($("#"+rootBlock.parent().parent().attr("data-button-id")).trigger("click"),rootBlock.parent().parent().find(".fieldPane").show())):""==val||": "==val.slice(-2)?(rootBlock.addClass("focusRequired").focus(),rootBlock.find(".fieldPane").show().find(".error").remove(),$(".view_tab[data-view='"+rootBlock.attr("data-view")+"']").trigger("click"),1==makeSlide&&ndkCfShowSlide(rootBlock),scrollToNdk($(this),800),rootBlock.parent().hasClass("groupFieldBlock")&&(targetButtonPack=$(".toggleGroupField[target='#"+rootBlock.parent().attr("id")+"']")).trigger("click"),void 0!==$(this).attr("data-message")&&"undefined"!=$(this).attr("data-message")&&rootBlock.find(".fieldPane").append('<span class="error alert-danger clear clearfix">'+$(this).attr("data-message")+"</span>"),$(this).is("p")&&$(this).show(),rootBlock.parent().parent().hasClass("ac_container")&&($("#"+rootBlock.parent().parent().attr("data-button-id")).trigger("click"),rootBlock.parent().parent().find(".fieldPane").show())):($i++,rootBlock.removeClass("focusRequired"),rootBlock.find(".error").remove())}),$i>=r.length?t?checkEmptyForm(e):void checkRecommends(a,e):(r=$("div.focusRequired:not([class*='disabled_value_by'])").first().offset(),$("html, body").animate({scrollTop:r.top-125},"fast"),e.preventDefault(),!1)},$(document).on("click",".showRecommendItem",function(){isItem=!1,el=$(this).parent(),-1<(group=el.attr("id").replace("showRecommendItem_","")).indexOf("-")&&(isItem=!0,number=group.split("-")[1],group=itemGroup=group.split("-")[0]),$("#ndkcsfields .toggler").removeClass("active"),0==parseInt(letOpen)&&$("#ndkcsfields .fieldPane").hide(),formGroup=$(".form-group[data-field='"+group+"']"),id_product_pack=formGroup.parent().attr("id"),formGroup.parent().hasClass("groupFieldBlock")&&(targetButtonPack=$(".toggleGroupField.closed[target='#"+formGroup.parent().attr("id")+"']")).trigger("click"),$(".view_tab[data-view='"+formGroup.attr("data-view")+"']:not(.activeView)").trigger("click"),scrollToNdk(formGroup,800),1==makeSlide&&($(".sliderBlock .ndkackFieldItem").removeClass("activeItem"),formGroup.addClass("activeItem")),$.fancybox.close(),checked=!1,formGroup.find(".toggler:not(.active)").trigger("click"),isItem&&(scrollToNdk(formGroup.find(".designer-item[data-number='"+number+"']"),800),$(".designer-item[data-number='"+number+"']").show())});var ghoape=function(e){var i,a,t;return"function"==typeof getHeightOfAbsolutelyPositionedElement_Override?getHeightOfAbsolutelyPositionedElement_Override(e):(a=i=0,t=[],$.each($(e).find("*"),function(e,t){i=Math.max(i,$(t).offset().top+$(t).height()),a=Math.max(a,$(t).offset().left+$(t).width())}),t.y=i-$(e).offset().top,t.x=a-$(e).offset().left,$(e).css("width",t.x).css("height",t.y).css("position","unset"),t)};function preload(e){if("function"==typeof preload_Override)return preload_Override(e);$(e).each(function(){$("<img/>")[0].src=this})}function setTags(){if("function"==typeof setTags_Override)return setTags_Override();$(".tagged").each(function(){fullClass=$(this).attr("class"),$(this).attr("class","filterTag "+fullClass.replace(/[!\"#$%&'\(\)\*\+,\.\/:;<=>\?\@\[\\\]\^`\{\|\}~]/g,"").toLowerCase()),tags=(tags=$(this).attr("data-tags")).split("|"),rootBlock=$(this).attr("data-group");for(var e=0;e<tags.length;e++)""!=tags[e]&&-1==$.inArray(tags[e]+"|"+rootBlock,filtersTags)&&filtersTags.push(tags[e]+"|"+rootBlock)}),encountred=[];for(var e=0;e<filtersTags.length;e++)value=filtersTags[e].split("|"),-1==$.inArray(value[1],encountred)&&(mySelector=$("#main-"+value[1]).find(".visu-tools").prepend('<div class="tag-selector-container"><p class="clear clearfix"><label>'+filterText+'</label></p><select id="tag-select-'+value[1]+'" class=" ndk_tag_selector"><option value="all">'+allText+"</option></select></div>"),encountred.push(value[1]));for(e=0;e<filtersTags.length;e++)value=filtersTags[e].split("|"),properValue=value[0].replace(/[!\"#$%&'\(\)\*\+,\.\/:;<=>\?\@\[\\\]\^`\{\|\}~]/g,""),$("#tag-select-"+value[1]).append('<option value="'+properValue.replace(/ /g,"-").toLowerCase()+'">'+value[0]+"</option>");$(document).on("change",".ndk_tag_selector",function(){("all"==$(this).val()?$(this).parent().parent().parent().parent().find(".filterTag"):($(this).parent().parent().parent().parent().find(".filterTag").hide(),$(this).parent().parent().parent().parent().find("."+$(this).val()))).show()})}function updatePriceAttrNdk(){if("function"==typeof updatePriceAttrNdk_Override)return updatePriceAttrNdk_Override();var e=$("#idCombination").val();if("undefined"!=typeof combinationsFromController){e=combinationsFromController[e];if(void 0!==e){var t=+productPriceTaxExcluded,i=+productPriceTaxIncluded;groupReduction;t+=+e.price,i+=+e.price*(taxRate/100+1),e.specific_price&&0<e.specific_price.price&&(t=+e.specific_price.price,i=+e.specific_price.price*(taxRate/100+1));for(var a,r=t,o=i,t=(default_eco_tax&&(r+=default_eco_tax*(1+ecotaxTax_rate/100),o+=default_eco_tax*(1+ecotaxTax_rate/100),i+=default_eco_tax*(1+ecotaxTax_rate/100),t+=default_eco_tax*(1+ecotaxTax_rate/100)),e.specific_price&&0<e.specific_price.reduction&&("amount"==e.specific_price.reduction_type?void 0!==e.specific_price.reduction_tax&&"0"===e.specific_price.reduction_tax&&(a=e.specific_price.reduction,r-=a=0==e.specific_price.id_currency?a*currencyRate*(1-groupReduction):a,o-=a*(taxRate/100+1)):"percentage"==e.specific_price.reduction_type&&(r*=1-+e.specific_price.reduction,o*=1-+e.specific_price.reduction)),priceWithDiscountsDisplay=noTaxForThisProduct||customerGroupWithoutTax?(basePriceDisplay=t,r):(basePriceDisplay=i,o),e.specific_price&&0<e.specific_price.reduction&&"amount"==e.specific_price.reduction_type&&(void 0===e.specific_price.reduction_tax||void 0!==e.specific_price.reduction_tax&&"1"===e.specific_price.reduction_tax)&&(a=e.specific_price.reduction,"undefined"!=typeof specific_currency&&specific_currency&&parseInt(e.specific_price.id_currency)&&e.specific_price.id_currency!=currency.id?a/=currencyRate:specific_currency||(a*=currencyRate),"undefined"!=typeof groupReduction&&0<groupReduction&&(a*=1-parseFloat(groupReduction)),r=(priceWithDiscountsDisplay-=a)-a*(1/(1+taxRate/100))),basePriceDisplay!=priceWithDiscountsDisplay&&(basePriceDisplay,priceWithDiscountsDisplay,priceWithDiscountsDisplay,basePriceDisplay),+e.unit_impact),n=((0<productUnitPriceRatio||t)&&(t?(baseUnitPrice=productBasePriceTaxExcl/productUnitPriceRatio,unit_price=baseUnitPrice+t,noTaxForThisProduct&&customerGroupWithoutTax||(unit_price*=taxRate/100+1)):unit_price=priceWithDiscountsDisplay/productUnitPriceRatio),0),d=0;d<groupAdded.length;d++)void 0!==groupAdded[d]&&(n+=parseFloat(+groupAdded[d]));0<parseFloat(void 0)&&(i=priceWithDiscountsDisplay,new_price=parseFloat(+i)+parseFloat(+n),n=0,setTimeout(function(){$("#our_price_display").text(formatCurrencyNdk(new_price*currencyRate))},50)),$("#add_to_cart, .product-add-to-cart > *:not(.product-quantity), .add, .add-to-cart").hide()}}}function showLayer(e){if("function"==typeof showLayer_Override)return showLayer_Override(e);view=e.attr("data-view"),group=e.attr("data-group"),(target=0<view&&0<$(".zone_limit[data-group='"+group+"']").length?$(".zone_limit[data-group='"+group+"']"):$("#visual_"+group)).show(),e.addClass("visible_layer").removeClass("hidden_layer"),$(".hidden_layer[data-group='"+group+"']").trigger("click")}function hideLayer(e){if("function"==typeof hideLayer_Override)return hideLayer_Override(e);view=e.attr("data-view"),group=e.attr("data-group"),(target=0<view&&0<$(".zone_limit[data-group='"+group+"']").length?$(".zone_limit[data-group='"+group+"']"):$("#visual_"+group)).hide(),e.addClass("hidden_layer").removeClass("visible_layer"),$(".visible_layer[data-group='"+group+"']").trigger("click")}function makeFloat(e,t){if("function"==typeof makeFloat_Override)return makeFloat_Override(e,t);if(!$("body").hasClass("ndkcfLoaded"))return!1;t=t||"";var a,r,o,i=$(e);$parent=""!=t?$(t):$(i).parent(),elOffset=$(e).offset(),768<$(window).width()&&1!=contentOnly&&(a=jQuery,o=a(e),r="undefined"!=typeof elOffset?elOffset.top:0,o.css("position","relative"),a(window).on("scroll",function(e){var t=$parent.innerHeight()-a(o).innerHeight(),i=a(window).scrollTop();i-$parent.offset().top+20<t&&o.stop(!1,!1).animate({top:i<r?0:i-r+20},250)}))}function checkRangeDimensions(t,i,a){return i=""!=i?i:0,a=""!=a?a:1,$.ajax({type:"GET",async:!0,url:baseUrl+"modules/ndk_advanced_custom_fields/front_ajax.php?action=checkRangeDimensions",data:{width:i,height:a,group:t},success:function(e){return 0!=e||(message='<span class="error alert-danger clear clearfix">Les mesures '+i+"mm x "+a+"mm ne sont pas possible à fabriquer.</span>",ShowNDKFieldError(t,message),!1)}}),!1}function getMinHeight(e,t){$.ajax({type:"GET",async:!0,url:baseUrl+"modules/ndk_advanced_custom_fields/front_ajax.php?action=getMinHeight",data:{width:t,group:groupf},success:function(e){isNaN(e)}})}function checkFieldRestrictions(e,t){if("function"==typeof checkFieldRestrictions_Override)return checkFieldRestrictions_Override(e,t);if(data={restrictions:!1,obligations:!1},$(".form-group[data-field='"+t+"']").removeClass("focusRequired").find(".error").remove(),my_id_value=e&&-1<e.indexOf("[")?(idValArr=e.split("["))[0]:e,"undefined"!=typeof(data=void 0!==jsonDatas[t]&&void 0!==jsonDatas[t][my_id_value]?jsonDatas[t][my_id_value]:data)&&null!==data&&""!=data&&(null!=data.restrictions&&""!=data.restrictions||null!=data.obligations&&""!=data.obligations)){if(goTonextStep(t),selectedIdValue[t]!=my_id_value){if(selectedIdValue[t]=my_id_value,!$(".form-group[data-field='"+t+"']").hasClass("hasRestrictions"))return!0;if(killer=(e=e||!1)&&-1<e.indexOf("[")?(idValArr=e.split("["))[0]:0,$(".form-group[data-field='"+t+"']").removeClass("focusRequired").find(".error").remove(),$(".disabled_value_by_"+t).removeClass("disabled_value_by_"+t),$(".disabled_value_by_"+t+(0<killer?"_"+killer:"")).removeClass("disabled_value_by_"+t+(0<killer?"_"+killer:"")),"undefined"!=typeof data&&null!==data&&null!=data.restrictions&&""!=data.restrictions){$(".disabled_value_by_"+t).removeClass("disabled_value_by_"+t);for(var i=0;i<=data.restrictions.length;i++)data.restrictions[i],null!==data.restrictions[i]&&data.restrictions[i]&&(splitted=data.restrictions[i].split("|"),targetVal=splitted[1],targetValValue=splitted[2],targetGroup=(targetGroup=splitted[0]).replace("]","").replace("[",""),$("#ndkcsfield_"+targetGroup).val()!=targetValValue&&"all"!=targetVal||(rootBlock=$(".form-group[data-field='"+targetGroup+"']"),$("#visual_"+targetGroup).remove(),$("#ndkcsfield_"+targetGroup).val(""),rootBlock.find(".noborder, .noborderSimple, .falsenoborder, .recipient-text").val(""),rootBlock.find("input[type='checkbox']").prop("checked",!1).trigger("change"),rootBlock.find(".selected-value").removeClass("selected-value"),0<rootBlock.find('.noborder[value!=""], .noborderSimple[value!=""], .falsenoborder[value!=""]').length&&(rootBlock.find(".noborder, .noborderSimple, .falsenoborder").val(""),rootBlock.find(".submitText, .submitSimpleText").trigger("click")),$("#layer-edit-"+targetGroup).remove(),$.prototype.uniform&&$.uniform.update("#ndkcsfields input, #ndkcsfields select"),$("#dimension_text_width_"+targetGroup).val(""),$("#dimension_text_height_"+targetGroup).val(""),$(".recap_group_"+targetGroup).remove(),updatePriceNdk(0,targetGroup),groupAdded[targetGroup]=0,checkLayerChanges()),disableFieldRestriction(targetVal,t,targetGroup,killer))}else $(".disabled_value_by_"+t).removeClass("disabled_value_by_"+t),$(".disabled_value_by_"+t+(0<killer?"_"+killer:"")).removeClass("disabled_value_by_"+t+(0<killer?"_"+killer:""));if("object"==typeof data&&"object"==typeof data.obligations)for(i=0;i<=data.obligations.length;i++)data.obligations[i],null!==data.obligations[i]&&data.obligations[i]&&(splitted=data.obligations[i].split("|"),targetVal=splitted[1],targetValValue=splitted[2],targetGroup=(targetGroup=splitted[0]).replace("]","").replace("[",""),applyDefaultValuesNdk(rootBlock=$(".form-group[data-field='"+targetGroup+"']"),'[data-id-value="'+targetVal+'"]',!1),checkLayerChanges())}}else $(".disabled_value_by_"+t).removeClass("disabled_value_by_"+t),selectedIdValue[t]=e;goTonextStep(t)}function goTonextStep(e){$(".form-group.steppedField[data-field='"+e+"']").addClass("stepDone").removeClass("stepTodo"),$(".notReadyStep:eq(0)").removeClass("notReadyStep").find(".toggler").trigger("click")}function setScenario(){$(".overDisabler").remove();for(var e=0;e<scenario.length;e++)$(".form-group[data-field='"+scenario[e]+"']").addClass("steppedField notReadyStep stepTodo").append('<div class="overDisabler"></div>');$(".notReadyStep:eq(0)").removeClass("notReadyStep")}function setOpenedStatus(){for(var e=0;e<opened_fields.length;e++)$(".form-group[data-field='"+opened_fields[e]+"']").find(".toggler:not(.active)").trigger("click");for(e=0;e<closed_fields.length;e++)$(".form-group[data-field='"+opened_fields[e]+"']").find(".toggler.active").trigger("click")}function identifyResctictives(){for(var e=0;e<hasRestrictions.length;e++)$(".form-group[data-field='"+hasRestrictions[e]+"']").addClass("hasRestrictions")}function disableFieldRestriction(e,t,i,a){return"function"==typeof disableFieldRestriction_Override?disableFieldRestriction_Override(e,t,i,a):void 0===e||""==e||"undefined"==e||("all"==e&&($(".form-group[data-field='"+i+"']:not(.submitContainer)").addClass("disabled_value_by_"+t),$(".form-group[data-field='"+i+"']").find(".ndk-accessory-quantity[value!=0]").val(0).trigger("change").trigger("keyup").addClass("disabled_value_by_"+t),$(".ndkQuickAccessBox-item[data-target='"+i+"']:not(.submitContainer)").addClass("disabled_value_by_"+t)),-1<e.indexOf("[")?(idValArr=e.split("["),idValue=idValArr[0],qttyVal=idValArr[1].replace("]",""),$("#ndk-accessory-quantity-"+a).val()==qttyVal&&($("#ndk-accessory-quantity-"+idValue).addClass("disabled_value_by_"+t+(0<a?"_"+a:"")).val(0).trigger("change").trigger("keyup"),$("#ndk-accessory-quantity-"+idValue).parent().parent().parent().addClass("disabled_value_by_"+t),$("#ndk-accessory-quantity-"+idValue).parent().parent().parent().addClass("disabled_value_by_"+t+(0<a?"_"+a:"")).val(0).trigger("change").trigger("keyup"))):($("#ndk-accessory-quantity-"+e).addClass("disabled_value_by_"+t+(0<a?"_"+a:"")).val(0).trigger("change").trigger("keyup"),$("#ndk-accessory-quantity-"+e).parent().parent().parent().addClass("disabled_value_by_"+t),$("#ndk-accessory-quantity-"+e).parent().parent().parent().addClass("disabled_value_by_"+t+(0<a?"_"+a:"")).val(0).trigger("change").trigger("keyup")),$("[data-id-value='"+e+"']").addClass("disabled_value_by_"+t),void $(".ndk-radio[data-id-value='"+e+"']").parent().addClass("disabled_value_by_"+t))}function convertPercent(){if("function"==typeof convertPercent_Override)return convertPercent_Override();$(".absolute-visu:visible").each(function(){dragToPercent($(this))}),$("#image-block").css({width:"100%",height:"auto"})}function convertPercentBAK(){if("function"==typeof convertPercentBAK_Override)return convertPercentBAK_Override();$(".absolute-visu:visible").each(function(){-1<(group=$(this).attr("id").replace("visual_","")).indexOf("-")&&(group=group.split("-")[0]),target=0<$(".zone_limit[data-group='"+group+"']").length?(container=".zone_limit[data-group='"+group+"']",2):(container="#image-block",1),containerWidth=$(container).width(),containerHeight=$(container).height(),elWidth=$(this).width(),elHeight=$(this).height(),elLeft=$(this)[0].style.left.replace("px",""),elTop=$(this)[0].style.top.replace("px",""),widthPercent=elWidth/containerWidth*100+"%",elHeight,containerHeight,heightPercent="auto",leftPercent=elLeft/containerWidth*100+"%",topPercent=elTop/containerHeight*100+"%",$(this).css({width:widthPercent,height:heightPercent,margin:""}),elLeft.indexOf("%")<1&&$(this).css({left:leftPercent}),elTop.indexOf("%")<1&&$(this).css({top:topPercent}),1==target||2!=target||$(this).parent().hasClass("zone_limit")||"#image-block"==$(this).parent().attr("id")||$(this).parent().css({width:widthPercent,height:heightPercent}),$("#image-block").css({width:"100%",height:"auto"})})}function convertDegree(e){if("function"==typeof convertDegree_Override)return convertDegree_Override(e);var e=document.getElementById(e),e=window.getComputedStyle(e,null),e=(e.getPropertyValue("-webkit-transform")||e.getPropertyValue("-moz-transform")||e.getPropertyValue("-ms-transform")||e.getPropertyValue("-o-transform")||e.getPropertyValue("transform")||"FAIL").split("(")[1].split(")")[0].split(","),t=e[0],e=e[1];Math.sqrt(t*t+e*e),Math.round(Math.atan2(e,t)*(180/Math.PI))}function applyDefaultValuesNdk(e,t,i){if(e=e||$("#ndkcsfields"),i=i||!0,"function"==typeof applyDefaultValuesNdk_Override)return applyDefaultValuesNdk_Override(e);var a;i&&(a="",e.find('*[data-hide-field="1"]').each(function(){var e=$(this).closest("[data-field]").data("field");e!=a&&(a=e,$(this).is(":checkbox")?checkFieldRestrictions($(this).attr("data-value-id"),$(this).attr("data-group")):checkFieldRestrictions($(this).attr("data-id-value"),$(this).attr("data-group")))}))}function scrollToNdk(e,t){if("function"==typeof scrollToNdk_Override)return scrollToNdk_Override(e,t);1!=ndk_disableAutoScroll&&(t=t||750,e.length)&&$("html").animate({scrollTop:e.offset().top,scrollLeft:e.offset().left},t)}function strReplaceAll(t,e,i){try{return t.replace(new RegExp(e,"gi"),i)}catch(e){return t}}function emptyFormNdk(e){if("function"==typeof emptyFormNdk_Override)return emptyFormNdk_Override(e);checkbox=e.find('input[type="checkbox"]'),radio=e.find('input[type="radio"]'),text=e.find('input[type="text"], input[type="hidden"]'),select=e.find("select"),checkbox.prop("checked",!1).trigger("change"),radio.prop("checked",!1).trigger("change")}function setQuickNav(){if("function"==typeof setQuickNav_Override)return setQuickNav_Override();$("#ndkQuickAccessBox").remove(),0<$(".pb-right-column").length?$(".pb-right-column").append('<div id="ndkQuickAccessBox" class="quickFullWidth"><ul></ul></div>'):$("#ndkcsfields-block").append('<div id="ndkQuickAccessBox"><ul></ul></div>').addClass("withQuickNav"),$(".toggler:not(.dontquick)").each(function(){(groupTitleEl=$(this).clone()).find(".toggleText, .tooltipDescription, .tooltipDescMark").remove(),title=groupTitleEl.text(),group=$(this).parent().attr("data-field"),$("#ndkQuickAccessBox ul").append('<li class="ndkQuickAccessBox-item" data-target="'+group+'">'+title+"</li>")}),$(document).on("click",".ndkQuickAccessBox-item",function(){$(".ndkQuickAccessBox-item").removeClass("active"),group=$(this).attr("data-target"),$(this).addClass("active"),$(".ndkackFieldItem[data-field='"+group+"'] label:eq(0)").trigger("click")}),$(".pb-right-column").length<1&&makeFloat("#ndkQuickAccessBox")}function updateDisplayAttrNdk(){ps_version<=1.6&&(productPrice,productPriceWithoutReduction,!selectedCombination.unavailable&&0<quantityAvailable&&1==productAvailableForOrder||allowBuyWhenOutOfStock&&!selectedCombination.unavailable&&productAvailableForOrder?$(".ndkcsfields-block").fadeIn(600):$(".ndkcsfields-block").fadeOut(600))}$(document).on("click",".colorize_svg li",function(){root=$(this).parent().parent().parent().parent().parent(),color=$(this).find("span").text(),$(this).parent().find("li").removeClass("selected"),$(this).addClass("selected"),$(this).parent().parent().find(".index-value").html($(this).html()),root.find(".replaced-svg").each(function(){$(this).attr("fill",color);var e=$(this).parent();$(this).parent().hasClass("selected-svg")&&$.when(e.parent().parent().trigger("click")).done(function(){e.trigger("click")})})}),$.fn.setNdkSelector=function(){visible=!1;var t=$(this).find("ul"),e=t.find("li").first(),i=(0==$(this).find(".index-value").length&&$(this).prepend('<div class="index-value"></div>'),t.find("li.selected"));i.length?$(this).find(".index-value").html(i.html()):$(this).find(".index-value").html(e.html()),t.find("li").length<2&&$(this).parent().hide(),t.hide(),$(this).click(function(){var e;visible||(t.show("fast",function(){visible=!0}),(e=t.find("li.selected")).length&&$(this).find(".index-value").html(e.html()))}),$("html").click(function(){visible&&$(".ndk_selector").find("ul").hide("fast",function(){visible=!1})})},equalheight=function(e){var t,i=0,a=new Array;$(e).each(function(){for(t=$(this),topPostion=t.position().top,a.push(t),i=i<t.height()?t.height():i,currentDiv=0;currentDiv<a.length;currentDiv++)a[currentDiv].height(i)})},equalheightbyRow=function(e){var t,i=0,a=0,r=new Array;$(e).each(function(){if(t=$(this),$(t).height("auto"),topPostion=t.position().top,topPositionParent=t.parent().parent().position().top,a!=topPostion){for(currentDiv=0;currentDiv<r.length;currentDiv++)r[currentDiv].height(i);r.length=0,a=topPostion,i=t.height(),r.push(t)}else if(a!=topPositionParent){for(currentDiv=0;currentDiv<r.length;currentDiv++)r[currentDiv].height(i);r.length=0,a=topPositionParent,i=t.height(),r.push(t)}else r.push(t),i=i<t.height()?t.height():i;for(currentDiv=0;currentDiv<r.length;currentDiv++)r[currentDiv].height(i)})},$(document).on("click",".ndkcfLoaded .color_pick",function(e){updatePriceNdkGeneric(),update_price_dynamic(0),snapShotLight()}),$(document).on("change",".ndkcfLoaded .attribute_select",function(){updatePriceNdkGeneric(),update_price_dynamic(0),updateDisplayAttrNdk()}),$(document).on("click",".ndkcfLoaded .attribute_radio",function(){updatePriceNdkGeneric(),update_price_dynamic(0),updateDisplayAttrNdk()}),$(document).on("change","#quantity_wanted",function(e){$("#max_options_quantity").remove(),void 0!==$(this).attr("max")&&"null"!=$(this).attr("max")&&parseFloat($(this).val())>parseFloat($(this).attr("max"))?($(this).val($(this).attr("max")).trigger("keyup"),$(this).parent().append('<span class="quantity_warning" id="max_options_quantity">'+textMaxQuantity+" "+$(this).attr("max")+"</span>")):$("#max_options_quantity").remove(),updatePriceNdkGeneric()}),$(document).on("keyup",".dimension_text",function(e){$(this).trigger("change")}),$(document).on("change",".dimension_text",function(e){groupf=parseInt($(this).attr("data-group")),width=$("#dimension_text_width_"+groupf).val(),height=$("#dimension_text_height_"+groupf).val();var t=!1;height=""!=height?height:1,"640259"===id_product&&$("#dimension_text_height_"+groupf).val(3e3),null!=width&&null!=height&&"949"!=groupf&&"1048"!=groupf&&(clearTimeout(typingTimer),typingTimer=setTimeout(function(){$.ajax({type:"GET",async:!0,url:baseUrl+"modules/ndk_advanced_custom_fields/front_ajax.php?action=getRangePrice",data:{width:width,height:height,group:groupf,id_product:$("#ndkcf_id_product").val()},success:function(e){t=checkRangeDimensions(groupf,width,height),isNaN(e)||(parseFloat(e)<0&&"number"==$("#dimension_text_height_"+groupf).attr("type")&&parseFloat(height)<$("#dimension_text_height_"+groupf).attr("max")?getMinHeight(groupf,width,height):parseFloat(height)>$("#dimension_text_height_"+groupf).attr("max")||($(".dimensions_block").length&&(3==e&&999999==e||(HideNDKFieldError(groupf),t=!1),3!=e&&999999!=e||(message='<span class="error alert-danger clear clearfix">Les mesures '+width+"mm x "+height+"mm ne sont pas possible à fabriquer.</span>",ShowNDKFieldError(groupf,message),t=!0)),t?updatePriceNdk(parseFloat(0),groupf):(updatePriceNdk(parseFloat(e),groupf),ProgressBar())));-1!==$.inArray(groupf,[4134,4092,4093,4131,4098,4099,4030,4103,4104,4112,4113,4114])&&Cintreecheck(groupf,width,height)}})},500))}),jQuery.fn.rotationDegrees=function(){var e,t=this.css("-webkit-transform")||this.css("-moz-transform")||this.css("-ms-transform")||this.css("-o-transform")||this.css("transform");return(t="string"==typeof t&&"none"!==t?(e=(t=t.split("(")[1].split(")")[0].split(","))[0],Math.round(Math.atan2(t[1],e)*(180/Math.PI))):0)<0?t+360:t},$(document).on("click","[data-dismiss='modal']",function(){location.reload()}),$(document).on("hidden.bs.modal","#blockcart-modal",function(){location.reload()}),$(document).on("change",".ndk-radio, .ndk-checkbox",function(){$(this).is(":radio")&&$("input[name='"+$(this).attr("name")+"']").not(this).removeAttr("checked").removeAttr("checkme"),$(this).is(":checked")?$(this).attr("checked","checked").attr("checkme","1"):($(this).removeAttr("checked"),$(this).removeAttr("checkme"))}),$(document).on("focus",".ndk-select",function(){$(this).find("option").removeAttr("disabled"),$(this).find('[class*="disabled_value_by"]').attr("disabled","disabled")}),$(window).on("load",function(){$(".form-group[data-iteration='1']").removeClass("aluclass-disable-div"),$(".form-group[data-field='5426']").removeClass("aluclass-disable-div"),$("#ndk-accessory-quantity-30510").val(0),$("#ndk-accessory-quantity-30511").val(0),RemoveField(5475),RemoveField(5476),RemoveField(5477),RemoveField(5478),RemoveField(5479),RemoveField(5480),RemoveField(5481),RemoveField(5482),RemoveField(5483),RemoveField(5516),RemoveField(5517),RemoveField(5520),RemoveField(5525),$(".additionnal_price").remove();var e=$("#portivaaumento").val();reductionpercentprice=$("#reductionpercentprice").val(),reductionpercent=$("#reductionpercent").val(),reductionpercentname=$("#reductionpercentname").val(),e=parseFloat(e)-parseFloat(e)*valorReducao,e=parseFloat(e)-parseFloat(reductionpercent)/100*parseFloat(e),0<parseInt(reductionpercentprice)&&(reductionpercentprice=parseFloat(reductionpercentprice)+parseFloat(e),$(".productPriceUpHT, #our_price_display:visible").before('<span id="additionnal_price" data-price="0" class="product-price price additionnal_price"></span>'),formatCurrencyNdkCallback(reductionpercentprice,".additionnal_price"," Avec code "+reductionpercentname+" : ","<br> Code limité à 1 jour")),$(".tooltipDescMark").hover(function(){$(this).find(".tooltip-ndk").css({opacity:"1",visibility:"visible",filter:"alpha(opacity=100)"})},function(){$(this).find(".tooltip-ndk").css({opacity:"0",visibility:"hidden",filter:"alpha(opacity=0)"})}),$(".tooltipDescMark").on("touchstart",function(){var e=$(this).find(".tooltip-ndk");0<e.css("opacity")&&"visible"===e.css("visibility")?e.css({opacity:"0",visibility:"hidden",filter:"alpha(opacity=0)"}):e.css({opacity:"1",visibility:"visible",filter:"alpha(opacity=100)"})})}),$(document).on("change",".ndkackFieldItem, select.form-control-ndk",function(){ActiveFieldNDK(this)}),$(document).on("click",".img-value",function(){ActiveFieldNDK(this)}),$(document).on("click",".color-ndk ",function(){priceColor=$(this).attr("data-price"),datagroupColor=$(this).attr("data-group");var e=(dataValueColor=$(this).attr("data-value")).split("+");-1===$.inArray(datagroupColor,["3060","3061","3062","3063","2905","4772","4773","4774","4775"])&&(0<parseInt(priceColor)||"5%"==e[1]||"8%"==e[1]||"37,5€ m2"==e[1]||"79€ m2"==e[1]||"185,4€ m2"==e[1]||"180,3€ m2"==e[1]||"45€ m2"==e[1]||"83€ m2"==e[1]||"44,6€ m2"==e[1]||"52,5€ m2"==e[1]||"91,25€ m2"==e[1]||"49,09€ m2"==e[1]||"57,75€ m2"==e[1]?$("#textwarringcolor_"+datagroupColor).html("<p class='pt-1' style='color:red;' >Un délai supplémentaire de 15 jours ouvrables</p>"):$("#textwarringcolor_"+datagroupColor).html("<p></p>"))}),$(".product_666_1121").on("click"," div.accessory_img_block",function(){$("div[data-field='723']").hasClass("disabled_value_by")?$("div[data-field='723']").removeClass("disabled_value_by"):($("div[data-field='723']").addClass("disabled_value_by"),$(".accessory-ndk[data-id-value='6495']").hasClass("selected-accessory")&&$("#img_div_6495").trigger("mousedown"))}),$(document).on("change",".ndk-select",function(){$("#ndkcsfield_"+$(this).attr("data-group")+" option[value='']").remove()}),$(".dimension_text_height").change(function(e){product_id=$("#product_page_product_id").val(),widthValue=$(this).val(),ndkgroupid=$(this).data("group"),4575!=parseInt(ndkgroupid)&&2021!=parseInt(ndkgroupid)&&2013!=parseInt(ndkgroupid)&&2244!=parseInt(ndkgroupid)&&2577!=parseInt(ndkgroupid)&&3944!=parseInt(ndkgroupid)&&3945!=parseInt(ndkgroupid)&&2574!=parseInt(ndkgroupid)&&3946!=parseInt(ndkgroupid)&&3947!=parseInt(ndkgroupid)&&2579!=parseInt(ndkgroupid)&&3948!=parseInt(ndkgroupid)&&3949!=parseInt(ndkgroupid)&&2627!=parseInt(ndkgroupid)&&2655!=parseInt(ndkgroupid)&&2665!=parseInt(ndkgroupid)&&126!=parseInt(ndkgroupid)&&4797!=parseInt(ndkgroupid)&&4836!=parseInt(ndkgroupid)&&5328!=parseInt(ndkgroupid)&&5329!=parseInt(ndkgroupid)&&4837!=parseInt(ndkgroupid)&&5330!=parseInt(ndkgroupid)&&5331!=parseInt(ndkgroupid)&&4838!=parseInt(ndkgroupid)&&5332!=parseInt(ndkgroupid)&&5333!=parseInt(ndkgroupid)&&4839!=parseInt(ndkgroupid)&&5335!=parseInt(ndkgroupid)&&5336!=parseInt(ndkgroupid)&&5315!=parseInt(ndkgroupid)&&5322!=parseInt(ndkgroupid)&&5323!=parseInt(ndkgroupid)&&5321!=parseInt(ndkgroupid)&&5324!=parseInt(ndkgroupid)&&5325!=parseInt(ndkgroupid)&&5343!=parseInt(ndkgroupid)&&5344!=parseInt(ndkgroupid)&&5345!=parseInt(ndkgroupid)&&5352!=parseInt(ndkgroupid)&&5353!=parseInt(ndkgroupid)&&5355!=parseInt(ndkgroupid)&&5361!=parseInt(ndkgroupid)&&5362!=parseInt(ndkgroupid)&&5363!=parseInt(ndkgroupid)&&5380!=parseInt(ndkgroupid)&&5381!=parseInt(ndkgroupid)&&5382!=parseInt(ndkgroupid)&&5568!=parseInt(ndkgroupid)&&5569!=parseInt(ndkgroupid)&&5570!=parseInt(ndkgroupid)&&5576!=parseInt(ndkgroupid)&&5577!=parseInt(ndkgroupid)&&5578!=parseInt(ndkgroupid)&&5584!=parseInt(ndkgroupid)&&5585!=parseInt(ndkgroupid)&&5586!=parseInt(ndkgroupid)&&5530!=parseInt(ndkgroupid)&&5531!=parseInt(ndkgroupid)&&5532!=parseInt(ndkgroupid)&&5539!=parseInt(ndkgroupid)&&5540!=parseInt(ndkgroupid)&&5541!=parseInt(ndkgroupid)&&5595!=parseInt(ndkgroupid)&&5596!=parseInt(ndkgroupid)&&5597!=parseInt(ndkgroupid)&&5606!=parseInt(ndkgroupid)&&5607!=parseInt(ndkgroupid)&&5608!=parseInt(ndkgroupid)&&5614!=parseInt(ndkgroupid)&&5615!=parseInt(ndkgroupid)&&5616!=parseInt(ndkgroupid)&&5623!=parseInt(ndkgroupid)&&5624!=parseInt(ndkgroupid)&&5625!=parseInt(ndkgroupid)&&5633!=parseInt(ndkgroupid)&&5634!=parseInt(ndkgroupid)&&5635!=parseInt(ndkgroupid)&&5643!=parseInt(ndkgroupid)&&5644!=parseInt(ndkgroupid)&&5645!=parseInt(ndkgroupid)&&5652!=parseInt(ndkgroupid)&&5653!=parseInt(ndkgroupid)&&5654!=parseInt(ndkgroupid)&&("string"==typeof(widthValuetemp=$("#dimension_text_width_"+ndkgroupid).val())&&0===widthValuetemp.length||(widthValuetemp=widthValuetemp.replace(/\D/g,""),widthValue=widthValue.replace(/\D/g,""),$.isNumeric(widthValuetemp)&&$.isNumeric(widthValue)&&parseInt(widthValuetemp)>parseInt(widthValue)&&(widthValue=widthValuetemp)),ndkgroupid="width",$.ajax({type:"POST",url:"../modules/alucarrier/ajax.php",data:{action:"getpriceportes",product_id:product_id,widthValue:widthValue,ndkgroupid:ndkgroupid},success:function(e){"false"!=(objport=JSON.parse(e)).status&&($(".prazoentrega").html(objport.text_price),"true"==objport.free_shipping||"true"==objport.half_free_shipping)&&$("#portivaaumento").val(parseInt(objport.price))}}))}),$(".dimension_text_width").change(function(e){product_id=$("#product_page_product_id").val(),widthValue=$(this).val(),ndkgroupid=$(this).data("group"),4575!=parseInt(ndkgroupid)&&2021!=parseInt(ndkgroupid)&&2013!=parseInt(ndkgroupid)&&2244!=parseInt(ndkgroupid)&&4836!=parseInt(ndkgroupid)&&5328!=parseInt(ndkgroupid)&&5329!=parseInt(ndkgroupid)&&4837!=parseInt(ndkgroupid)&&5330!=parseInt(ndkgroupid)&&5331!=parseInt(ndkgroupid)&&4838!=parseInt(ndkgroupid)&&5332!=parseInt(ndkgroupid)&&5333!=parseInt(ndkgroupid)&&4839!=parseInt(ndkgroupid)&&5335!=parseInt(ndkgroupid)&&5336!=parseInt(ndkgroupid)&&5315!=parseInt(ndkgroupid)&&5322!=parseInt(ndkgroupid)&&5323!=parseInt(ndkgroupid)&&5321!=parseInt(ndkgroupid)&&5324!=parseInt(ndkgroupid)&&5325!=parseInt(ndkgroupid)&&5343!=parseInt(ndkgroupid)&&5344!=parseInt(ndkgroupid)&&5345!=parseInt(ndkgroupid)&&5352!=parseInt(ndkgroupid)&&5353!=parseInt(ndkgroupid)&&5355!=parseInt(ndkgroupid)&&5361!=parseInt(ndkgroupid)&&5362!=parseInt(ndkgroupid)&&5363!=parseInt(ndkgroupid)&&5380!=parseInt(ndkgroupid)&&5381!=parseInt(ndkgroupid)&&5382!=parseInt(ndkgroupid)&&5568!=parseInt(ndkgroupid)&&5569!=parseInt(ndkgroupid)&&5570!=parseInt(ndkgroupid)&&5576!=parseInt(ndkgroupid)&&5577!=parseInt(ndkgroupid)&&5578!=parseInt(ndkgroupid)&&5584!=parseInt(ndkgroupid)&&5585!=parseInt(ndkgroupid)&&5586!=parseInt(ndkgroupid)&&5530!=parseInt(ndkgroupid)&&5531!=parseInt(ndkgroupid)&&5532!=parseInt(ndkgroupid)&&5539!=parseInt(ndkgroupid)&&5540!=parseInt(ndkgroupid)&&5541!=parseInt(ndkgroupid)&&5595!=parseInt(ndkgroupid)&&5596!=parseInt(ndkgroupid)&&5597!=parseInt(ndkgroupid)&&5606!=parseInt(ndkgroupid)&&5607!=parseInt(ndkgroupid)&&5608!=parseInt(ndkgroupid)&&5614!=parseInt(ndkgroupid)&&5615!=parseInt(ndkgroupid)&&5616!=parseInt(ndkgroupid)&&5623!=parseInt(ndkgroupid)&&5624!=parseInt(ndkgroupid)&&5625!=parseInt(ndkgroupid)&&5633!=parseInt(ndkgroupid)&&5634!=parseInt(ndkgroupid)&&5635!=parseInt(ndkgroupid)&&5643!=parseInt(ndkgroupid)&&5644!=parseInt(ndkgroupid)&&5645!=parseInt(ndkgroupid)&&5652!=parseInt(ndkgroupid)&&5653!=parseInt(ndkgroupid)&&5654!=parseInt(ndkgroupid)&&("string"==typeof(widthValuetemp=$("#dimension_text_height_"+ndkgroupid).val())&&0===widthValuetemp.length||2577!=parseInt(ndkgroupid)&&3944!=parseInt(ndkgroupid)&&3945!=parseInt(ndkgroupid)&&2574!=parseInt(ndkgroupid)&&3946!=parseInt(ndkgroupid)&&3947!=parseInt(ndkgroupid)&&2579!=parseInt(ndkgroupid)&&3948!=parseInt(ndkgroupid)&&3949!=parseInt(ndkgroupid)&&2627!=parseInt(ndkgroupid)&&2655!=parseInt(ndkgroupid)&&2665!=parseInt(ndkgroupid)&&126!=parseInt(ndkgroupid)&&4797!=parseInt(ndkgroupid)&&(widthValuetemp=widthValuetemp.replace(/\D/g,""),widthValue=widthValue.replace(/\D/g,""),$.isNumeric(widthValuetemp))&&$.isNumeric(widthValue)&&parseInt(widthValuetemp)>parseInt(widthValue)&&(widthValue=widthValuetemp),ndkgroupid="width",$.ajax({type:"POST",url:"../modules/alucarrier/ajax.php",data:{action:"getpriceportes",product_id:product_id,widthValue:widthValue,ndkgroupid:ndkgroupid},success:function(e){"false"!=(objport=JSON.parse(e)).status&&($(".prazoentrega").html(objport.text_price),"true"==objport.free_shipping||"true"==objport.half_free_shipping)&&$("#portivaaumento").val(parseInt(objport.price))}}))}),$(".ndk-radio").click(function(){product_id=$("#product_page_product_id").val(),widthValue=$(this).val(),ndkgroupid=$(this).data("group"),$.ajax({type:"POST",url:"../modules/alucarrier/ajax.php",data:{action:"getpriceportes",product_id:product_id,widthValue:widthValue,ndkgroupid:ndkgroupid},success:function(e){"false"!=(objport=JSON.parse(e)).status&&($(".prazoentrega").html(objport.text_price),"true"==objport.free_shipping||"true"==objport.half_free_shipping)&&$("#portivaaumento").val(parseInt(objport.price))}})}),$(".img-value").click(function(){product_id=$("#product_page_product_id").val(),widthValue=$(this).data("value"),ndkgroupid=$(this).data("group"),$.ajax({type:"POST",url:"../modules/alucarrier/ajax.php",data:{action:"getpriceportes",product_id:product_id,widthValue:widthValue,ndkgroupid:ndkgroupid},success:function(e){"false"!=(objport=JSON.parse(e)).status&&($(".prazoentrega").html(objport.text_price),"true"==objport.free_shipping||"true"==objport.half_free_shipping)&&$("#portivaaumento").val(parseInt(objport.price))}})}),$(".img-value-4578").click(function(){portao=$(this).attr("data-id-value");$(".img-value-4587[data-id-value='"+{27035:27059,27036:27060}[portao]+"']").trigger("click"),$(".img-value-4588[data-id-value='"+{27035:27061,27036:27062}[portao]+"']").trigger("click")}),$("select.dimension_text_width").change(function(e){dataid=$(this).attr("data-group"),"undefined"!=typeof(selectheight=$("#dimension_text_height_"+dataid).attr("data-selected"))&&$(".form-group[data-field='"+dataid+"']").removeClass("focusRequired").find(".error").remove()}),$("select.dimension_text_height").change(function(e){dataid=$(this).attr("data-group"),"undefined"!=typeof(selectwidth=$("#dimension_text_width_"+dataid).attr("data-selected"))&&$(".form-group[data-field='"+dataid+"']").removeClass("focusRequired").find(".error").remove()}),$("#img_div_30867, #img_div_30786,  #img_div_30785, #img_div_30784, #img_div_30778, #img_div_30577,#img_div_30540,#img_div_30535,#img_div_30540,#img_div_30534,#img_div_30520,#img_div_30517,#img_div_30514,#img_div_30513,#img_div_30512,#img_div_30511,#img_div_30510,#img_div_30508,#img_div_30509,#img_div_30507,#img_div_30506,#img_div_30505,#img_div_30439, #img_div_30458, #img_div_30459,#img_div_30506, #img_div_30468, #img_div_30466, #img_div_30460, #img_div_30461, #img_div_30462, #img_div_30465 ").click(function(e){let t=$(this).attr("id").replace("img_div_","");var i=$("#ndk-accessory-quantity-"+t);$("li.accessory-ndk-no-quantity[data-group='5424']").each(function(e){(idFieldValueNDKFor=$(this).attr("data-id-value"))!=t&&RemoveAllOrtherSelectOptions(idFieldValueNDKFor,t)}),$("li.accessory-ndk-no-quantity[data-group='5417']").each(function(e){(idFieldValueNDKFor=$(this).attr("data-id-value"))!=t&&RemoveAllOrtherSelectOptions(idFieldValueNDKFor,t)}),$("li.accessory-ndk-no-quantity[data-group='5441']").each(function(e){(idFieldValueNDKFor=$(this).attr("data-id-value"))!=t&&RemoveAllOrtherSelectOptions(idFieldValueNDKFor,t)}),0===parseInt(i.val())?($(".ndkackFieldItem[data-field='5475']").length&&(ShowField(5475),$(".img-value-5475[data-id-value='30588']").trigger("click")),$(".ndkackFieldItem[data-field='5476']").length&&(ShowField(5476),$(".img-value-5476[data-id-value='30590']").trigger("click")),$(".ndkackFieldItem[data-field='5477']").length&&(ShowField(5477),$(".img-value-5477[data-id-value='30592']").trigger("click")),$(".ndkackFieldItem[data-field='5478']").length&&(ShowField(5478),$(".img-value-5478[data-id-value='30594']").trigger("click")),$(".ndkackFieldItem[data-field='5479']").length&&(ShowField(5479),$(".img-value-5479[data-id-value='30596']").trigger("click")),$(".ndkackFieldItem[data-field='5480']").length&&(ShowField(5480),$(".img-value-5480[data-id-value='30598']").trigger("click")),$(".ndkackFieldItem[data-field='5481']").length&&(ShowField(5481),$(".img-value-5481[data-id-value='30600']").trigger("click")),$(".ndkackFieldItem[data-field='5482']").length&&(ShowField(5482),$(".img-value-5482[data-id-value='30602']").trigger("click")),$(".ndkackFieldItem[data-field='5483']").length&&(ShowField(5483),$(".img-value-5483[data-id-value='30604']").trigger("click")),$(".ndkackFieldItem[data-field='5516']").length&&(ShowField(5516),$(".img-value-5516[data-id-value='30775']").trigger("click")),$(".ndkackFieldItem[data-field='5517']").length&&(ShowField(5517),$(".img-value-5517[data-id-value='30777']").trigger("click")),$(".ndkackFieldItem[data-field='5520']").length&&(ShowField(5520),$(".img-value-5520[data-id-value='30782']").trigger("click")),$(".ndkackFieldItem[data-field='5525']").length&&(ShowField(5525),$(".img-value-5525[data-id-value='30788']").trigger("click"))):($(".ndkackFieldItem[data-field='5475']").length&&($(".img-value-5475[data-id-value='30588']").trigger("click"),RemoveField(5475)),$(".ndkackFieldItem[data-field='5476']").length&&($(".img-value-5476[data-id-value='30590']").trigger("click"),RemoveField(5476)),$(".ndkackFieldItem[data-field='5477']").length&&($(".img-value-5477[data-id-value='30592']").trigger("click"),RemoveField(5477)),$(".ndkackFieldItem[data-field='5478']").length&&($(".img-value-5478[data-id-value='30594']").trigger("click"),RemoveField(5478)),$(".ndkackFieldItem[data-field='5479']").length&&($(".img-value-5479[data-id-value='30596']").trigger("click"),RemoveField(5479)),$(".ndkackFieldItem[data-field='5480']").length&&($(".img-value-5480[data-id-value='30598']").trigger("click"),RemoveField(5480)),$(".ndkackFieldItem[data-field='5481']").length&&($(".img-value-5481[data-id-value='30600']").trigger("click"),RemoveField(5481)),$(".ndkackFieldItem[data-field='5482']").length&&($(".img-value-5482[data-id-value='30602']").trigger("click"),RemoveField(5482)),$(".ndkackFieldItem[data-field='5483']").length&&($(".img-value-5483[data-id-value='30604']").trigger("click"),RemoveField(5483)),$(".ndkackFieldItem[data-field='5516']").length&&($(".img-value-5516[data-id-value='30775']").trigger("click"),RemoveField(5516)),$(".ndkackFieldItem[data-field='5517']").length&&($(".img-value-5517[data-id-value='30777']").trigger("click"),RemoveField(5517)),$(".ndkackFieldItem[data-field='5520']").length&&($(".img-value-5520[data-id-value='30782']").trigger("click"),RemoveField(5520)),$(".ndkackFieldItem[data-field='5525']").length&&($(".img-value-5525[data-id-value='30788']").trigger("click"),RemoveField(5525)))}),$(" .img-value-5525, .img-value-5520, .img-value-5517, .img-value-5516, .img-value-5475, .img-value-5476, .img-value-5477, .img-value-5478, .img-value-5479, .img-value-5480, .img-value-5481, .img-value-5482, .img-value-5483").click(function(){$("body").append('<div class="ndk-loader" id="ndkloader"><div class="sk-folding-cube"><div class="sk-cube1 sk-cube"></div><div class="sk-cube2 sk-cube"></div><div class="sk-cube4 sk-cube"></div><div class="sk-cube3 sk-cube"></div></div></div>');var e=$(this).attr("data-id-value");let o=(serviceiva10=-1!==$.inArray(parseInt(e),[30587,30589,30591,30593,30595,30597,30599,30601,30603,30774,30776,30781,30787]))?1.2:1.1,n=serviceiva10?1.1:1.2;setTimeout(()=>{$(".accessory-ndk").each(function(e,t){let i=$(t).data("price");var a=$(t).data("id-value"),t=$(t).data("group"),r=!1;if(-1!==$.inArray(parseInt(t),[5426,5417,5424,5425,5439,5440,5441,5442,5443,5444,5445,5446,5447,5448,5449,5450,5452,5453,5454,5455,5456,5457,5458,5459,5460,5462,5463,5465,5466,5467,5472,5473,5518,5522,5523,5524,5546])&&(r=!0),0<i){serviceiva10&&(i=i/o*n);let e=r?i:i*(1-valorReducao);e=parseFloat(e),i=(i=parseFloat(i)).toFixed(2).replace(/\./g,","),e=e.toFixed(2).replace(/\./g,","),0<valorReducao&&!r?$("#price_"+a).html(" <s>"+i+'&nbsp;€</s> <span style="color: var(--red);"> '+e+"&nbsp;€</span> "):$("#price_"+a).html(" "+i+"&nbsp;€ ")}}),$(".ndk-radio").each(function(e,t){let i=$(t).data("price");t=$(t).data("id-value");if(0<i){let e=(i=serviceiva10?i/o*n:i)*(1-valorReducao);e=parseFloat(e),i=(i=parseFloat(i)).toFixed(2).replace(/\./g,","),e=e.toFixed(2).replace(/\./g,","),0<valorReducao?$("#valueradio_"+t).html(" : + <s>"+i+'&nbsp;€</s> <span style="color: var(--red);"> '+e+"&nbsp;€</span> "):$("#valueradio_"+t).html(" : + "+i+"&nbsp;€ ")}}),$(".img-value").each(function(e,t){let i=$(t).data("price");t=$(t).data("id-value");if(0<i){let e=(i=serviceiva10?i/o*n:i)*(1-valorReducao);e=parseFloat(e),i=(i=parseFloat(i)).toFixed(2).replace(/\./g,","),e=e.toFixed(2).replace(/\./g,","),0<valorReducao?$("#descriptionPrice_"+t).html(" + <s>"+i+'&nbsp;€</s> <span style="color: var(--red);"> '+e+"&nbsp;€</span> "):$("#descriptionPrice_"+t).html(" + "+i+"&nbsp;€ ")}}),$("#ndkloader").remove()},1e3)}),$.ajax({type:"POST",url:"https://priximbattable.net/ajax/index.php",data:{setaction:"getwishlist",id_product:$("#ndkcf_id_product").val()},success:function(e){"true"==e&&($("#wishlistimg").hasClass("heartwishlist")?($("#wishlistimg").removeClass("heartwishlist"),$("#wishlisttext").html("Produit déjà ajouté aux favoris"),$("#wishlistimg").attr("src","/img/heart_full.svg")):($("#wishlistimg").addClass("heartwishlist"),$("#wishlisttext").html("Ajouter à mes favoris"),$("#wishlistimg").attr("src","/img/heart.svg")))}});